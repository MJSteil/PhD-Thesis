Notebook[{
Cell[BoxData[
 TemplateBox[{"\[FilledSmallSquare]", "\"\[FilledSmallSquare]\"", 
   TemplateBox[{"\[FilledSmallSquare]", "\"\[FilledSmallSquare]\"", 
     RowBox[{"2023", "-", "11", "-", "20"}], 
     RowBox[{"v2", ".00"}]}, "RowWithSeparators"], 
   TemplateBox[{
    "\[FilledSmallSquare]", "\"\[FilledSmallSquare]\"", "M. J. Steil", 
     TemplateBox[{
      "msteil@theorie.ikp.physik.tu-darmstadt.de", 
       "mailto:msteil@theorie.ikp.physik.tu-darmstadt.de"}, "HyperlinkURL"], 
     "TU Darmstadt"}, "RowWithSeparators"]},
  "RowWithSeparators"]], "NotebookHeader",
 FontFamily->"Source Sans Pro",
 FontSize->14,
 FontWeight->"Normal",
 FontSlant->"Plain",
 CellTags->"NB`Header",ExpressionUUID->"9dc4eea3-9b4a-4b99-864e-f2be586f181d"],

Cell[CellGroupData[{

Cell["Zero dimensional O(N=1) model", \
"Title",ExpressionUUID->"60c8b46f-b8fc-485d-a581-c44a55bd8497"],

Cell[TextData[{
 "Martin Jakob ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Steil", "1"], TraditionalForm]],ExpressionUUID->
  "da8ea27a-36fc-4455-9fc3-aff23cf98d8a"]
}], "Author",ExpressionUUID->"0a934895-043f-4851-9e99-070dd2d04dff"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "1"], TraditionalForm]],ExpressionUUID->
  "874cf610-870e-446b-8eab-88d3a20c7823"],
 "Technische Universit\[ADoubleDot]t Darmstadt"
}], "Affiliation",ExpressionUUID->"eec4f1de-1acd-4cc2-b269-4edd8a51f61f"],

Cell[TextData[{
 "https://arxiv.org/abs/2108.10085\nComputed trajectories \
\[OpenCurlyDoubleQuote]SC*.mx.gz\[CloseCurlyDoubleQuote] are available upon \
request (",
 ButtonBox["msteil@theorie.ikp.physik.tu-darmstadt.de",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["mailto:msteil@theorie.ikp.physik.tu-darmstadt.de"], None},
  ButtonNote->"mailto:msteil@theorie.ikp.physik.tu-darmstadt.de"],
 ")"
}], "Abstract",ExpressionUUID->"726af8b7-c0d6-46f0-bc05-5355b57b5e17"],

Cell[CellGroupData[{

Cell["Initialization", \
"InitializationSection",ExpressionUUID->"01549a89-100f-47b3-a4ba-\
a76133d2cfc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"DateString", "[", "\"\<ISODateTime\>\"", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "20", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<$KernelCount=\>\"", ",", "$KernelCount"}], "]"}], 
  ";"}]}], "NonEvaluatingInput",ExpressionUUID->"9e518f87-4cdc-43e9-baf5-\
c1f5cd4e794c"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[158]:=",ExpressionUUID->"3215357e-25de-4dc7-b835-5d72212097ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[159]:=",ExpressionUUID->"2cc1779e-b50f-4a2b-855a-4f5ec1f99eb9"],

Cell[CellGroupData[{

Cell["Git setup", \
"Subsubsection",ExpressionUUID->"2f9b12c1-0934-4f33-b544-debed23bfa24"],

Cell["\<\
[https://mathematica.stackexchange.com/questions/11258/are-there-suitable-\
versioning-systems-for-mathematica-notebooks, 2019.02.12 12:01]\
\>", "Text",ExpressionUUID->"fda86a61-828e-4267-bb7f-8fe3571b6207"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Disable", " ", "Notebookhistory"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"SetOptions", "[", 
   RowBox[{
    RowBox[{"InputNotebook", "[", "]"}], ",", 
    RowBox[{"PrivateNotebookOptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<FileOutlineCache\>\"", "\[Rule]", "False"}], "}"}]}], ",", 
    RowBox[{"TrackCellChangeTimes", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[160]:=",ExpressionUUID->"e52e377e-2dd9-4716-bc2b-0e898eeede2b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Packages", \
"Subsubsection",ExpressionUUID->"9409b754-cdf3-4f8b-9b2e-183ba2670590"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "CompiledFunctionTools`"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"For", " ", 
    RowBox[{"CompilePrint", "[", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Provides", " ", "RGB", " ", "or", " ", "CMYK", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"if", " ", "GUCD`GUCDuseCMYK"}], "=", "True"}], ")"}], " ", 
    "colors", " ", "form", " ", "the", " ", "corporate", " ", "design", " ", 
    "of", " ", "Goethe", " ", 
    RowBox[{"university", ".", " ", "Use"}], " ", 
    RowBox[{"GUCD`showAll", "[", "]"}], " ", "to", " ", "see", " ", "all", 
    " ", 
    RowBox[{"colors", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GUCD`useCMYK", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Get", "[", 
    "\"\<D:/Github/Mathematica/Packages/CorporateDesigns/GUCD.m\>\"", "]"}], 
   ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[161]:=",ExpressionUUID->"4118663c-8a80-4b02-b180-465302329f38"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Notebook style", \
"Subsubsection",ExpressionUUID->"352b3545-d108-4bf2-8409-dfd790ffa401"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Legend", "[", 
   RowBox[{"exp_", ",", 
    RowBox[{"pos_", ":", 
     RowBox[{"{", 
      RowBox[{"Right", ",", "Top"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Placed", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"#", ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
        RowBox[{"SingleLetterItalics", "\[Rule]", "True"}]}], "]"}], "&"}], "/@",
      "exp"}], ",", "pos"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LabelText", "[", "txt_", "]"}], ":=", 
  RowBox[{"Text", "[", 
   RowBox[{"txt", ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "11"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListLineListPlot", "[", 
    RowBox[{"dat_", ",", "opt___"}], "]"}], ":=", 
   RowBox[{"Show", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{"dat", ",", "opt"}], "]"}], ",", 
      RowBox[{"ListLinePlot", "[", "dat", "]"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xDot", "[", 
   RowBox[{"r_", ",", 
    RowBox[{"thick___", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsoluteThickness", "[", "thick", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "r"}], ",", 
    RowBox[{"AlignmentPoint", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputStyle", "[", "exp_", "]"}], ":=", 
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"exp", "//", "TraditionalForm"}], ",", "Blue"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fixTickThickness", "[", "gr_", "]"}], ":=", 
   RowBox[{"gr", "/.", 
    RowBox[{
     RowBox[{"f", ":", 
      RowBox[{"(", 
       RowBox[{"_Charting`ScaledTicks", "|", "_Charting`ScaledFrameTicks"}], 
       ")"}]}], "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"#", ",", ";;", ",", " ", 
          RowBox[{";;", "3"}]}], "]"}], "&"}], "@*", "f"}], ")"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Plot`Style`Beamer", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"FrameStyle", "->", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "0.002", "]"}]}], "]"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot`Style", "=", "Plot`Style`Beamer"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Plot", ",", "Plot`Style"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListPlot", ",", "Plot`Style"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"RegionPlot", ",", "Plot`Style"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListLinePlot", ",", "Plot`Style"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[164]:=",ExpressionUUID->"c8c11872-f3bb-4d78-b76e-0a7376ce2ee8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Methods", \
"Subsubsection",ExpressionUUID->"13256e5f-4c52-4cf6-b0a5-a545cc6aa258"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Modified", " ", "Version", " ", "of", " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"szhorvat", ".", "net"}], "/", "pelican"}], "/", "save"}], "-",
      "data", "-", "in", "-", 
     RowBox[{"notebooks", ".", "html"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"SaveToCell", ",", "HoldFirst"}], "]"}], "\n", 
   RowBox[{
    RowBox[{"SaveToCell", "[", 
     RowBox[{"var_", ",", 
      RowBox[{"name", ":", 
       RowBox[{"Except", "[", 
        RowBox[{"_", "?", "OptionQ"}], "]"}], ":", "\"\<\>\""}], ",", 
      RowBox[{"opt", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"Evaluate", "[", "var", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"label", "=", 
         RowBox[{"name", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"name", "!=", "\"\<\>\""}], ",", "\"\<, \>\"", ",", 
            "\"\<\>\""}], "]"}], "<>", 
          RowBox[{"DateString", "[", "\"\<ISODateTime\>\"", "]"}]}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"CellPrint", "@", 
       RowBox[{"Cell", "[", 
        RowBox[{
         RowBox[{"BoxData", "@", 
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MakeBoxes", "[", "var", "]"}], ",", "\"\<=\>\"", ",", 
             RowBox[{"ToBoxes", "[", 
              RowBox[{"Iconize", "[", 
               RowBox[{"data", ",", "label", ",", 
                RowBox[{"Method", "\[Rule]", "Compress"}]}], "]"}], "]"}], 
             ",", "\"\<;\>\""}], "}"}], "]"}]}], ",", "\"\<Input\>\"", ",", 
         RowBox[{"GeneratedCell", "\[Rule]", "False"}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"prevent", " ", "deletion", " ", "by", " ", "Cell"}], ">", 
           RowBox[{"Delete", " ", "All", " ", 
            RowBox[{"Output", ":"}]}]}], "*)"}], 
         RowBox[{"CellLabel", "\[Rule]", "\"\<(saved)\>\""}], ",", "opt", ",", 
         RowBox[{"CellLabelAutoDelete", "\[Rule]", "False"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"*", " ", "Option", " ", "lookup"}], " ", "**)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LookupOption", "[", 
     RowBox[{"x_", ",", "option_"}], "]"}], ":=", 
    RowBox[{"Lookup", "[", 
     RowBox[{
      RowBox[{"Options", "[", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "x", "]"}], "=!=", "Symbol"}], ",", 
         RowBox[{"Head", "[", "x", "]"}], ",", "x"}], "]"}], "]"}], ",", 
      "option"}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"LookupOption", "[", 
     RowBox[{"x_", ",", "option_", ",", "default_"}], "]"}], ":=", 
    RowBox[{"Lookup", "[", 
     RowBox[{
      RowBox[{"Options", "[", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "x", "]"}], "=!=", "Symbol"}], ",", 
         RowBox[{"Head", "[", "x", "]"}], ",", "x"}], "]"}], "]"}], ",", 
      "option", ",", "default"}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[176]:=",ExpressionUUID->"95c7d2a0-c00e-4939-abd6-bed93a238ba4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ContextQ", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ContextQ", "[", "name_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Names", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "name", "]"}], "<>", "\"\<`*\>\""}], "]"}], 
      "]"}], "\[Equal]", "0"}], ",", "False", ",", "True"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ContextQ", "::", "usage"}], "=", 
    "\"\<ContextQ[name_]: Return True if name is a context (has sub \
expressions 'name`...').\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "GetSubContexts", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GetSubContexts", "]"}], "=", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{"Depth", "\[Rule]", "10"}], "\n", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"GetSubContexts", "[", "name_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"names", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ToString", "[", "name", "]"}], "<>", "#"}], ")"}], "&"}], 
        "/@", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringJoin", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"\"\<`*\>\"", ",", "#"}], "]"}]}], "&"}], ",", 
          RowBox[{"LookupOption", "[", 
           RowBox[{"GetSubContexts", ",", "Depth", ",", "10"}], "]"}]}], 
         "]"}]}], ")"}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Names", "[", "#", "]"}], "&"}], "/@", "names"}], "]"}], 
       ",", 
       RowBox[{
        RowBox[{"RegularExpression", "[", "\"\<(.*)`(.*[^`])\>\"", "]"}], 
        "->", "\"\<$1`\>\""}]}], "]"}], "//", "DeleteDuplicates"}]}], "\n", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetSubContexts", "::", "usage"}], "=", 
    "\"\<GetSubContexts[name_]: Extract possible sub contexts 'name`*`...' \
and return '{}' if name is not a context.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "GetDistributedContexts", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"GetDistributedContexts", "[", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ListQ", "[", "$DistributedContexts", "]"}], "=!=", "True"}], 
    ",", 
    RowBox[{"{", "$Context", "}"}], ",", "$DistributedContexts"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetDistributedContexts", "::", "usage"}], "=", 
    "\"\<GetDistributedContexts[]: Return $DistributedContexts if \
$DistributedContexts is a list and {$Context} if its not a list.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "AddToDistributedContexts", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddToDistributedContexts", "[", 
   RowBox[{"name_String", "/;", 
    RowBox[{"StringMatchQ", "[", 
     RowBox[{"name", ",", 
      RowBox[{"RegularExpression", "[", "\"\<(.*)`\>\"", "]"}]}], "]"}]}], 
   "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"contexts", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"GetDistributedContexts", "[", "]"}], ",", 
         RowBox[{"{", "name", "}"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"$DistributedContexts", "=", "contexts"}], ";", 
     RowBox[{"Return", "[", "contexts", "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AddToDistributedContexts", "[", 
    RowBox[{"names_", "/;", 
     RowBox[{"VectorQ", "[", 
      RowBox[{"names", ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringQ", "[", "#", "]"}], ",", 
          RowBox[{"StringMatchQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"RegularExpression", "[", "\"\<(.*)`\>\"", "]"}]}], "]"}],
           ",", "False"}], "]"}], "&"}]}], "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"contexts", "=", 
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"GetDistributedContexts", "[", "]"}], ",", "names"}], 
         "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"$DistributedContexts", "=", "contexts"}], ";", 
      RowBox[{"Return", "[", "contexts", "]"}]}]}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AddToDistributedContexts", "[", 
    RowBox[{"names_List", ",", 
     RowBox[{"includeSubContexts_", ":", "True"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"AddToDistributedContexts", "[", 
      RowBox[{"#", ",", "includeSubContexts"}], "]"}], "&"}], "/@", 
    "names"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddToDistributedContexts", "[", 
   RowBox[{"name_", ",", 
    RowBox[{"includeSubContexts_", ":", "True"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t", 
     RowBox[{"contexts", "=", 
      RowBox[{"If", "[", 
       RowBox[{"includeSubContexts", ",", 
        RowBox[{"GetSubContexts", "[", "name", "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ContextQ", "[", "name", "]"}], ",", 
          RowBox[{"{", "name", "}"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], "\n", "}"}], ",", "\n", 
    "\t", "\n", "\t", 
    RowBox[{
     RowBox[{"$DistributedContexts", "=", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"GetDistributedContexts", "[", "]"}], ",", "contexts"}], 
        "]"}], "//", "DeleteDuplicates"}]}], ";", "\t", "\n", "\t", 
     RowBox[{"Return", "[", "contexts", "]"}]}]}], "\n", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AddToDistributedContexts", "::", "usage"}], "=", 
   "\"\<AddToDistributedContexts[name_,OptionsPattern[],includeSubContexts_:\
True]: Add name to $DistributedContexts if name is a context and include sub \
contexts if includeSubContexts=True using GetSubContexts[...].\>\""}], 
  ";"}]}], "Code",
 InitializationCell->True,
 CellLabel->"In[180]:=",ExpressionUUID->"7d3bef8b-2628-4ede-916f-f00f15dabe9e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kurganov-Tadmor Scheme", \
"Chapter",ExpressionUUID->"9b3e323f-cbdc-4f01-abde-5f2451c58cd8"],

Cell[CellGroupData[{

Cell["Finite Volume", \
"Subsection",ExpressionUUID->"7e9db3cc-8da7-4b71-9725-acb2886869fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"In", " ", "the", " ", "following", "  ", "1"}], "+", 
  RowBox[{"1", " ", "dimensional", " ", "PDE"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], "u"}], 
    RowBox[{"(", 
     RowBox[{"t", ",", "x"}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["\[PartialD]", "x"], 
    RowBox[{"F", "[", 
     RowBox[{"t", ",", 
      RowBox[{"u", 
       RowBox[{"(", 
        RowBox[{"t", ",", "x"}], ")"}]}]}], "]"}]}]}], "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[PartialD]", "x"], 
    RowBox[{"Q", "[", 
     RowBox[{"t", ",", "x", ",", 
      RowBox[{"u", 
       RowBox[{"(", 
        RowBox[{"t", ",", "x"}], ")"}]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "u"}], 
       RowBox[{"(", 
        RowBox[{"t", ",", "x"}], ")"}]}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "x"], "S"}], 
    RowBox[{"(", 
     RowBox[{"t", ",", "x"}], ")"}]}], "+", 
   RowBox[{"G", "[", 
    RowBox[{"t", ",", "x", ",", "u"}], 
    "]"}]}]}]}], \
"DisplayFormulaNumbered",ExpressionUUID->"d688e9ba-2b96-4e4c-bb5b-\
47d813e461ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "We", " ", "average", " ", "over", " ", "n", " ", "volume", " ", "cells", 
     " ", "on", " ", "an", " ", "equidistant", " ", "grid", " ", "of", " ", 
     "n"}], "+", 
    RowBox[{"1", " ", "cell", " ", "boundaries", " ", 
     SubscriptBox["x", "j"]}]}], "\[Element]", 
   RowBox[{"[", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"1", "/", "2"}]], ",", 
     SubscriptBox["x", 
      RowBox[{"1", "+", 
       RowBox[{"1", "/", "2"}]}]], ",", "...", ",", 
     SubscriptBox["x", 
      RowBox[{"n", "+", 
       RowBox[{"1", "/", "2"}]}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     SubscriptBox["x", 
      RowBox[{"j", "-", 
       RowBox[{"1", "/", "2"}]}]], 
     SubscriptBox["x", 
      RowBox[{"j", "+", 
       RowBox[{"1", "/", "2"}]}]]], 
    RowBox[{
     FractionBox["dx", "\[CapitalDelta]x"], 
     RowBox[{
      SubscriptBox["\[PartialD]", "t"], "u"}], 
     RowBox[{"(", 
      RowBox[{"t", ",", "x"}], ")"}]}]}], "+", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     SubscriptBox["x", 
      RowBox[{"j", "-", 
       RowBox[{"1", "/", "2"}]}]], 
     SubscriptBox["x", 
      RowBox[{"j", "+", 
       RowBox[{"1", "/", "2"}]}]]], 
    RowBox[{
     FractionBox["dx", "\[CapitalDelta]x"], 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      RowBox[{"F", "[", 
       RowBox[{"t", ",", 
        RowBox[{"u", 
         RowBox[{"(", 
          RowBox[{"t", ",", "x"}], ")"}]}]}], "]"}]}]}]}]}], "=", 
  RowBox[{
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     SubscriptBox["x", 
      RowBox[{"j", "-", 
       RowBox[{"1", "/", "2"}]}]], 
     SubscriptBox["x", 
      RowBox[{"j", "+", 
       RowBox[{"1", "/", "2"}]}]]], 
    RowBox[{
     FractionBox["dx", "\[CapitalDelta]x"], 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      RowBox[{"Q", "[", 
       RowBox[{"t", ",", "x", ",", 
        RowBox[{"u", 
         RowBox[{"(", 
          RowBox[{"t", ",", "x"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "x"], "u"}], 
         RowBox[{"(", 
          RowBox[{"t", ",", "x"}], ")"}]}]}], "]"}]}]}]}], "+", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     SubscriptBox["x", 
      RowBox[{"j", "-", 
       RowBox[{"1", "/", "2"}]}]], 
     SubscriptBox["x", 
      RowBox[{"j", "+", 
       RowBox[{"1", "/", "2"}]}]]], 
    RowBox[{
     FractionBox["dx", "\[CapitalDelta]x"], 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], "S"}], 
     RowBox[{"(", 
      RowBox[{"t", ",", "x"}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[PartialD]", "t"], 
    SubscriptBox["u", "j"]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"t", ",", 
       RowBox[{"u", 
        RowBox[{"(", 
         RowBox[{"t", ",", 
          SubscriptBox["x", 
           RowBox[{"j", "+", 
            RowBox[{"1", "/", "2"}]}]]}], ")"}]}]}], "]"}], "-", 
     RowBox[{"F", "[", 
      RowBox[{"t", ",", 
       RowBox[{"u", 
        RowBox[{"(", 
         RowBox[{"t", ",", 
          SubscriptBox["x", 
           RowBox[{"j", "-", 
            RowBox[{"1", "/", "2"}]}]]}], ")"}]}]}], "]"}]}], 
    "\[CapitalDelta]x"]}], "=", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"Q", "[", 
      RowBox[{"t", ",", 
       SubscriptBox["x", 
        RowBox[{"j", "+", 
         RowBox[{"1", "/", "2"}]}]], ",", 
       RowBox[{"u", 
        RowBox[{"(", 
         RowBox[{"t", ",", 
          SubscriptBox["x", 
           RowBox[{"j", "+", 
            RowBox[{"1", "/", "2"}]}]]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "x"], "u"}], 
        RowBox[{"(", 
         RowBox[{"t", ",", 
          RowBox[{"x", "+", 
           RowBox[{"1", "/", "2"}]}]}], ")"}]}]}], "]"}], "-", 
     RowBox[{"Q", "[", 
      RowBox[{"t", ",", 
       SubscriptBox["x", 
        RowBox[{"j", "-", 
         RowBox[{"1", "/", "2"}]}]], ",", 
       RowBox[{"u", 
        RowBox[{"(", 
         RowBox[{"t", ",", 
          SubscriptBox["x", 
           RowBox[{"j", "-", 
            RowBox[{"1", "/", "2"}]}]]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "x"], "u"}], 
        RowBox[{"(", 
         RowBox[{"t", ",", 
          RowBox[{"x", "-", 
           RowBox[{"1", "/", "2"}]}]}], ")"}]}]}], "]"}]}], 
    "\[CapitalDelta]x"], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"t", ",", 
       SubscriptBox["x", 
        RowBox[{"j", "+", 
         RowBox[{"1", "/", "2"}]}]]}], "]"}], "-", 
     RowBox[{"S", "[", 
      RowBox[{"t", ",", 
       SubscriptBox["x", 
        RowBox[{"j", "-", 
         RowBox[{"1", "/", "2"}]}]]}], "]"}]}], 
    "\[CapitalDelta]x"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "A", " ", "finite", " ", "volume", " ", "scheme", " ", "specifies", " ", 
    "how", " ", "to", " ", 
    RowBox[{"compute", "/", "reconstruct"}], " ", "the", " ", "convection", 
    " ", "and", " ", "diffusion", " ", "flux", " ", "on", " ", "the", " ", 
    "cell", " ", "boundaries", " ", "from", " ", "the", " ", "available", " ",
     "cell", " ", "averages", " ", 
    SubscriptBox["u", "i"]}], "\[Element]", 
   RowBox[{"[", 
    RowBox[{
     SubscriptBox["u", "1"], ",", "...", ",", 
     SubscriptBox["u", "n"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[PartialD]", "t"], 
    SubscriptBox["u", "j"]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{
      SubscriptBox["H", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}]], "[", "u", "]"}], "-", 
     RowBox[{
      SubscriptBox["H", 
       RowBox[{"j", "-", 
        RowBox[{"1", "/", "2"}]}]], "[", "u", "]"}]}], "\[CapitalDelta]x"]}], 
  "=", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      SubscriptBox["Q", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}]], "[", "u", "]"}], "-", 
     RowBox[{
      SubscriptBox["Q", 
       RowBox[{"j", "-", 
        RowBox[{"1", "/", "2"}]}]], "[", "u", "]"}]}], "\[CapitalDelta]x"], 
   "+", 
   SubscriptBox["S", "j"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", " ", "cell", " ", "with", " ", "average", " ", 
   SubscriptBox["u", "j"], " ", "is", " ", "centered", " ", "at", " ", 
   SubscriptBox["x", "j"]}], "=", 
  RowBox[{
   SubscriptBox["x", 
    RowBox[{"j", "-", 
     RowBox[{"1", "/", "2"}]}]], "+", 
   RowBox[{
   "\[CapitalDelta]x", "/", 
    "2"}]}]}]}], \
"DisplayFormulaNumbered",ExpressionUUID->"9b3570ef-8029-4f75-bb1e-\
7de504f4487a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Limiters", \
"Subsection",ExpressionUUID->"edeb2c27-7153-4c32-933f-7ff8bf8f499f"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<KT`\[Phi]`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`\[Phi]`MinMod", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalDelta]uj", ",", "\[CapitalDelta]ujp1"}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "@", "\[CapitalDelta]ujp1"}], "\[Equal]", "0."}], ",", 
       "1.", ",", 
       RowBox[{"Max", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"Min", "[", 
          RowBox[{"1.", ",", 
           RowBox[{"\[CapitalDelta]uj", "/", "\[CapitalDelta]ujp1"}]}], 
          "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`\[Phi]`VanAlbada1", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalDelta]uj", ",", "\[CapitalDelta]ujp1"}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "@", "\[CapitalDelta]ujp1"}], "\[Equal]", "0."}], ",", 
       "1.", ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", "=", 
           RowBox[{"\[CapitalDelta]uj", "/", "\[CapitalDelta]ujp1"}]}], "}"}],
          ",", 
         RowBox[{"r", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r", "+", "1."}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "*", "r"}], "+", "1."}], ")"}]}]}]}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`\[Phi]`VanLeer", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalDelta]uj", ",", "\[CapitalDelta]ujp1"}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "@", "\[CapitalDelta]ujp1"}], "\[Equal]", "0."}], ",", 
       "2.", ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", "=", 
           RowBox[{"\[CapitalDelta]uj", "/", "\[CapitalDelta]ujp1"}]}], "}"}],
          ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r", "+", 
            RowBox[{"Abs", "[", "r", "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Abs", "[", "r", "]"}]}], ")"}]}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`\[Phi]`MonotonizedCentral", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalDelta]uj", ",", "\[CapitalDelta]ujp1"}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "@", "\[CapitalDelta]ujp1"}], "\[Equal]", "0."}], ",", 
       "2.", ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", "=", 
           RowBox[{"\[CapitalDelta]uj", "/", "\[CapitalDelta]ujp1"}]}], "}"}],
          ",", 
         RowBox[{"Max", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"2", "r"}], ",", 
             RowBox[{"0.5", "*", 
              RowBox[{"(", 
               RowBox[{"1", "+", "r"}], ")"}]}], ",", "2."}], "]"}]}], 
          "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`\[Phi]`Koren", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalDelta]uj", ",", "\[CapitalDelta]ujp1"}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "@", "\[CapitalDelta]ujp1"}], "\[Equal]", "0."}], ",", 
       "2.", ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", "=", 
           RowBox[{"\[CapitalDelta]uj", "/", "\[CapitalDelta]ujp1"}]}], "}"}],
          ",", 
         RowBox[{"Max", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"2", "r"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1.", "+", 
                  RowBox[{"2.", "*", "r"}]}], ")"}], "/", "3."}], ",", "2."}],
               "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KT`\[Phi]`Superbee", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalDelta]uj", ",", "\[CapitalDelta]ujp1"}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "@", "\[CapitalDelta]ujp1"}], "\[Equal]", "0."}], ",",
         "2.", ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", "=", 
            RowBox[{"\[CapitalDelta]uj", "/", "\[CapitalDelta]ujp1"}]}], 
           "}"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"2.", "r"}], ",", "1."}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"r", ",", "2."}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`\[Phi]`VanAlbada2", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalDelta]uj", ",", "\[CapitalDelta]ujp1"}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "@", "\[CapitalDelta]ujp1"}], "\[Equal]", "0."}], ",", 
       "0.", ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", "=", 
           RowBox[{"\[CapitalDelta]uj", "/", "\[CapitalDelta]ujp1"}]}], "}"}],
          ",", 
         RowBox[{"2.", "*", 
          RowBox[{"r", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "*", "r"}], "+", "1."}], ")"}]}]}]}], "]"}]}], 
      "]"}]}], "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{"Not", " ", "TVD"}], " ", "*)"}], ";"}]}], "Code",
 CellLabel->
  "In[196]:=",ExpressionUUID->"5d235d88-59db-48cf-af9f-67a21310e5a9"],

Cell[CellGroupData[{

Cell["Plots", \
"NonEvaluatingSubsubsection",ExpressionUUID->"35e11232-1a9e-48cf-b16a-\
964289e39bdd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"KT`TVDregion", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Phi]", "<=", 
            RowBox[{"2", "r"}]}], "&&", 
           RowBox[{"\[Phi]", ">=", "r"}], "&&", 
           RowBox[{"\[Phi]", "\[LessEqual]", "1"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", ">=", "1"}], "&&", 
           RowBox[{"\[Phi]", "\[GreaterEqual]", "1"}], "&&", 
           RowBox[{"\[Phi]", "\[LessEqual]", "2"}], "&&", 
           RowBox[{"\[Phi]", "<=", "r"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Phi]", ",", "0", ",", "3"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
        RowBox[{"MaxRecursion", "\[Rule]", "4"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<r\>\"", ",", "\"\<\[Phi](r)\>\""}], "}"}]}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Legend", "[", 
          RowBox[{
           RowBox[{"{", "\"\<TVD region\>\"", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Right", ",", "Bottom"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Blend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"White", ",", "Black"}], "}"}], ",", 
           RowBox[{"1", "/", "6"}]}], "]"}]}], ",", 
        RowBox[{"BoundaryStyle", "->", "None"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"3", "/", "4"}]}]}], "]"}], ",", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Arrowheads", "[", "0.03", "]"}], ",", 
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              FractionBox["6", "4"], ",", 
              FractionBox["3", "4"]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox["6", "4"], ",", 
              RowBox[{
               FractionBox["3", "4"], "-", 
               FractionBox["1", "2"]}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"Text", "[", 
          RowBox[{"\"\<   increasing dissipativity\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox["6", "4"], ",", 
             RowBox[{
              FractionBox["3", "4"], "-", 
              FractionBox["1", "4"]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}], 
      ",", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Arrowheads", "[", "0.03", "]"}], ",", 
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              FractionBox["6", "4"], ",", 
              RowBox[{"2", "+", 
               RowBox[{"1", "/", "4"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox["6", "4"], ",", 
              RowBox[{"2", "+", 
               FractionBox["3", "4"]}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"Text", "[", 
          RowBox[{"\"\<   decreasing dissipativity\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox["6", "4"], ",", 
             RowBox[{"2", "+", 
              FractionBox["2", "4"]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}]}],
      "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"KT`TVDregion", ",", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"KT`\[Phi]`MinMod", "[", 
           RowBox[{"r", ",", "1"}], "]"}], ",", 
          RowBox[{"KT`\[Phi]`VanAlbada1", "[", 
           RowBox[{"r", ",", "1"}], "]"}], ",", 
          RowBox[{"KT`\[Phi]`VanLeer", "[", 
           RowBox[{"r", ",", "1"}], "]"}], ",", 
          RowBox[{"KT`\[Phi]`MonotonizedCentral", "[", 
           RowBox[{"r", ",", "1"}], "]"}], ",", 
          RowBox[{"KT`\[Phi]`Koren", "[", 
           RowBox[{"r", ",", "1"}], "]"}], ",", 
          RowBox[{"KT`\[Phi]`Superbee", "[", 
           RowBox[{"r", ",", "1"}], "]"}], ",", 
          RowBox[{"KT`\[Phi]`VanAlbada2", "[", 
           RowBox[{"r", ",", "1"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "4"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Legend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<MinMod\>\"", ",", "\"\<van Albada 1\>\"", ",", 
             "\"\<van Leer\>\"", ",", "\"\<Monotonized Central\>\"", ",", 
             "\"\<Koren\>\"", ",", "\"\<Superbee\>\"", ",", 
             "\"\<van Albada 2\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Left", ",", "Top"}], "}"}]}], "]"}]}]}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}], "//", 
  "fixTickThickness"}]}], "Input",
 CellLabel->"In[82]:=",ExpressionUUID->"769cb1e1-eb21-42b3-a7b5-2f26c7b1332f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KT`\[Phi]`GeneralizedMinMod", "[", "\[Theta]_", "]"}], "/;", 
    RowBox[{"1", "<=", "\[Theta]", "\[LessEqual]", "2"}]}], ":=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalDelta]uj", ",", "\[CapitalDelta]ujp1"}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "@", "\[CapitalDelta]ujp1"}], "\[Equal]", "0."}], ",", 
       "\[Theta]", ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", "=", 
           RowBox[{"\[CapitalDelta]uj", "/", "\[CapitalDelta]ujp1"}]}], "}"}],
          ",", 
         RowBox[{"Max", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"\[Theta]", " ", "r"}], ",", 
             RowBox[{"0.5", "*", 
              RowBox[{"(", 
               RowBox[{"1", "+", "r"}], ")"}]}], ",", "\[Theta]"}], "]"}]}], 
          "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[84]:=",ExpressionUUID->"18d36179-2009-490e-9636-9f66e58a04ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", 
      RowBox[{
       RowBox[{"KT`\[Phi]`GeneralizedMinMod", "[", "\[Theta]", "]"}], "[", 
       RowBox[{"r", ",", "1"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "1", ",", "2", ",", 
      RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"KT`TVDregion", ",", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"%", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "4"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Legend", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"Subsuperscript", "[", 
                RowBox[{"\"\<\[Phi]\>\"", ",", "\"\<gmm\>\"", ",", 
                 RowBox[{"InputForm", "@", "#"}]}], "]"}], "}"}], "]"}], 
             "&"}], "/@", 
            RowBox[{"%", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"Left", ",", "Top"}], "}"}]}], "]"}]}]}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}], "//", 
  "fixTickThickness"}]}], "Input",
 CellLabel->"In[85]:=",ExpressionUUID->"da776314-6af6-466b-89d2-2e22bd903b9c"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Boundary conditions", \
"Subsection",ExpressionUUID->"f61834c3-806d-40da-a2b0-1db0df6e4cf1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BC`periodic", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "vin", "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", "=", "vin"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "5"}]}], "]"}], "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "2", " "}]], "=", " ", 
          SubscriptBox["u", 
           RowBox[{"n", "-", "3"}]]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "4"}]}], "]"}], "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1", " "}]], "=", " ", 
          SubscriptBox["u", 
           RowBox[{"n", "-", "2"}]]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "3"}]}], "]"}], "]"}], "=", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"n", "-", "1", " "}]], "=", " ", 
          SubscriptBox["u", "0"]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], "=", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "4"}], "]"}], "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", "n"], " ", "=", " ", 
          SubscriptBox["u", "1"]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "5"}], "]"}], "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"n", "+", "1"}]], " ", "=", " ", 
          SubscriptBox["u", "2"]}], " ", "*)"}], "\[IndentingNewLine]", 
        "v"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[204]:=",ExpressionUUID->"ff67abc2-a431-46fd-86aa-27dd0fdbac9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BC`antiperiodic", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "vin", "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", "=", "vin"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"-", "5"}]}], "]"}], "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], "=", " ", 
          RowBox[{"-", 
           SubscriptBox["u", 
            RowBox[{"n", "-", "3"}]]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"-", "4"}]}], "]"}], "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], "=", " ", 
          RowBox[{"-", 
           SubscriptBox["u", 
            RowBox[{"n", "-", "2"}]]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "3"}]}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"n", "-", "1"}]], "=", " ", 
          RowBox[{"-", 
           SubscriptBox["u", "0"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "4"}], "]"}], "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", "n"], " ", "=", " ", 
          RowBox[{"-", 
           SubscriptBox["u", "1"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "5"}], "]"}], "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"n", "+", "1"}]], " ", "=", " ", 
          RowBox[{"-", 
           SubscriptBox["u", "2"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "v"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[205]:=",ExpressionUUID->"080ade31-4ac4-4ecf-8f89-efd2fe7ae582"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BC`linearExtrapolation", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "vin", "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", "=", "vin"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "-", 
          RowBox[{"2", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "4"}], "]"}], "]"}]}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], " ", "=", " ", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["u", "0"]}], " ", "-", " ", 
           RowBox[{"2", 
            SubscriptBox["u", "1"]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "-", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "4"}], "]"}], "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", "=", " ", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["u", "0"]}], " ", "-", " ", 
           SubscriptBox["u", "1"]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "3"}]}], "]"}], "]"}]}], "-", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"-", "4"}]}], "]"}], "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", "n"], " ", "=", " ", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["u", 
             RowBox[{"n", "-", "1"}]]}], " ", "-", " ", 
           SubscriptBox["u", 
            RowBox[{"n", "-", "2"}]]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "3"}]}], "]"}], "]"}]}], "-", 
          RowBox[{"2", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "4"}]}], "]"}], "]"}]}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"n", "+", "1", " "}]], "=", " ", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["u", 
             RowBox[{"n", "-", "1"}]]}], " ", "-", " ", 
           RowBox[{"2", 
            SubscriptBox["u", 
             RowBox[{"n", "-", "2"}]]}]}]}], "*)"}], "\[IndentingNewLine]", 
        "v"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[206]:=",ExpressionUUID->"1601882c-d1bd-4e58-85d1-3ab78aad6d3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BC`antisymmetric", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "vin", "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", "=", "vin"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "5"}], "]"}], "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], " ", "=", " ", 
          RowBox[{"-", 
           SubscriptBox["u", "2"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "4"}], "]"}], "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", "=", " ", 
          RowBox[{"-", 
           SubscriptBox["u", "1"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], "=", 
         RowBox[{"0", "*", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", "0"], " ", "=", " ", "0"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "3"}]}], "]"}], "]"}]}], "-", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"-", "4"}]}], "]"}], "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", "n"], " ", "=", " ", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["u", 
             RowBox[{"n", "-", "1"}]]}], " ", "-", " ", 
           SubscriptBox["u", 
            RowBox[{"n", "-", "2"}]]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "3"}]}], "]"}], "]"}]}], "-", 
          RowBox[{"2", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "4"}]}], "]"}], "]"}]}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"n", "+", "1", " "}]], "=", " ", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["u", 
             RowBox[{"n", "-", "1"}]]}], " ", "-", " ", 
           RowBox[{"2", 
            SubscriptBox["u", 
             RowBox[{"n", "-", "2"}]]}]}]}], "*)"}], "\[IndentingNewLine]", 
        "v"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[207]:=",ExpressionUUID->"9364335f-67ba-42ba-aad8-b14e4d585c4e"],

Cell[CellGroupData[{

Cell["Symbolic and numeric tests", \
"NonEvaluatingSubsubsection",ExpressionUUID->"52bd1e3e-954a-4441-b0f2-\
79cfecdbeed8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", "[", 
       RowBox[{"i", ",", "0"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "2", ",", 
         RowBox[{"n", "-", "3"}], ",", 
         RowBox[{"n", "-", "2"}], ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "}"}]}], "]"}], "//", 
   "Transpose"}], "//", "Flatten"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC`periodic", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.", ",", "0."}], "}"}], ",", "#", ",", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0."}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Take", "[", 
       RowBox[{"%", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"6", "*", "1"}]}], "}"}]}], "]"}], ",", "6"}], "]"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"5", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"x", "+", "%"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"2", "\[Pi]"}], ",", 
      RowBox[{"\[Pi]", "/", "8"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC`periodic", "[", 
   RowBox[{"{", 
    RowBox[{"ArrayPad", "[", 
     RowBox[{
      RowBox[{"Sin", "[", "%", "]"}], ",", "2"}], "]"}], "}"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"3", ";;", 
         RowBox[{"-", "3"}]}], "]"}], "]"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "2"}], ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "}"}], "&"}], "@", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"x", "+", "%%%"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "4"}], ",", 
          RowBox[{
           RowBox[{"2", "\[Pi]"}], "+", 
           RowBox[{"\[Pi]", "/", "4"}]}], ",", 
          RowBox[{"\[Pi]", "/", "8"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"%", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListPlot", "[", "%", "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"Last", "[", "%", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"Last", "[", "%", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellLabel->"In[91]:=",ExpressionUUID->"f53d444e-356b-472b-99b5-a67582ee4cf2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", "[", 
       RowBox[{"i", ",", "0"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "2", ",", 
         RowBox[{"n", "-", "3"}], ",", 
         RowBox[{"n", "-", "2"}], ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "}"}]}], "]"}], "//", 
   "Transpose"}], "//", "Flatten"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC`antiperiodic", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.", ",", "0."}], "}"}], ",", "#", ",", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0."}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Take", "[", 
       RowBox[{"%", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"6", "*", "1"}]}], "}"}]}], "]"}], ",", "6"}], "]"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Pi]", "/", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"x", "+", "%"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "\[Pi]", ",", 
      RowBox[{"\[Pi]", "/", "8"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC`antiperiodic", "[", 
   RowBox[{"{", 
    RowBox[{"ArrayPad", "[", 
     RowBox[{
      RowBox[{"Sin", "[", "%", "]"}], ",", "2"}], "]"}], "}"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"3", ";;", 
         RowBox[{"-", "3"}]}], "]"}], "]"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "2"}], ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "}"}], "&"}], "@", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"x", "+", "%%%"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "4"}], ",", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{"\[Pi]", "/", "4"}]}], ",", 
          RowBox[{"\[Pi]", "/", "8"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"%", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListPlot", "[", "%", "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"Last", "[", "%", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"Last", "[", "%", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",ExpressionUUID->"30316fb0-42e0-4d8e-8b4b-4c37a80277c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", "[", 
       RowBox[{"i", ",", "0"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "2", ",", 
         RowBox[{"n", "-", "3"}], ",", 
         RowBox[{"n", "-", "2"}], ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "}"}]}], "]"}], "//", 
   "Transpose"}], "//", "Flatten"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC`linearExtrapolation", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.", ",", "0."}], "}"}], ",", "#", ",", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0."}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Take", "[", 
       RowBox[{"%", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"6", "*", "1"}]}], "}"}]}], "]"}], ",", "6"}], "]"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"5", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"x", "+", "%"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"2", "\[Pi]"}], ",", 
      RowBox[{"\[Pi]", "/", "8"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC`linearExtrapolation", "[", 
   RowBox[{"{", 
    RowBox[{"ArrayPad", "[", 
     RowBox[{
      RowBox[{"Sin", "[", "%", "]"}], ",", "2"}], "]"}], "}"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"3", ";;", 
         RowBox[{"-", "3"}]}], "]"}], "]"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "2"}], ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "}"}], "&"}], "@", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"x", "+", "%%%"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "4"}], ",", 
          RowBox[{
           RowBox[{"2", "\[Pi]"}], "+", 
           RowBox[{"\[Pi]", "/", "4"}]}], ",", 
          RowBox[{"\[Pi]", "/", "8"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"%", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListPlot", "[", "%", "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"Last", "[", "%", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"Last", "[", "%", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellLabel->
  "In[105]:=",ExpressionUUID->"290ff245-537d-4746-b9a9-18297fab412d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", "[", 
       RowBox[{"i", ",", "0"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "2", ",", 
         RowBox[{"n", "-", "3"}], ",", 
         RowBox[{"n", "-", "2"}], ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "}"}]}], "]"}], "//", 
   "Transpose"}], "//", "Flatten"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC`antisymmetric", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.", ",", "0."}], "}"}], ",", "#", ",", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0."}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Take", "[", 
       RowBox[{"%", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"6", "*", "1"}]}], "}"}]}], "]"}], ",", "6"}], "]"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"0", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"x", "+", "%"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"3", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", 
      RowBox[{"\[Pi]", "/", "8"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC`antisymmetric", "[", 
   RowBox[{"{", 
    RowBox[{"ArrayPad", "[", 
     RowBox[{
      RowBox[{"Sin", "[", "%", "]"}], ",", "2"}], "]"}], "}"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"3", ";;", 
         RowBox[{"-", "3"}]}], "]"}], "]"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "2"}], ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "}"}], "&"}], "@", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"x", "+", "%%%"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "4"}], ",", 
          RowBox[{
           RowBox[{"3", 
            RowBox[{"\[Pi]", "/", "2"}]}], "+", 
           RowBox[{"\[Pi]", "/", "4"}]}], ",", 
          RowBox[{"\[Pi]", "/", "8"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"%", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListPlot", "[", "%", "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"Last", "[", "%", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"Last", "[", "%", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellLabel->"In[112]:=",ExpressionUUID->"52b25bfe-19a3-4eb6-962d-8fd8c385ed62"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["System and solution objects", \
"Subsection",ExpressionUUID->"9cf112f8-1a20-4a88-8c03-9d96a1510bf0"],

Cell[CellGroupData[{

Cell["System", \
"Subsubsection",ExpressionUUID->"35b26f09-515b-452e-adfc-d3332edacd60"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "KT`system`generate", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"KT`system`generate", "[", 
          RowBox[{
           RowBox[{"scheme_", ":", "KT`O2"}], ",", "schemeParams___"}], "]"}],
          "[", 
         RowBox[{"nx`in_", ",", 
          RowBox[{"nu`in_", ":", "1"}]}], "]"}], "[", 
        RowBox[{"x0`in_", ",", "x1`in_"}], "]"}], "[", 
       RowBox[{"t0`in_", ",", "t1`in_"}], "]"}], "[", 
      RowBox[{
      "F_", ",", "\[Lambda]dFdu_", ",", "Q_", ",", "BC_", ",", "pars___"}], 
      "]"}], "[", 
     RowBox[{"u0`in_", ",", "u0`in`pars___"}], "]"}], "[", 
    RowBox[{
     RowBox[{"average_", ":", "Integrate"}], ",", "averageOptions___"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nx", ",", "nu", ",", "nadd", ",", "\[IndentingNewLine]", "x0", ",", 
       "x1", ",", "\[CapitalDelta]x", ",", "xi", ",", "xi12", ",", 
       "\[IndentingNewLine]", "t0", ",", "t1", ",", "\[IndentingNewLine]", 
       "pde", ",", "pde`params", ",", "pde`rhs", ",", "pde`rhs`function", ",",
        "\[IndentingNewLine]", "u0", ",", "U0", ",", "u0`pars", ",", "u0i", 
       ",", "\[IndentingNewLine]", "pde`system", ",", "pde`u", ",", "pde`t"}],
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"**", "**", " ", "Grid", " ", "**", "**"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nx", "=", "nx`in"}], ";", "\[IndentingNewLine]", 
      RowBox[{"nu", "=", "nu`in"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"x0", "=", "x0`in"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x1", "=", "x1`in"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]x", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1", "-", "x0"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"nx", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xi", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"x0", "+", 
          RowBox[{"\[CapitalDelta]x", "*", "i"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"nx", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xi12", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"x0", "+", 
          RowBox[{"\[CapitalDelta]x", "*", 
           RowBox[{"(", 
            RowBox[{"i", "-", "0.5"}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "nx"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"**", "**", " ", "PDE", " ", "**", "**"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"t0", "=", "t0`in"}], ";", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", "t1`in"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pde", "=", 
       RowBox[{"Sequence", "[", 
        RowBox[{"F", ",", "\[Lambda]dFdu", ",", "Q", ",", "BC", ",", "pars"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pde`params", "=", "pars"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pde`rhs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"scheme", "[", "schemeParams", "]"}], "[", 
          RowBox[{"nx", ",", " ", "nu"}], "]"}], "[", 
         RowBox[{"\[CapitalDelta]x", ",", "xi", ",", "xi12"}], "]"}], "[", 
        "pde", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pde`rhs`function", "[", 
        RowBox[{
         RowBox[{"t_", "?", "NumericQ"}], ",", "u_"}], "]"}], ":=", 
       RowBox[{"pde`rhs", "[", 
        RowBox[{"t", ",", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"**", "**", " ", "ICS", " ", "**", "**"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"VectorQ", "[", 
         RowBox[{"u0`in", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "#", "]"}], "===", "Function"}], "&"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"U0", "=", 
          RowBox[{"u0`in", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"u0", "=", 
          RowBox[{"u0`in", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}], ",", 
        RowBox[{"(*", " ", "Else", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u0", "=", "u0`in"}], ";", "\[IndentingNewLine]", 
         RowBox[{"U0", "=", "None"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"u0`pars", "=", "u0`in`pars"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"UnsameQ", "[", 
         RowBox[{
          RowBox[{"Head", "[", "u0", "]"}], ",", "Function"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"**", "**", " ", "u0"}], " ", "vector", " ", 
          RowBox[{"input", " ", "**", "**"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u0i", "=", "u0"}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"**", "**", " ", "u0"}], " ", "function", " ", 
          RowBox[{"input", " ", "**", "**"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"average", ",", "None"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"u0i", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"u0", "[", 
               RowBox[{"#", ",", "u0`in`pars"}], "]"}], "&"}], "/@", "xi"}]}],
            " ", ",", 
           RowBox[{"(*", " ", 
            RowBox[{"No", " ", "cell", " ", "averaging"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"U0", "=!=", "None"}], ",", "\[IndentingNewLine]", 
           RowBox[{"u0i", "=", 
            RowBox[{
             RowBox[{"Differences", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"U0", "[", 
                 RowBox[{"#", ",", "u0`in`pars"}], "]"}], "&"}], "/@", 
               "xi12"}], "]"}], "/", 
             RowBox[{"Differences", "[", "xi12", "]"}]}]}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{"Cell", " ", "averaging", " ", "using", " ", "IC"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"SameQ", "[", 
            RowBox[{"average", ",", "Integrate"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"u0i", "=", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Integrate", "[", 
                 RowBox[{
                  RowBox[{"u0", "[", 
                   RowBox[{"\[Xi]", ",", "u0`in`pars"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Xi]", ",", "#1", ",", "#2"}], "}"}], ",", 
                  "averageOptions"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{"#2", "-", "#1"}], ")"}]}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xi12", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", 
                   RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
                RowBox[{"xi12", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
           "  ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Cell", " ", "averaging", " ", "using", " ", "Integrate"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"SameQ", "[", 
            RowBox[{"average", ",", "NIntegrate"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"u0i", "=", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"NIntegrate", "[", 
                 RowBox[{
                  RowBox[{"u0", "[", 
                   RowBox[{"\[Xi]", ",", "u0`in`pars"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Xi]", ",", "#1", ",", "#2"}], "}"}], ",", 
                  "averageOptions"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{"#2", "-", "#1"}], ")"}]}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xi12", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", 
                   RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
                RowBox[{"xi12", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
          "  ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Cell", " ", "averaging", " ", "using", " ", "NIntegrate"}], " ", 
           "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"UnsameQ", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "u0i", "]"}], ",", 
          RowBox[{"{", "nx", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u0i", "=", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Transpose", "[", "u0i", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"**", "**", " ", "System", " ", "**", "**"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"pde`system", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Equal", "[", 
          RowBox[{
           RowBox[{"pde`u", "[", "t0", "]"}], ",", "u0i"}], "]"}], ",", 
         RowBox[{"Equal", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", "1", "]"}], "[", "pde`u", "]"}], "[", 
            "pde`t", "]"}], ",", 
           RowBox[{"pde`rhs`function", "[", 
            RowBox[{"pde`t", ",", 
             RowBox[{"pde`u", "[", "pde`t", "]"}]}], "]"}]}], "]"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KT`system", "[", 
            RowBox[{"scheme", ",", 
             RowBox[{"Hold", "[", "schemeParams", "]"}]}], "]"}], "[", 
           RowBox[{"nx", ",", "nu"}], "]"}], "[", 
          RowBox[{
          "x0", ",", "x1", ",", "\[CapitalDelta]x", ",", "xi", ",", "xi12"}], 
          "]"}], "[", 
         RowBox[{"t0", ",", "t1"}], "]"}], "[", 
        RowBox[{"u0", ",", 
         RowBox[{"Hold", "[", "u0`pars", "]"}], ",", "u0i"}], "]"}], "[", 
       RowBox[{
        RowBox[{"{", "pde", "}"}], ",", "pde`system", ",", 
        RowBox[{"Hold", "[", "pde`params", "]"}], ",", "pde`rhs", ",", 
        "pde`rhs`function", ",", "pde`t", ",", "pde`u"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "KT`system", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KT`system", "/:", 
    RowBox[{"KT`system`string", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"KT`system", "[", 
           RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
          RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
         RowBox[{
         "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
          "xi12_"}], "]"}], "[", 
        RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
       RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
      RowBox[{
      "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
       "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
    RowBox[{"\"\<KT`system[\>\"", "<>", 
     RowBox[{"ToString", "[", "scheme", "]"}], "<>", "\"\<,...][nx=\>\"", "<>", 
     RowBox[{"ToString", "[", "nx", "]"}], "<>", "\"\<,nu=\>\"", "<>", 
     RowBox[{"ToString", "[", "nu", "]"}], "<>", "\"\<]\>\"", "<>", 
     "\"\<[...][t0=\>\"", "<>", 
     RowBox[{"ToString", "[", "t0", "]"}], "<>", "\"\<,t1=\>\"", "<>", 
     RowBox[{"ToString", "[", "t1", "]"}], "<>", "\"\<][...][...,\>\"", "<>", 
     RowBox[{"ToString", "[", "pde`t", "]"}], "<>", "\"\<,\>\"", "<>", 
     RowBox[{"ToString", "[", "pde`u", "]"}], "<>", "\"\<]\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system", "/:", 
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"KT`system", "[", 
          RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
         RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
        RowBox[{
        "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
         "xi12_"}], "]"}], "[", 
       RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
      RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
     RowBox[{
     "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
      "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
   RowBox[{"IconizedObject", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"KT`system", "[", "scheme", "]"}], "[", 
          RowBox[{"nx", ",", "nu"}], "]"}], "[", 
         RowBox[{
         "x0", ",", "x1", ",", "\[CapitalDelta]x", ",", "xi", ",", "xi12"}], 
         "]"}], "[", 
        RowBox[{"t0", ",", "t1"}], "]"}], "[", 
       RowBox[{"u0", ",", "u0pars", ",", "u0i"}], "]"}], "[", 
      RowBox[{
      "pde", ",", "pde`system", ",", "pde`params", ",", "pde`rhs", ",", 
       "pde`rhs`function", ",", "pde`t", ",", "pde`u"}], "]"}], ",", 
     RowBox[{"\"\<KT`system[\>\"", "<>", 
      RowBox[{"ToString", "[", "scheme", "]"}], "<>", "\"\<,...][nx=\>\"", "<>", 
      RowBox[{"ToString", "[", "nx", "]"}], "<>", "\"\<,nu=\>\"", "<>", 
      RowBox[{"ToString", "[", "nu", "]"}], "<>", "\"\<]\>\"", "<>", 
      "\"\<[...][t0=\>\"", "<>", 
      RowBox[{"ToString", "[", "t0", "]"}], "<>", "\"\<,t1=\>\"", "<>", 
      RowBox[{"ToString", "[", "t1", "]"}], "<>", "\"\<][...][...,\>\"", "<>", 
      RowBox[{"ToString", "[", "pde`t", "]"}], "<>", "\"\<,\>\"", "<>", 
      RowBox[{"ToString", "[", "pde`u", "]"}], "<>", "\"\<]\>\""}], ",", 
     RowBox[{"Rule", "[", 
      RowBox[{"Method", ",", "Automatic"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`scheme", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  "scheme"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system", "/:", 
   RowBox[{"KT`system`scheme`params", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"KT`system", "[", 
          RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
         RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
        RowBox[{
        "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
         "xi12_"}], "]"}], "[", 
       RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
      RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
     RowBox[{
     "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
      "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
   RowBox[{"ReleaseHold", "@", "scheme"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`nx", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  "nx"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system", "/:", 
   RowBox[{"KT`system`nu", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"KT`system", "[", 
          RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
         RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
        RowBox[{
        "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
         "xi12_"}], "]"}], "[", 
       RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
      RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
     RowBox[{
     "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
      "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=",
    "nu"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`x0", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  "x0"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`x1", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  "x1"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`\[CapitalDelta]x", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  "\[CapitalDelta]x"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`xi", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  "xi"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system", "/:", 
   RowBox[{"KT`system`xi12", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"KT`system", "[", 
          RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
         RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
        RowBox[{
        "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
         "xi12_"}], "]"}], "[", 
       RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
      RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
     RowBox[{
     "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
      "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=",
    "xi12"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`t0", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  "t0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system", "/:", 
   RowBox[{"KT`system`t1", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"KT`system", "[", 
          RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
         RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
        RowBox[{
        "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
         "xi12_"}], "]"}], "[", 
       RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
      RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
     RowBox[{
     "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
      "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=",
    "t1"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`u0", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  "u0"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`u0`pars", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0`pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  RowBox[{"ReleaseHold", "@", "u0`pars"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system", "/:", 
   RowBox[{"KT`system`u0i", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"KT`system", "[", 
          RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
         RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
        RowBox[{
        "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
         "xi12_"}], "]"}], "[", 
       RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
      RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
     RowBox[{
     "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
      "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=",
    "u0i"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`pde", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  "pde"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`pde`system", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  "pde`system"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`pde`params", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  RowBox[{"ReleaseHold", "@", "pde`params"}]}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`pde`rhs", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  "pde`rhs"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`pde`rhs`function", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  "pde`rhs`function"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`pde`t", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  "pde`t"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system", "/:", 
   RowBox[{"KT`system`pde`u", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"KT`system", "[", 
          RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
         RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
        RowBox[{
        "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
         "xi12_"}], "]"}], "[", 
       RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
      RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
     RowBox[{
     "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
      "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=",
    "pde`u"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system", "/:", 
   RowBox[{"KT`system`pde`print", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"KT`system", "[", 
          RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
         RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
        RowBox[{
        "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
         "xi12_"}], "]"}], "[", 
       RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
      RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
     RowBox[{
     "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
      "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "t", ",", "x", ",", "v", ",", "dvdt", ",", "dvdx", ",", "F", ",", "Q", 
       ",", "S", ",", "G", ",", "par"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", "\"\<t\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", "\"\<x\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"\"\<u\>\"", ",", 
               RowBox[{"#", "-", "1"}]}], "]"}], ",", "\"\<[t,x]\>\""}], 
            "}"}], "]"}], "&"}], ",", "nu"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dvdx", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<(\!\(\*SubscriptBox[\(\[PartialD]\), \(x\)]\)\>\"", ",", 
             RowBox[{"Subscript", "[", 
              RowBox[{"\"\<u\>\"", ",", 
               RowBox[{"#", "-", "1"}]}], "]"}], ",", "\"\<)[t,x]\>\""}], 
            "}"}], "]"}], "&"}], ",", "nu"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"par", "=", 
       RowBox[{"ReleaseHold", "@", "pde`params"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"F", "=", 
       RowBox[{
        RowBox[{"pde", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"t", ",", "x", ",", "v", ",", "par"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{
        RowBox[{"pde", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"t", ",", "x", ",", "v", ",", "dvdx", ",", "par"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(\[PartialD]\), \(t\)]\)\>\"", ",", 
              "#1", ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#2", "===", "0"}], ",", "Nothing", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<+\!\(\*SubscriptBox[\(\[PartialD]\), \(x\)]\)(\>\"", 
                  ",", "#2", ",", "\"\<)\>\""}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "\"\<==\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#3", "===", "0"}], ",", "Nothing", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\!\(\*SubscriptBox[\(\[PartialD]\), \(x\)]\)(\>\"", ",",
                   "#3", ",", "\"\<)\>\""}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#3", "===", "0"}], ",", "\"\<0\>\""}], "]"}]}], 
             "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], 
          "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"v", ",", "F", ",", "Q"}], "}"}]}], "]"}], "//", 
       "MatrixForm"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system", "/:", 
  RowBox[{"KT`system`pde`test0", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system", "[", 
         RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
        RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
       RowBox[{
       "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
        "xi12_"}], "]"}], "[", 
      RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
     RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
    RowBox[{
    "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
     "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], "]"}], ":=", 
  RowBox[{"pde`rhs`function", "[", 
   RowBox[{"t0", ",", "u0i"}], "]"}]}]}], "Input",
 CellLabel->"In[208]:=",ExpressionUUID->"79fecd36-15cc-470a-9eba-d79844f4f8de"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solution", \
"Subsubsection",ExpressionUUID->"4e32dddb-7e60-4afd-8609-894736300109"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "KT`system`solve", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"KT`system`solve", "/:", 
   RowBox[{"Options", "[", "KT`system`solve", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"AccuracyGoal", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PrecisionGoal", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"WorkingPrecision", "\[Rule]", "MachinePrecision"}], ",", 
     RowBox[{"Method", "\[Rule]", "Automatic"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KT`system`solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KT`system", "[", 
            RowBox[{"scheme_", ",", "schemeParams_"}], "]"}], "[", 
           RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
          RowBox[{
          "x0_", ",", "x1_", ",", "\[CapitalDelta]x_", ",", "xi_", ",", 
           "xi12_"}], "]"}], "[", 
         RowBox[{"t0_", ",", "t1_"}], "]"}], "[", 
        RowBox[{"u0_", ",", "u0pars_", ",", "u0i_"}], "]"}], "[", 
       RowBox[{
       "pde_", ",", "pde`system_", ",", "pde`params_", ",", "pde`rhs_", ",", 
        "pde`rhs`function_", ",", "pde`t_", ",", "pde`u_"}], "]"}], ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"monitorQ_", ":", "True"}], ",", 
     RowBox[{"printQ_", ":", "True"}], ",", 
     RowBox[{"pts_", ":", "All"}], ",", 
     RowBox[{"name_", ":", "None"}], ",", "opts___"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nt", ",", "tw", ",", "tm", ",", "solver", ",", "solution", ",", "ut1i",
        ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nt", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tw", "=", 
       RowBox[{"-", 
        RowBox[{"AbsoluteTime", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solver", "=", 
       RowBox[{"Hold", "[", 
        RowBox[{"NDSolveValue", "[", 
         RowBox[{"pde`system", ",", "pde`u", ",", 
          RowBox[{"{", 
           RowBox[{"pde`t", ",", "t0", ",", "t1"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StepMonitor", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"nt", "++"}], ",", 
             RowBox[{"tm", "=", "pde`t"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"OptionValue", "[", "Method", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AccuracyGoal", "\[Rule]", 
           RowBox[{"OptionValue", "[", "AccuracyGoal", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PrecisionGoal", "\[Rule]", 
           RowBox[{"OptionValue", "[", "PrecisionGoal", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"WorkingPrecision", "\[Rule]", 
           RowBox[{"OptionValue", "[", "WorkingPrecision", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"monitorQ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"solution", "=", 
          RowBox[{"Monitor", "[", 
           RowBox[{
            RowBox[{"ReleaseHold", "@", "solver"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<time step = ``\>\"", ",", "nt"}], "]"}], ",", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<tw = ``s\>\"", ",", 
                RowBox[{"ScientificForm", "[", 
                 RowBox[{"tw", "+", 
                  RowBox[{"AbsoluteTime", "[", "]"}]}], "]"}]}], "]"}], ",", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<t = ``\>\"", ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{"tm", ",", "8"}], "]"}]}], "]"}]}], "}"}]}], "]"}]}],
          ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"solution", "=", 
          RowBox[{"ReleaseHold", "@", "solver"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tw", "+=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"pts", "=!=", "All"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"solution", "=", 
          RowBox[{"KT`system`solution`downSamle", "[", 
           RowBox[{"solution", ",", "pts"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ut1i", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"solution", "[", "t1", "]"}], ",", "nx"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"KT`system`solution", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"KT`system", "[", 
                RowBox[{"scheme", ",", "schemeParams"}], "]"}], "[", 
               RowBox[{"nx", ",", "nu"}], "]"}], "[", 
              RowBox[{
              "x0", ",", "x1", ",", "\[CapitalDelta]x", ",", "xi", ",", 
               "xi12"}], "]"}], "[", 
             RowBox[{"t0", ",", "t1"}], "]"}], "[", 
            RowBox[{"u0", ",", "u0pars", ",", "u0i"}], "]"}], "[", 
           RowBox[{
           "pde", ",", "pde`system", ",", "pde`params", ",", "pde`rhs", ",", 
            "pde`rhs`function", ",", "pde`t", ",", "pde`u"}], "]"}], "]"}], 
         "[", 
         RowBox[{"nt", ",", "tw"}], "]"}], "[", 
        RowBox[{"ut1i", ",", "solution"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"printQ", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"StringRiffle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "@", "$KernelID"}], ",", "\"\< (\>\"", ",", 
             RowBox[{"DateString", "[", "\"\<ISODateTime\>\"", "]"}], ",", 
             "\"\<): \>\"", ",", 
             RowBox[{"KT`system`solution`string", "[", "res", "]"}]}], "}"}], 
           ",", "\"\<\>\""}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"name", "=!=", "None"}], ",", 
        RowBox[{"KT`system`solution`export", "[", 
         RowBox[{"res", ",", "name", ",", "opts"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "KT`system`solution", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system`solution", "/:", 
   RowBox[{"KT`system`solution`string", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
      RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
     RowBox[{"ut1i_", ",", "solution_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringRiffle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<KT`system`solution[nt=\>\"", ",", "nt", ",", "\"\<,tw=\>\"", ",", 
       "tw", ",", "\"\< s][\>\"", ",", 
       RowBox[{"KT`system`string", "[", "system", "]"}], ",", 
       "\"\<][...]\>\""}], "}"}], ",", "\"\<\>\""}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system`solution", "/:", 
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
      RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
     RowBox[{"ut1i_", ",", "solution_"}], "]"}], "]"}], ":=", 
   RowBox[{"IconizedObject", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"KT`system`solution", "[", "system", "]"}], "[", 
       RowBox[{"nt", ",", "tw"}], "]"}], "[", 
      RowBox[{"ut1i", ",", "solution"}], "]"}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<KT`system`solution[nt=\>\"", ",", "nt", ",", "\"\<,tw=\>\"", ",", 
        "tw", ",", "\"\< s][\>\"", ",", "system", ",", "\"\<][...]\>\""}], 
       "}"}], "]"}], ",", 
     RowBox[{"Rule", "[", 
      RowBox[{"Method", ",", "Automatic"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system`solution", "/:", 
  RowBox[{"KT`system`solution`system", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
     RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
    RowBox[{"ut1i_", ",", "solution_"}], "]"}], "]"}], ":=", 
  "system"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system`solution", "/:", 
  RowBox[{"KT`system`solution`nx", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
     RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
    RowBox[{"ut1i_", ",", "solution_"}], "]"}], "]"}], ":=", 
  RowBox[{"KT`system`nx", "[", "system", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system`solution", "/:", 
   RowBox[{"KT`system`solution`\[CapitalDelta]x", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
      RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
     RowBox[{"ut1i_", ",", "solution_"}], "]"}], "]"}], ":=", 
   RowBox[{"KT`system`\[CapitalDelta]x", "[", "system", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system`solution", "/:", 
  RowBox[{"KT`system`solution`nt", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
     RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
    RowBox[{"ut1i_", ",", "solution_"}], "]"}], "]"}], ":=", 
  "nt"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system`solution", "/:", 
   RowBox[{"KT`system`solution`tw", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
      RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
     RowBox[{"ut1i_", ",", "solution_"}], "]"}], "]"}], ":=", "tw"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system`solution", "/:", 
  RowBox[{"KT`system`solution`ut1i", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
     RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
    RowBox[{"ut1i_", ",", "solution_"}], "]"}], "]"}], ":=", 
  "ut1i"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system`solution", "/:", 
   RowBox[{"KT`system`solution`solution", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
      RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
     RowBox[{"ut1i_", ",", "solution_"}], "]"}], "]"}], ":=", "solution"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"KT`system`solution", "/:", 
  RowBox[{"KT`system`solution`xui`t1", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
     RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
    RowBox[{"ut1i_", ",", "solution_"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"KT`system`xi", "[", "system", "]"}], ",", "#"}], "}"}], "]"}],
     "&"}], "/@", "ut1i"}]}], "\[IndentingNewLine]", 
 RowBox[{"KT`system`solution", "/:", 
  RowBox[{"KT`system`solution`xui`t0", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
     RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
    RowBox[{"ut1i_", ",", "solution_"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"KT`system`xi", "[", "system", "]"}], ",", "#"}], "}"}], "]"}],
     "&"}], "/@", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"KT`system`u0i", "[", "system", "]"}], ",", 
     RowBox[{"KT`system`nx", "[", "system", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system`solution", "/:", 
   RowBox[{"KT`system`solution`xui`t", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
       RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
      RowBox[{"ut1i_", ",", "solution_"}], "]"}], ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"KT`system`xi", "[", "system", "]"}], ",", "#"}], "}"}], 
      "]"}], "&"}], "/@", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"solution", "[", "t", "]"}], ",", 
      RowBox[{"KT`system`nx", "[", "system", "]"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system`solution", "/:", 
   RowBox[{"KT`system`solution`ui`t", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
       RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
      RowBox[{"ut1i_", ",", "solution_"}], "]"}], ",", "t_"}], "]"}], ":=", 
   RowBox[{"solution", "[", "t", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system`solution", "/:", 
   RowBox[{"KT`system`solution`xui`t`Manipulate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"KT`system`solution", "[", "system_", "]"}], "[", 
       RowBox[{"nt_", ",", "tw_"}], "]"}], "[", 
      RowBox[{"ut1i_", ",", "solution_"}], "]"}], ",", "params___"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t1", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t1", "=", 
       RowBox[{"KT`system`t1", "[", "system", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"KT`system`xi", "[", "system", "]"}], ",", "#"}], 
              "}"}], "]"}], "&"}], "/@", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"solution", "[", "t", "]"}], ",", 
             RowBox[{"KT`system`nx", "[", "system", "]"}]}], "]"}]}], ",", 
          "params"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "t1"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KT`system`solution`downSamle", "[", 
    RowBox[{"sol_", ",", "pts_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "filename", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"sol", "[", "#", "]"}]}], "}"}], "&"}], "/@", "pts"}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<Hermite\>\""}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "3"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system`solution`export", "[", 
   RowBox[{"sol_", ",", "name_", ",", "opts___"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "filename", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "name", "]"}], "===", "String"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"filename", "=", "name"}], ";"}], ",", 
       RowBox[{"(*", " ", "Else", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"filename", "=", 
         RowBox[{"name", "[", "sol", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"filename", ",", "sol", ",", "opts"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[236]:=",ExpressionUUID->"3a367ea1-95b5-472a-a274-08885bfd7cd1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Rework", \
"NonEvaluatingSubsubsection",ExpressionUUID->"090a911b-e74e-4966-a1ac-\
efec9b68924f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PDE", "]"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Constructors", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PDE", "[", 
     RowBox[{"nx_", ",", 
      RowBox[{"nu_", ":", "1"}], ",", 
      RowBox[{"nadd_", ":", "0"}]}], "]"}], "[", 
    RowBox[{"terms_List", ",", "BC_"}], "]"}], ":=", 
   RowBox[{"PDE", "[", 
    RowBox[{"Association", "@", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<nx\>\"", "\[Rule]", "nx"}], ",", 
         RowBox[{"\"\<nu\>\"", "\[Rule]", "nu"}], ",", 
         RowBox[{"\"\<nadd\>\"", "\[Rule]", "nadd"}]}], "}"}], ",", "terms", 
       ",", 
       RowBox[{"{", 
        RowBox[{"\"\<BC\>\"", "\[Rule]", "BC"}], "}"}]}], "]"}]}], "]"}]}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Getter", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PDE", "[", "asoc_Association", "]"}], "[", "token_", "]"}], ":=", 
  RowBox[{"asoc", "[", "token", "]"}]}]}], "Code",
 CellLabel->"In[216]:=",ExpressionUUID->"6bfab949-4baf-434c-aed7-fb7ab5444318"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Kurganov-Tadmor central scheme O(",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalDelta]x", "2"], TraditionalForm]],ExpressionUUID->
  "adccb778-6bb1-4682-b219-6fa1fff60da5"],
 ") [KTO2-0] "
}], "Section",ExpressionUUID->"71a68e13-385d-4cf1-a51e-9516ad7c15dc"],

Cell[CellGroupData[{

Cell["Formulas", \
"Subsection",ExpressionUUID->"e2bcd951-40b8-4c82-bc02-a7066e52e0ed"],

Cell[TextData[{
 "[KTO2-0]: [A. Kurganov and E. Tadmor - 2000 - ",
 StyleBox["New High-Resolution Central Schemes for Nonlinear Conservation \
Laws and Convection\[Dash]Diffusion Equations",
  FontSlant->"Italic"],
 "]\n[",
 StyleBox["https://en.wikipedia.org/wiki/MUSCL_scheme",
  FontSlant->"Italic"],
 "] "
}], "Text",ExpressionUUID->"6bc42aa4-e4eb-46ff-b035-ceb03b56fa62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SubscriptBox["u", "x"], ")"}], "j"], "->", 
   RowBox[{"0.5", "*", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["u", 
        RowBox[{"j", "+", "1"}]], "-", 
       SubscriptBox["u", "j"]}], ")"}], "\[CapitalDelta]x"], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["u", "j"], "-", 
       SubscriptBox["u", 
        RowBox[{"j", "-", "1"}]]}], ",", 
      RowBox[{
       SubscriptBox["u", 
        RowBox[{"j", "+", "1"}]], "-", 
       SubscriptBox["u", "j"]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"[", 
    RowBox[{
     RowBox[{"KTO2", "-", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"eq", ".", " ", 
       RowBox[{"(", "2.4", ")"}]}], "*", "0.5"}]}], "]"}], "using", " ", 
   "generic", " ", "flux", " ", "limiters", " ", "\[Phi]", " ", 
   RowBox[{"from", " ", "[", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
      "Flux_limiter"}]}], "]"}], " ", "see", " ", 
   RowBox[{"also", " ", "[", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
      "MUSCL_scheme"}]}], "]"}]}], " ", 
  ";"}]}], "DisplayFormulaNumbered",ExpressionUUID->"ee2cddbf-5a1e-42c1-bd2b-\
adeec5d51e5b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubsuperscriptBox["u", 
    RowBox[{"j", "+", 
     RowBox[{"1", "/", "2"}]}], "+"], "\[Rule]", 
   RowBox[{
    SubscriptBox["u", 
     RowBox[{"j", "+", "1"}]], "-", 
    RowBox[{"\[CapitalDelta]x", 
     SubscriptBox[
      RowBox[{"(", 
       SubscriptBox["u", "x"], ")"}], 
      RowBox[{"j", "+", "1"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubsuperscriptBox["u", 
    RowBox[{"j", "+", 
     RowBox[{"1", "/", "2"}]}], "-"], "\[Rule]", 
   RowBox[{
    SubscriptBox["u", "j"], "+", 
    RowBox[{"\[CapitalDelta]x", 
     SubscriptBox[
      RowBox[{"(", 
       SubscriptBox["u", "x"], ")"}], "j"]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"[", 
   RowBox[{
    RowBox[{"KTO2", "-", "0"}], ",", " ", 
    RowBox[{"eq", ".", " ", 
     RowBox[{"(", "4.5", ")"}]}], ",", " ", 
    RowBox[{"with", " ", "modified", " ", "definition", " ", "of", " ", 
     RowBox[{"(", 
      SubscriptBox["u", "x"], ")"}]}]}], "]"}], 
  ";"}]}], "DisplayFormulaNumbered",ExpressionUUID->"acea18f2-7dae-418f-a212-\
42d746d1716e"],

Cell[BoxData[{
 RowBox[{
  SubscriptBox["a", 
   RowBox[{"j", "+", 
    RowBox[{"1", "/", "2"}]}]], "\[Rule]", 
  RowBox[{"Max", "[", 
   RowBox[{
    RowBox[{"Max", "[", 
     RowBox[{"Abs", "[", 
      RowBox[{"\[Lambda]dFdu", "[", 
       SubsuperscriptBox["u", 
        RowBox[{"j", "+", 
         RowBox[{"1", "/", "2"}]}], "-"], "]"}], "]"}], "]"}], ",", 
    RowBox[{"Max", "[", 
     RowBox[{"Abs", "[", 
      RowBox[{"\[Lambda]dFdu", "[", 
       SubsuperscriptBox["u", 
        RowBox[{"j", "+", 
         RowBox[{"1", "/", "2"}]}], "+"], "]"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"[", 
    RowBox[{
     RowBox[{"KTO2", "-", "0"}], ",", " ", 
     RowBox[{"eq", ".", " ", 
      RowBox[{"(", "3.2", ")"}]}]}], "]"}], " ", 
   RowBox[{"and", "  ", "[", 
    RowBox[{
     RowBox[{"KTO2", "-", "0"}], ",", " ", 
     RowBox[{"footnote", " ", "2"}]}], "]"}]}], " ", 
  ";"}]}], "DisplayFormulaNumbered",ExpressionUUID->"0b681c4b-27f9-46f4-8c75-\
5b536dd40abc"],

Cell[BoxData[{
 RowBox[{
  SubscriptBox["H", 
   RowBox[{"j", "+", 
    RowBox[{"1", "/", "2"}]}]], "\[Rule]", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"F", "[", 
      SubsuperscriptBox["u", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "+"], "]"}], "+", 
     RowBox[{"F", "[", 
      SubsuperscriptBox["u", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "-"], "]"}]}], "2"], "-", 
   RowBox[{
    FractionBox[
     SubscriptBox["a", 
      RowBox[{"j", "+", 
       RowBox[{"1", "/", "2"}]}]], "2"], 
    RowBox[{"(", 
     RowBox[{
      SubsuperscriptBox["u", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "+"], "-", 
      SubsuperscriptBox["u", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "-"]}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"[", 
   RowBox[{
    RowBox[{"KTO2", "-", "0"}], ",", " ", 
    RowBox[{"eq", ".", " ", 
     RowBox[{"(", "4.4", ")"}]}]}], "]"}], " ", 
  ";"}]}], "DisplayFormulaNumbered",ExpressionUUID->"7fdb935f-9f92-4701-bf2c-\
6bc54c04cc04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", " ", 
   RowBox[{
    SubscriptBox["u", "j"], "/", "dt"}]}], "\[Rule]", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "\[CapitalDelta]x"]}], 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["H", 
      RowBox[{"j", "+", 
       RowBox[{"1", "/", "2"}]}]], "-", 
     SubscriptBox["H", 
      RowBox[{"j", "-", 
       RowBox[{"1", "/", "2"}]}]]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"[", 
   RowBox[{
    RowBox[{"KTO2", "-", "0"}], ",", " ", 
    RowBox[{"eq", ".", " ", 
     RowBox[{"(", "4.3", ")"}]}]}], "]"}], " ", 
  ";"}]}], "DisplayFormulaNumbered",ExpressionUUID->"670f453f-14f5-4aa7-9432-\
9f35a991c87e"],

Cell[TextData[{
 "[KTO2-1]: [A. Kurganov, S. Noelle and G. Petrova - 2001 -",
 StyleBox[" Semidiscrete Central-Upwind Schemes for Hyperbolic Conservation \
Laws and Hamilton--Jacobi Equations",
  FontSlant->"Italic"],
 "]"
}], "Text",ExpressionUUID->"07f3b593-0290-4b4d-a62a-ad710986b9ee"],

Cell[BoxData[{
 RowBox[{
  SubsuperscriptBox["a", 
   RowBox[{"j", "+", 
    RowBox[{"1", "/", "2"}]}], "+"], "\[Rule]", 
  RowBox[{"Max", "[", 
   RowBox[{
    RowBox[{"Max", "@", 
     RowBox[{"\[Lambda]dFdu", "[", 
      SubsuperscriptBox["u", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "-"], "]"}]}], ",", 
    RowBox[{"Max", "@", 
     RowBox[{"\[Lambda]dFdu", "[", 
      SubsuperscriptBox["u", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "+"], "]"}]}], ",", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  SubsuperscriptBox["a", 
   RowBox[{"j", "+", 
    RowBox[{"1", "/", "2"}]}], "-"], "\[Rule]", 
  RowBox[{"Min", "[", 
   RowBox[{
    RowBox[{"Min", "@", 
     RowBox[{"\[Lambda]dFdu", "[", 
      SubsuperscriptBox["u", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "-"], "]"}]}], ",", 
    RowBox[{"Min", "@", 
     RowBox[{"\[Lambda]dFdu", "[", 
      SubsuperscriptBox["u", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "+"], "]"}]}], ",", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"[", 
  RowBox[{
   RowBox[{"KTO2", "-", "1"}], ",", " ", 
   RowBox[{"eq", ".", " ", 
    RowBox[{"(", "3.2", ")"}]}]}], 
  "]"}]}], "DisplayFormulaNumbered",ExpressionUUID->"8e9b13f2-7475-4462-8a20-\
c3a132130f72"],

Cell[BoxData[{
 RowBox[{
  SubscriptBox["H", 
   RowBox[{"j", "+", 
    RowBox[{"1", "/", "2"}]}]], "\[Rule]", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      SubsuperscriptBox["a", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "+"], 
      RowBox[{"F", "[", 
       SubsuperscriptBox["u", 
        RowBox[{"j", "+", 
         RowBox[{"1", "/", "2"}]}], "-"], "]"}]}], "-", 
     RowBox[{
      SubsuperscriptBox["a", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "-"], 
      RowBox[{"F", "[", 
       SubsuperscriptBox["u", 
        RowBox[{"j", "+", 
         RowBox[{"1", "/", "2"}]}], "+"], "]"}]}]}], 
    RowBox[{
     SubsuperscriptBox["a", 
      RowBox[{"j", "+", 
       RowBox[{"1", "/", "2"}]}], "+"], "-", 
     SubsuperscriptBox["a", 
      RowBox[{"j", "+", 
       RowBox[{"1", "/", "2"}]}], "-"]}]], "+", 
   RowBox[{
    FractionBox[
     RowBox[{
      SubsuperscriptBox["a", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "+"], 
      SubsuperscriptBox["a", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "-"]}], 
     RowBox[{
      SubsuperscriptBox["a", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "+"], "-", 
      SubsuperscriptBox["a", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "-"]}]], 
    RowBox[{"(", 
     RowBox[{
      SubsuperscriptBox["u", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "+"], "-", 
      SubsuperscriptBox["u", 
       RowBox[{"j", "+", 
        RowBox[{"1", "/", "2"}]}], "-"]}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"[", 
   RowBox[{
    RowBox[{"KTO2", "-", "1"}], ",", " ", 
    RowBox[{"eq", ".", " ", 
     RowBox[{"(", "3.15", ")"}]}]}], "]"}], " ", 
  ";"}]}], "DisplayFormulaNumbered",ExpressionUUID->"4aa6be37-e15c-4c72-8be2-\
cf6f65b62996"]
}, Closed]],

Cell[CellGroupData[{

Cell["KT`O2v0 (=KT`O2) [KTO2-0]", \
"Subsection",ExpressionUUID->"2bb848e4-a04e-490e-85ae-fb27a70921ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "KT`O2v0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"KT`O2v0", "[", 
       RowBox[{"\[Phi]_", ":", "KT`\[Phi]`MinMod"}], "]"}], "[", 
      RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
     RowBox[{"\[CapitalDelta]x_", ",", "x_", ",", "x12_"}], "]"}], "[", 
    RowBox[{
    "F_", ",", "\[Lambda]dFdu_", ",", "Q_", ",", "B_", ",", "pars___"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"u", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Conserved", " ", 
            RowBox[{"quanties", ":", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "2"}], "0"], ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "1"}], "0"], ",", 
                 SubsuperscriptBox["u", "0", "0"], ",", "...", ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "1"}], "0"], ",", 
                 SubsuperscriptBox["u", "nx", "0"], ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "+", "1"}], "0"]}], "}"}], ",", "...", ",", 
               RowBox[{"{", 
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "2"}], 
                  RowBox[{"nu", "-", "1"}]], ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "1"}], 
                  RowBox[{"nu", "-", "1"}]], ",", 
                 SubsuperscriptBox["u", "0", 
                  RowBox[{"nu", "-", "1"}]], ",", "...", ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "1"}], 
                  RowBox[{"nu", "-", "1"}]], ",", 
                 SubsuperscriptBox["u", "nx", 
                  RowBox[{"nu", "-", "1"}]], ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "+", "1"}], 
                  RowBox[{"nu", "-", "1"}]]}], "}"}]}], "}"}]}]}], ",", " ", 
           RowBox[{"dim", "=", 
            RowBox[{"nu", "*", 
             RowBox[{"(", 
              RowBox[{"nx", "+", "4"}], ")"}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t\t", "\[CapitalDelta]u", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Differences", " ", "of", " ", "conserved", " ", 
            RowBox[{"quanties", ":", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubsuperscriptBox["u", 
                   RowBox[{"-", "1"}], "0"], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"-", "2"}], "0"]}], ",", 
                 RowBox[{
                  SubsuperscriptBox["u", "0", "0"], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"-", "1"}], "0"]}], ",", "...", ",", 
                 RowBox[{
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "-", "1"}], "0"], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "-", "2"}], "0"]}], ",", 
                 RowBox[{
                  SubsuperscriptBox["u", "nx", "0"], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "-", "1"}], "0"]}], ",", 
                 RowBox[{
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "+", "1"}], "0"], "-", 
                  SubsuperscriptBox["u", "nx", "0"]}]}], "}"}], ",", "...", 
               ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubsuperscriptBox["u", 
                   RowBox[{"-", "1"}], 
                   RowBox[{"nu", "-", "1"}]], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"-", "2"}], 
                   RowBox[{"nu", "-", "1"}]]}], ",", 
                 RowBox[{
                  SubsuperscriptBox["u", "0", 
                   RowBox[{"nu", "-", "1"}]], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"-", "1"}], 
                   RowBox[{"nu", "-", "1"}]]}], ",", "...", ",", 
                 RowBox[{
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "-", "1"}], 
                   RowBox[{"nu", "-", "1"}]], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "-", "2"}], 
                   RowBox[{"nu", "-", "1"}]]}], ",", 
                 RowBox[{
                  SubsuperscriptBox["u", "nx", 
                   RowBox[{"nu", "-", "1"}]], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "-", "1"}], 
                   RowBox[{"nu", "-", "1"}]]}], ",", 
                 RowBox[{
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "+", "1"}], 
                   RowBox[{"nu", "-", "1"}]], "-", 
                  SubsuperscriptBox["u", "nx", 
                   RowBox[{"nu", "-", "1"}]]}]}], "}"}]}], "}"}]}]}], ",", 
           " ", 
           RowBox[{"dim", "=", 
            RowBox[{"nu", "*", 
             RowBox[{"(", 
              RowBox[{"nx", "+", "3"}], ")"}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", "ux", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Reconstructed", " ", "derivatives", " ", 
             SubscriptBox[
              RowBox[{"(", 
               SubsuperscriptBox["u", "x", "j"], ")"}], "i"]}], "=", 
            RowBox[{"0.5", "*", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", "1"}], "j"], "-", 
               SubsuperscriptBox["u", "i", "j"]}], ")"}], "*", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{
               RowBox[{
                SubsuperscriptBox["u", "i", "j"], "-", 
                SubsuperscriptBox["u", 
                 RowBox[{"i", "-", "1"}], "j"]}], ",", 
               RowBox[{
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", "1"}], "j"], "-", 
                SubsuperscriptBox["u", "i", "j"]}]}], "]"}]}]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{"nu", "*", 
             RowBox[{"(", 
              RowBox[{"nx", "+", "2"}], ")"}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t\t", "up12T", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Reconstructed", " ", "slopes", " ", 
             SubsuperscriptBox["u", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], 
              RowBox[{"j", ",", "+"}]]}], "=", 
            RowBox[{
             SubsuperscriptBox["u", 
              RowBox[{"i", "+", "1"}], "j"], "-", 
             SubscriptBox[
              RowBox[{"(", 
               SubsuperscriptBox["u", "x", "j"], ")"}], 
              RowBox[{"i", "+", "1"}]]}]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{
            RowBox[{"(", "T", ")"}], ":", " ", 
            RowBox[{"values", " ", "at", " ", "constant", " ", 
             SubscriptBox["x", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}]], " ", "are", " ", "grouped"}]}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "\t\t", "um12T", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Reconstructed", " ", "slopes", " ", 
             SubsuperscriptBox["u", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], 
              RowBox[{"j", ",", "-"}]]}], "=", 
            RowBox[{
             SubsuperscriptBox["u", "i", "j"], "+", 
             SubscriptBox[
              RowBox[{"(", 
               SubsuperscriptBox["u", "x", "j"], ")"}], "i"]}]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "Fp12T", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Flux", " ", "through", " ", 
             SubscriptBox["x", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}]], " ", "using", " ", 
             RowBox[{"{", 
              SubsuperscriptBox["F", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], 
               RowBox[{"j", ",", "+"}]], "}"}]}], "=", 
            RowBox[{"F", "[", 
             RowBox[{"t", ",", 
              RowBox[{"{", 
               RowBox[{
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{"0", ",", "+"}]], ",", "...", ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{
                  RowBox[{"nu", "-", "1"}], ",", "+"}]]}], "}"}], ",", 
              "params"}], "]"}]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "Fm12T", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Flux", " ", "through", " ", 
             SubscriptBox["x", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}]], " ", "using", " ", 
             RowBox[{"{", 
              SubsuperscriptBox["F", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], 
               RowBox[{"j", ",", "-"}]], "}"}]}], "=", 
            RowBox[{"F", "[", 
             RowBox[{"t", ",", 
              RowBox[{"{", 
               RowBox[{
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{"0", ",", "-"}]], ",", "...", ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{
                  RowBox[{"nu", "-", "1"}], ",", "-"}]]}], "}"}], ",", 
              "params"}], "]"}]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "\[Lambda]p12T", ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Jacobian", " ", "eigenvalues", " ", "at", " ", 
             RowBox[{
              SubscriptBox["x", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}]], ":", " ", 
              SubsuperscriptBox["\[Lambda]", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "+"]}]}], "=", 
            RowBox[{"\[Lambda]dFdu", "[", 
             RowBox[{"t", ",", 
              RowBox[{"{", 
               RowBox[{
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{"0", ",", "+"}]], ",", "...", ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{
                  RowBox[{"nu", "-", "1"}], ",", "+"}]]}], "}"}], ",", 
              "params"}], "]"}]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "\[Lambda]m12T", ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Jacobian", " ", "eigenvalues", " ", "at", " ", 
             RowBox[{
              SubscriptBox["x", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}]], ":", " ", 
              SubsuperscriptBox["\[Lambda]", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "-"]}]}], "=", 
            RowBox[{"\[Lambda]dFdu", "[", 
             RowBox[{"t", ",", 
              RowBox[{"{", 
               RowBox[{
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{"0", ",", "-"}]], ",", "...", ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{
                  RowBox[{"nu", "-", "1"}], ",", "-"}]]}], "}"}], ",", 
              "params"}], "]"}]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "a12T", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Approxmiate", " ", "velocities", " ", "at", " ", 
             RowBox[{
              SubscriptBox["x", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}]], ":", " ", 
              SubscriptBox["a", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}]]}]}], "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Max", "@", 
               RowBox[{"Abs", "@", 
                SubsuperscriptBox["\[Lambda]", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], "+"]}]}], ",", 
              RowBox[{"Max", "@", 
               RowBox[{"Abs", "@", 
                SubsuperscriptBox["\[Lambda]", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], "-"]}]}]}], "]"}]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "1"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "H12", " ", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Numerical", " ", "fluxes", " ", "at", " ", 
            SubscriptBox["x", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}]]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\t\t", "uT", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Conserved", " ", "quanties"}], ",", " ", 
           RowBox[{"dim", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "2"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "dudxT", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Approximate", " ", "derivatives"}], ",", " ", 
           RowBox[{"dim", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "P12"}], 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Diffusion", " ", "flux"}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{"nu", "*", 
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", "}"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"**", "**", " ", "Boundary"}], " ", 
         RowBox[{"condition", " ", "**", "**"}]}], " ", "*)"}], "\n", "\t\t", 
       RowBox[{
        RowBox[{"u", "=", 
         RowBox[{"B", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.", ",", "0."}], "}"}], ",", "#", ",", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0."}], "}"}]}], "]"}], "&"}], "/@", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"v", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"nx", "*", "nu"}]}], "}"}]}], "]"}], ",", "nx"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"**", "**", " ", "Convection"}], " ", 
          RowBox[{"Flux", " ", "**", "**"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"\[CapitalDelta]u", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Differences", "[", "#", "]"}], "&"}], "/@", " ", "u"}]}], 
        " ", ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"ux", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"0.5", "*", "#2", 
               RowBox[{"(", 
                RowBox[{"\[Phi]", "[", 
                 RowBox[{"#1", ",", "#2"}], "]"}], ")"}]}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"Take", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
           "&"}], "/@", "\[CapitalDelta]u"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"[", 
            RowBox[{
             RowBox[{"KTO2", "-", "0"}], ",", " ", 
             RowBox[{
              RowBox[{"eq", ".", " ", 
               RowBox[{"(", "2.4", ")"}]}], "*", "0.5", "*", 
              "\[CapitalDelta]x"}]}], "]"}], ":", " ", 
           RowBox[{
           "modified", " ", "to", " ", "be", " ", "compatible", " ", "with", 
            " ", 
            RowBox[{
            "generic", "\\\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
             "flux"}], " ", "limiters", " ", 
            RowBox[{"from", " ", "[", 
             RowBox[{
              RowBox[{"https", ":"}], "//", 
              RowBox[{
               RowBox[{
                RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], 
               "/", "Flux_limiter"}]}], "]"}]}]}], ",", " ", 
          RowBox[{"see", " ", 
           RowBox[{"also", " ", "[", 
            RowBox[{
             RowBox[{"https", ":"}], "//", 
             RowBox[{
              RowBox[{
               RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], 
              "/", "MUSCL_scheme"}]}], "]"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"up12T", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", 
                  RowBox[{"-", "2"}]}], "}"}]}], "]"}], "&"}], "/@", "u"}], 
            ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], "/@", "ux"}], 
            ")"}]}], "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"[", 
           RowBox[{
            RowBox[{"KTO2", "-", "0"}], ",", " ", 
            RowBox[{"eq", ".", " ", 
             RowBox[{"(", "4.5", ")"}]}]}], "]"}], ":", " ", 
          RowBox[{
          "modified", " ", "to", " ", "be", " ", "compatible", " ", "with", 
           " ", "generic", " ", "flux", " ", "limiters"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"um12T", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", 
                  RowBox[{"-", "3"}]}], "}"}]}], "]"}], "&"}], "/@", "u"}], 
            ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "2"}]}], "}"}]}], "]"}], "&"}], "/@", "ux"}], 
            ")"}]}], "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"[", 
           RowBox[{
            RowBox[{"KTO2", "-", "0"}], ",", " ", 
            RowBox[{"eq", ".", " ", 
             RowBox[{"(", "4.5", ")"}]}]}], "]"}], ":", " ", 
          RowBox[{
          "modified", " ", "to", " ", "be", " ", "compatible", " ", "with", 
           " ", "generic", " ", "flux", " ", "limiters"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"\[Lambda]p12T", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Lambda]dFdu", "[", 
             RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x12", ",", "up12T"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"\[Lambda]m12T", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Lambda]dFdu", "[", 
             RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x12", ",", "um12T"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"a12T", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Max", "@", 
               RowBox[{"Abs", "@", "#1"}]}], ",", 
              RowBox[{"Max", "@", 
               RowBox[{"Abs", "@", "#2"}]}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Lambda]p12T", ",", "\[Lambda]m12T"}], "}"}]}], "]"}]}],
         ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"[", 
           RowBox[{
            RowBox[{"KTO2", "-", "0"}], ",", " ", 
            RowBox[{"eq", ".", " ", 
             RowBox[{"(", "3.2", ")"}]}]}], "]"}], " ", "[", 
          RowBox[{
           RowBox[{"KTO2", "-", "0"}], ",", " ", 
           RowBox[{"footnote", " ", "2"}]}], "]"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", "\n", "\t\t", 
        RowBox[{"Fp12T", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x12", ",", "up12T"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Fm12T", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x12", ",", "um12T"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"H12", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"0.5", "*", 
           RowBox[{"(", 
            RowBox[{"Fp12T", "+", "Fm12T", "-", 
             RowBox[{"a12T", "*", 
              RowBox[{"(", 
               RowBox[{"up12T", "-", "um12T"}], ")"}]}]}], ")"}]}], "]"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"[", 
            RowBox[{
             RowBox[{"KTO2", "-", "0"}], ",", " ", 
             RowBox[{"eq", ".", " ", 
              RowBox[{"(", "4.4", ")"}]}]}], "]"}], ":", "  ", 
           RowBox[{"{", 
            SubscriptBox["H", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}]], "}"}]}], "=", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"F", "[", 
              RowBox[{"t", ",", 
               SubscriptBox["x", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}]], ",", 
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "+"]}], "]"}], "+", 
             RowBox[{"F", "[", 
              RowBox[{"t", ",", 
               SubscriptBox["x", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}]], ",", 
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "-"]}], "]"}]}], "2"], "-", 
           RowBox[{
            FractionBox[
             SubsuperscriptBox["a", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], "+"], "2"], 
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["u", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "+"], "-", 
              SubsuperscriptBox["u", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "-"]}], ")"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"**", "**", " ", "Diffusion"}], " ", 
          RowBox[{"Flux", " ", "**", "**"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"uT", "=", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "u", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"dudxT", "=", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", "\[CapitalDelta]u", "]"}], "/", 
            "\[CapitalDelta]x"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"P12", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"0.5", "*", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Q", "[", 
                RowBox[{"t", ",", "#1", ",", "#3", ",", "#5", ",", "pars"}], 
                "]"}], "+", 
               RowBox[{"Q", "[", 
                RowBox[{"t", ",", "#2", ",", "#4", ",", "#5", ",", "pars"}], 
                "]"}]}], "&"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"x12", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                   RowBox[{"\[CapitalDelta]x", "*", "0.5"}]}], "}"}], ",", 
                 "x"}], "]"}], ",", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"=", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["x", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}]], "-", 
                    RowBox[{"\[CapitalDelta]x", "/", "2"}]}], "=", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["x", 
                    RowBox[{"-", "1"}]], ",", 
                    RowBox[{"{", 
                    SubscriptBox["x", "i"], "}"}]}], "}"}], "\[Congruent]", 
                    RowBox[{"{", 
                    SubscriptBox[
                    OverscriptBox["x", "^"], "i"], "}"}]}]}]}], ",", " ", 
                 RowBox[{
                 "contains", " ", "cell", " ", "center", " ", "of", " ", 
                  "second", " ", "ghost", " ", 
                  RowBox[{"cell", " ", "[", 
                   RowBox[{
                    SubscriptBox["x", 
                    RowBox[{
                    RowBox[{"-", "3"}], "/", "2"}]], ",", 
                    SubscriptBox["x", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]]}], "]"}]}]}], " ", "*)"}],
                "\[IndentingNewLine]", "\t\t\t", 
               RowBox[{"Join", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"x12", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "+", 
                   RowBox[{"\[CapitalDelta]x", "*", "0.5"}]}], "}"}]}], "]"}],
                ",", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"=", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["x", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}]], "+", 
                    RowBox[{"\[CapitalDelta]x", "/", "2"}]}], "=", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    SubscriptBox["x", "i"], "}"}], ",", 
                    SubscriptBox["x", "n"]}], "}"}], "\[Congruent]", 
                    RowBox[{"{", 
                    SubscriptBox[
                    OverscriptBox["x", "^"], 
                    RowBox[{"i", "+", "1"}]], "}"}]}]}]}], ",", " ", 
                 RowBox[{
                 "contains", " ", "cell", " ", "center", " ", "of", " ", 
                  "penultimate", " ", "ghost", " ", 
                  RowBox[{"cell", " ", "[", 
                   RowBox[{
                    SubscriptBox["x", 
                    RowBox[{"n", "-", 
                    RowBox[{"1", "/", "2"}]}]], ",", 
                    SubscriptBox["x", 
                    RowBox[{"n", "+", 
                    RowBox[{"1", "/", "2"}]}]]}], "]"}]}]}], " ", "*)"}], 
               "\[IndentingNewLine]", "\t\t\t", 
               RowBox[{"Take", "[", 
                RowBox[{"uT", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{"=", 
                 SubscriptBox["u", "i"]}], " ", "*)"}], "\[IndentingNewLine]",
                "\t\t\t", 
               RowBox[{"Take", "[", 
                RowBox[{"uT", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"(*", " ", 
                RowBox[{"=", 
                 SubscriptBox["u", 
                  RowBox[{"i", "+", "1"}]]}], " ", "*)"}], 
               "\[IndentingNewLine]", "\t\t\t", "dudxT"}], 
              RowBox[{"(*", " ", 
               RowBox[{"=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["u", 
                    RowBox[{"i", "+", "1"}]], "-", 
                   SubscriptBox["u", "i"]}], ")"}], "/", 
                 "\[CapitalDelta]x"}]}], " ", "*)"}], "\[IndentingNewLine]", 
              "\t\t", "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"[", 
            RowBox[{
             RowBox[{"KTO2", "-", "0"}], ",", " ", 
             RowBox[{"eq", ".", " ", 
              RowBox[{"(", "4.14", ")"}]}]}], "]"}], ":", " ", 
           RowBox[{"{", 
            SubscriptBox["P", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}]], "}"}]}], "=", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Q", "[", 
              RowBox[{"t", ",", 
               SubscriptBox[
                OverscriptBox["x", "^"], "i"], ",", 
               SubscriptBox["u", "i"], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["u", 
                   RowBox[{"i", "+", "1"}]], "-", 
                  SubscriptBox["u", "i"]}], ")"}], "/", 
                "\[CapitalDelta]x"}]}], "]"}], "+", 
             RowBox[{"Q", "[", 
              RowBox[{"t", ",", 
               SubscriptBox[
                OverscriptBox["x", "^"], 
                RowBox[{"i", "+", "1"}]], ",", 
               SubscriptBox["u", 
                RowBox[{"i", "+", "1"}]], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["u", 
                   RowBox[{"i", "+", "1"}]], "-", 
                  SubscriptBox["u", "i"]}], ")"}], "/", 
                "\[CapitalDelta]x"}]}], "]"}]}], ")"}]}]}], " ", "*)"}], "\n",
         "\t\t", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"**", "**", " ", "Result", " ", "**", "**"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Return", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Differences", "[", "#1", "]"}]}], "+", 
                 RowBox[{"Differences", "[", "#2", "]"}]}], ")"}], "/", 
               "\[CapitalDelta]x"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"H12", ",", "P12"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
         "]"}]}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"KTO2", "-", "0"}], ",", 
         RowBox[{"eq", ".", 
          RowBox[{"(", "4.13", ")"}]}]}], "]"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", "]"}], ",", " ", 
     RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", " ", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "->", "True"}]}], "}"}]}]}],
     "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "KT`O2", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`O2", "=", "KT`O2v0"}], ";"}]}], "Code",
 CellLabel->
  "In[256]:=",ExpressionUUID->"a6890121-2dbd-4feb-9d25-303068d199e7"],

Cell[CellGroupData[{

Cell["Alternative diffusion term evaluated at x12", \
"NonEvaluatingSubsubsection",ExpressionUUID->"4efdfc9c-a08f-406e-8117-\
f69912513333"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"**", "**", " ", "Diffusion"}], " ", 
    RowBox[{"Flux", " ", "**", "**"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"uT", "=", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", "u", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dudxT", "=", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "\[CapitalDelta]u", "]"}], "/", 
        "\[CapitalDelta]x"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P12", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"0.5", "*", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Q", "[", 
            RowBox[{"t", ",", "#1", ",", "#2", ",", "#4", ",", "pars"}], 
            "]"}], "+", 
           RowBox[{"Q", "[", 
            RowBox[{"t", ",", "#1", ",", "#3", ",", "#4", ",", "pars"}], 
            "]"}]}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"x12", ",", 
           RowBox[{"Take", "[", 
            RowBox[{"uT", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Take", "[", 
            RowBox[{"uT", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "dudxT"}], "}"}]}], 
        "]"}]}], "]"}]}], 
    ";"}]}]}]], \
"NonEvaluatingCode",ExpressionUUID->"f6c34a93-6c35-4300-b0f8-b24796be731b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["KT`O2v1 [KTO2-1]/[KAMM]", \
"NonEvaluatingSubsection",ExpressionUUID->"8827d324-c50b-4865-948e-\
6a9e4822e2bc"],

Cell[BoxData[{
 RowBox[{
  SubsuperscriptBox["a", 
   RowBox[{"i", "+", 
    RowBox[{"1", "/", "2"}]}], "\[PlusMinus]"], "\[Rule]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Max", "/", "Min"}], ")"}], "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Max", "/", "Min"}], ")"}], "[", 
     SubsuperscriptBox["\[Lambda]", 
      RowBox[{"i", "+", 
       RowBox[{"1", "/", "2"}]}], "+"], "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Max", "/", "Min"}], ")"}], "[", 
     SubsuperscriptBox["\[Lambda]", 
      RowBox[{"i", "+", 
       RowBox[{"1", "/", "2"}]}], "-"], "]"}], ",", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"[", 
   RowBox[{
    RowBox[{"KTO2", "-", "1"}], ",", " ", 
    RowBox[{"eq", ".", " ", 
     RowBox[{"(", "3.2", ")"}]}]}], "]"}], " ", 
  ";"}]}], "DisplayFormulaNumbered",ExpressionUUID->"1bf23c0d-e26b-45fc-acec-\
032340e2ac9d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "KT`O2v1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KT`O2v1", "[", 
      RowBox[{
       RowBox[{"\[Phi]_", ":", "KT`\[Phi]`MinMod"}], ",", 
       RowBox[{"\[Epsilon]_", ":", 
        RowBox[{"1.", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]]}]}]}], "]"}], "[", 
     RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
    RowBox[{"\[CapitalDelta]x_", ",", "x_", ",", "x12_"}], "]"}], "[", 
   RowBox[{
   "F_", ",", "\[Lambda]dFdu_", ",", "Q_", ",", "B_", ",", "pars___"}], "]"}],
   ":=", "\[IndentingNewLine]", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "_Real"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"u", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Conserved", " ", 
           RowBox[{"quanties", ":", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SubsuperscriptBox["u", 
                 RowBox[{"-", "2"}], "0"], ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"-", "1"}], "0"], ",", 
                SubsuperscriptBox["u", "0", "0"], ",", "...", ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"nx", "-", "1"}], "0"], ",", 
                SubsuperscriptBox["u", "nx", "0"], ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"nx", "+", "1"}], "0"]}], "}"}], ",", "...", ",", 
              RowBox[{"{", 
               RowBox[{
                SubsuperscriptBox["u", 
                 RowBox[{"-", "2"}], 
                 RowBox[{"nu", "-", "1"}]], ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"-", "1"}], 
                 RowBox[{"nu", "-", "1"}]], ",", 
                SubsuperscriptBox["u", "0", 
                 RowBox[{"nu", "-", "1"}]], ",", "...", ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"nx", "-", "1"}], 
                 RowBox[{"nu", "-", "1"}]], ",", 
                SubsuperscriptBox["u", "nx", 
                 RowBox[{"nu", "-", "1"}]], ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"nx", "+", "1"}], 
                 RowBox[{"nu", "-", "1"}]]}], "}"}]}], "}"}]}]}], ",", " ", 
          RowBox[{"dim", "=", 
           RowBox[{"nu", "*", 
            RowBox[{"(", 
             RowBox[{"nx", "+", "4"}], ")"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", "\[CapitalDelta]u", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Differences", " ", "of", " ", "conserved", " ", 
           RowBox[{"quanties", ":", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "1"}], "0"], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "2"}], "0"]}], ",", 
                RowBox[{
                 SubsuperscriptBox["u", "0", "0"], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "1"}], "0"]}], ",", "...", ",", 
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "1"}], "0"], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "2"}], "0"]}], ",", 
                RowBox[{
                 SubsuperscriptBox["u", "nx", "0"], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "1"}], "0"]}], ",", 
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "+", "1"}], "0"], "-", 
                 SubsuperscriptBox["u", "nx", "0"]}]}], "}"}], ",", "...", 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "1"}], 
                  RowBox[{"nu", "-", "1"}]], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "2"}], 
                  RowBox[{"nu", "-", "1"}]]}], ",", 
                RowBox[{
                 SubsuperscriptBox["u", "0", 
                  RowBox[{"nu", "-", "1"}]], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "1"}], 
                  RowBox[{"nu", "-", "1"}]]}], ",", "...", ",", 
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "1"}], 
                  RowBox[{"nu", "-", "1"}]], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "2"}], 
                  RowBox[{"nu", "-", "1"}]]}], ",", 
                RowBox[{
                 SubsuperscriptBox["u", "nx", 
                  RowBox[{"nu", "-", "1"}]], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "1"}], 
                  RowBox[{"nu", "-", "1"}]]}], ",", 
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "+", "1"}], 
                  RowBox[{"nu", "-", "1"}]], "-", 
                 SubsuperscriptBox["u", "nx", 
                  RowBox[{"nu", "-", "1"}]]}]}], "}"}]}], "}"}]}]}], ",", " ", 
          RowBox[{"dim", "=", 
           RowBox[{"nu", "*", 
            RowBox[{"(", 
             RowBox[{"nx", "+", "3"}], ")"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", "ux", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "Reconstructed", " ", "derivatives", " ", "\[CapitalDelta]x", 
            SubscriptBox[
             RowBox[{"(", 
              SubsuperscriptBox["u", "x", "j"], ")"}], "i"]}], "=", 
           RowBox[{"0.5", "*", 
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["u", 
               RowBox[{"i", "+", "1"}], "j"], "-", 
              SubsuperscriptBox["u", "i", "j"]}], ")"}], "*", 
            RowBox[{"\[Phi]", "[", 
             RowBox[{
              RowBox[{
               SubsuperscriptBox["u", "i", "j"], "-", 
               SubsuperscriptBox["u", 
                RowBox[{"i", "-", "1"}], "j"]}], ",", 
              RowBox[{
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", "1"}], "j"], "-", 
               SubsuperscriptBox["u", "i", "j"]}]}], "]"}]}]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{"nu", "*", 
            RowBox[{"(", 
             RowBox[{"nx", "+", "2"}], ")"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", "up12T", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Reconstructed", " ", "slopes", " ", 
            SubsuperscriptBox["u", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}], 
             RowBox[{"j", ",", "+"}]]}], "=", 
           RowBox[{
            SubsuperscriptBox["u", 
             RowBox[{"i", "+", "1"}], "j"], "-", 
            RowBox[{"\[CapitalDelta]x", 
             SubscriptBox[
              RowBox[{"(", 
               SubsuperscriptBox["u", "x", "j"], ")"}], 
              RowBox[{"i", "+", "1"}]]}]}]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{
           RowBox[{"(", "T", ")"}], ":", " ", 
           RowBox[{"values", " ", "at", " ", "constant", " ", 
            SubscriptBox["x", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}]], " ", "are", " ", "grouped"}]}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t\t", "um12T", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Reconstructed", " ", "slopes", " ", 
            SubsuperscriptBox["u", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}], 
             RowBox[{"j", ",", "-"}]]}], "=", 
           RowBox[{
            SubsuperscriptBox["u", "i", "j"], "+", 
            RowBox[{"\[CapitalDelta]x", 
             SubscriptBox[
              RowBox[{"(", 
               SubsuperscriptBox["u", "x", "j"], ")"}], "i"]}]}]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "Fp12T", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Flux", " ", "through", " ", 
            SubscriptBox["x", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}]], " ", "using", " ", 
            RowBox[{"{", 
             SubsuperscriptBox["F", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], 
              RowBox[{"j", ",", "+"}]], "}"}]}], "=", 
           RowBox[{"F", "[", 
            RowBox[{"t", ",", 
             RowBox[{"{", 
              RowBox[{
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], 
                RowBox[{"0", ",", "+"}]], ",", "...", ",", 
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], 
                RowBox[{
                 RowBox[{"nu", "-", "1"}], ",", "+"}]]}], "}"}], ",", 
             "params"}], "]"}]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "Fm12T", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Flux", " ", "through", " ", 
            SubscriptBox["x", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}]], " ", "using", " ", 
            RowBox[{"{", 
             SubsuperscriptBox["F", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], 
              RowBox[{"j", ",", "-"}]], "}"}]}], "=", 
           RowBox[{"F", "[", 
            RowBox[{"t", ",", 
             RowBox[{"{", 
              RowBox[{
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], 
                RowBox[{"0", ",", "-"}]], ",", "...", ",", 
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], 
                RowBox[{
                 RowBox[{"nu", "-", "1"}], ",", "-"}]]}], "}"}], ",", 
             "params"}], "]"}]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "\[Lambda]p12T", ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Jacobian", " ", "eigenvalues", " ", "at", " ", 
            RowBox[{
             SubscriptBox["x", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}]], ":", " ", 
             SubsuperscriptBox["\[Lambda]", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], "+"]}]}], "=", 
           RowBox[{"\[Lambda]dFdu", "[", 
            RowBox[{"t", ",", 
             RowBox[{"{", 
              RowBox[{
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], 
                RowBox[{"0", ",", "+"}]], ",", "...", ",", 
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], 
                RowBox[{
                 RowBox[{"nu", "-", "1"}], ",", "+"}]]}], "}"}], ",", 
             "params"}], "]"}]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "\[Lambda]m12T", ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Jacobian", " ", "eigenvalues", " ", "at", " ", 
            RowBox[{
             SubscriptBox["x", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}]], ":", " ", 
             SubsuperscriptBox["\[Lambda]", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], "-"]}]}], "=", 
           RowBox[{"\[Lambda]dFdu", "[", 
            RowBox[{"t", ",", 
             RowBox[{"{", 
              RowBox[{
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], 
                RowBox[{"0", ",", "-"}]], ",", "...", ",", 
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], 
                RowBox[{
                 RowBox[{"nu", "-", "1"}], ",", "-"}]]}], "}"}], ",", 
             "params"}], "]"}]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "ap12T", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Approxmiate", " ", "velocities", " ", "at", " ", 
            RowBox[{
             SubscriptBox["x", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}]], ":", " ", 
             SubsuperscriptBox["a", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], "+"]}]}], "=", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Max", "@", 
              SubsuperscriptBox["\[Lambda]", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "+"]}], ",", 
             RowBox[{"Max", "@", 
              SubsuperscriptBox["\[Lambda]", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "-"]}], ",", "0"}], "]"}]}], ",", 
          " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "1"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\n", "\t\t", "am12T", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Approxmiate", " ", "velocities", " ", "at", " ", 
            RowBox[{
             SubscriptBox["x", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}]], ":", " ", 
             SubsuperscriptBox["a", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], "-"]}]}], "=", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"Min", "@", 
              SubsuperscriptBox["\[Lambda]", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "+"]}], ",", 
             RowBox[{"Min", "@", 
              SubsuperscriptBox["\[Lambda]", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "-"]}], ",", "0"}], "]"}]}], ",", 
          " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "1"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "H12", " ", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Numerical", " ", "fluxes", " ", "at", " ", 
           SubscriptBox["x", 
            RowBox[{"i", "+", 
             RowBox[{"1", "/", "2"}]}]]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t\t", "uT", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Conserved", " ", "quanties"}], ",", " ", 
          RowBox[{"dim", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "2"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "dudxT", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Approximate", " ", "derivatives"}], ",", " ", 
          RowBox[{"dim", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "P12"}], 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Diffusion", " ", "flux"}], ",", " ", 
         RowBox[{"dim", " ", "=", 
          RowBox[{"nu", "*", 
           RowBox[{"(", 
            RowBox[{"nx", "+", "1"}], ")"}]}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "}"}], ",", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"**", "**", " ", "Boundary"}], " ", 
        RowBox[{"condition", " ", "**", "**"}]}], " ", "*)"}], "\n", "\t\t", 
      RowBox[{
       RowBox[{"u", "=", 
        RowBox[{"B", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.", ",", "0."}], "}"}], ",", "#", ",", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0."}], "}"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{"v", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"nx", "*", "nu"}]}], "}"}]}], "]"}], ",", "nx"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"**", "**", " ", "Convection"}], " ", 
         RowBox[{"Flux", " ", "**", "**"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"\[CapitalDelta]u", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Differences", "[", "#", "]"}], "&"}], "/@", " ", "u"}]}], 
       " ", ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"ux", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"0.5", "*", "#2", 
              RowBox[{"(", 
               RowBox[{"\[Phi]", "[", 
                RowBox[{"#1", ",", "#2"}], "]"}], ")"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
          "&"}], "/@", "\[CapitalDelta]u"}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"[", 
           RowBox[{
            RowBox[{"KTO2", "-", "0"}], ",", " ", 
            RowBox[{
             RowBox[{"eq", ".", " ", 
              RowBox[{"(", "2.4", ")"}]}], "*", "0.5", "*", 
             "\[CapitalDelta]x"}]}], "]"}], ":", " ", 
          RowBox[{
          "modified", " ", "to", " ", "be", " ", "compatible", " ", "with", 
           " ", 
           RowBox[{
           "generic", "\\\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
            "flux"}], " ", "limiters", " ", 
           RowBox[{"from", " ", "[", 
            RowBox[{
             RowBox[{"https", ":"}], "//", 
             RowBox[{
              RowBox[{
               RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], 
              "/", "Flux_limiter"}]}], "]"}]}]}], ",", " ", 
         RowBox[{"see", " ", 
          RowBox[{"also", " ", "[", 
           RowBox[{
            RowBox[{"https", ":"}], "//", 
            RowBox[{
             RowBox[{
              RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], 
             "/", "MUSCL_scheme"}]}], "]"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"up12T", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", 
                 RowBox[{"-", "2"}]}], "}"}]}], "]"}], "&"}], "/@", "u"}], 
           ")"}], "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], "/@", "ux"}], 
           ")"}]}], "]"}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"[", 
          RowBox[{
           RowBox[{"KTO2", "-", "0"}], ",", " ", 
           RowBox[{"eq", ".", " ", 
            RowBox[{"(", "4.5", ")"}]}]}], "]"}], ":", " ", 
         RowBox[{
         "modified", " ", "to", " ", "be", " ", "compatible", " ", "with", 
          " ", "generic", " ", "flux", " ", "limiters"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"um12T", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{"-", "3"}]}], "}"}]}], "]"}], "&"}], "/@", "u"}], 
           ")"}], "+", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "2"}]}], "}"}]}], "]"}], "&"}], "/@", "ux"}], 
           ")"}]}], "]"}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"[", 
          RowBox[{
           RowBox[{"KTO2", "-", "0"}], ",", " ", 
           RowBox[{"eq", ".", " ", 
            RowBox[{"(", "4.5", ")"}]}]}], "]"}], ":", " ", 
         RowBox[{
         "modified", " ", "to", " ", "be", " ", "compatible", " ", "with", 
          " ", "generic", " ", "flux", " ", "limiters"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"\[Lambda]p12T", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]dFdu", "[", 
            RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"x12", ",", "up12T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"\[Lambda]m12T", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]dFdu", "[", 
            RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"x12", ",", "um12T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"ap12T", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Max", "[", "#1", "]"}], ",", 
             RowBox[{"Max", "[", "#2", "]"}], ",", "0"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Lambda]p12T", ",", "\[Lambda]m12T"}], "}"}]}], "]"}]}], 
       ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"[", 
          RowBox[{
           RowBox[{"KTO2", "-", "1"}], ",", " ", 
           RowBox[{"eq", ".", " ", 
            RowBox[{"(", "3.2", ")"}]}]}], "]"}], " ", "[", 
         RowBox[{
          RowBox[{"KTO2", "-", "0"}], ",", " ", 
          RowBox[{"footnote", " ", "2"}]}], "]"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"am12T", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"Min", "[", "#1", "]"}], ",", 
             RowBox[{"Min", "[", "#2", "]"}], ",", "0"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Lambda]p12T", ",", "\[Lambda]m12T"}], "}"}]}], "]"}]}], 
       ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"[", 
          RowBox[{
           RowBox[{"KTO2", "-", "1"}], ",", " ", 
           RowBox[{"eq", ".", " ", 
            RowBox[{"(", "3.2", ")"}]}]}], "]"}], " ", "[", 
         RowBox[{
          RowBox[{"KTO2", "-", "0"}], ",", " ", 
          RowBox[{"footnote", " ", "2"}]}], "]"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "\n", "\t\t", 
       RowBox[{"Fp12T", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"F", "[", 
            RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"x12", ",", "up12T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Fm12T", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"F", "[", 
            RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"x12", ",", "um12T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", "\n", "\t\t", 
       RowBox[{"H12", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#3", "-", "#4"}], "<", "\[Epsilon]"}], ",", 
              RowBox[{"0.5", 
               RowBox[{"(", 
                RowBox[{"#1", "+", "#2"}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#3", "*", "#2"}], "-", 
                 RowBox[{"#4", "*", "#1"}], "+", 
                 RowBox[{"#3", "*", "#4", "*", "#5"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"#3", "-", "#4"}], ")"}]}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"Fp12T", ",", "Fm12T", ",", "ap12T", ",", "am12T", ",", 
             RowBox[{"up12T", "-", "um12T"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"[", 
           RowBox[{
            RowBox[{"KTO2", "-", "1"}], ",", " ", 
            RowBox[{"eq", ".", " ", 
             RowBox[{"(", "3.15", ")"}]}]}], "]"}], ":", " ", 
          RowBox[{"{", 
           SubscriptBox["H", 
            RowBox[{"i", "+", 
             RowBox[{"1", "/", "2"}]}]], "}"}]}], "=", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              SubsuperscriptBox["a", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "+"], 
              RowBox[{"F", "[", 
               RowBox[{"t", ",", 
                SubscriptBox["x", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}]], ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], "-"]}], "]"}]}], "-", 
             RowBox[{
              SubsuperscriptBox["a", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "-"], 
              RowBox[{"F", "[", 
               RowBox[{"t", ",", 
                SubscriptBox["x", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}]], ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], "+"]}], "]"}]}]}], 
            RowBox[{
             SubsuperscriptBox["a", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], "+"], "-", 
             SubsuperscriptBox["a", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], "-"]}]], "+", 
           RowBox[{
            FractionBox[
             RowBox[{
              SubsuperscriptBox["a", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "+"], 
              SubsuperscriptBox["a", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "-"]}], 
             RowBox[{
              SubsuperscriptBox["a", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "+"], "-", 
              SubsuperscriptBox["a", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "-"]}]], 
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["u", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "+"], "-", 
              SubsuperscriptBox["u", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "-"]}], ")"}], " ", "or", " ", 
            FractionBox["1", "2"], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"F", "[", 
               RowBox[{"t", ",", 
                SubscriptBox["x", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}]], ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], "+"]}], "]"}], "+", 
              RowBox[{"F", "[", 
               RowBox[{"t", ",", 
                SubscriptBox["x", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}]], ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], "-"]}], "]"}]}], ")"}], " ", 
            "if", " ", 
            SubsuperscriptBox["a", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}], "+"]}], "-", 
           SubsuperscriptBox["a", 
            RowBox[{"i", "+", 
             RowBox[{"1", "/", "2"}]}], "-"]}], "<", 
          RowBox[{"\[Epsilon]", " ", "[", 
           RowBox[{"KAMM", ",", " ", 
            RowBox[{"Remark", " ", "2.2"}]}], "]"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"**", "**", " ", "Diffusion"}], " ", 
         RowBox[{"Flux", " ", "**", "**"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"uT", "=", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "u", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"dudxT", "=", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", "\[CapitalDelta]u", "]"}], "/", 
           "\[CapitalDelta]x"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"P12", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"0.5", "*", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Q", "[", 
               RowBox[{"t", ",", "#1", ",", "#3", ",", "#5", ",", "pars"}], 
               "]"}], "+", 
              RowBox[{"Q", "[", 
               RowBox[{"t", ",", "#2", ",", "#4", ",", "#5", ",", "pars"}], 
               "]"}]}], "&"}], ",", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x12", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"\[CapitalDelta]x", "*", "0.5"}]}], "}"}], ",", 
                "x"}], "]"}], ",", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"=", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["x", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}]], "-", 
                   RowBox[{"\[CapitalDelta]x", "/", "2"}]}], "=", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["x", 
                    RowBox[{"-", "1"}]], ",", 
                    RowBox[{"{", 
                    SubscriptBox["x", "i"], "}"}]}], "}"}], "\[Congruent]", 
                   RowBox[{"{", 
                    SubscriptBox[
                    OverscriptBox["x", "^"], "i"], "}"}]}]}]}], ",", " ", 
                RowBox[{
                "contains", " ", "cell", " ", "center", " ", "of", " ", 
                 "second", " ", "ghost", " ", 
                 RowBox[{"cell", " ", "[", 
                  RowBox[{
                   SubscriptBox["x", 
                    RowBox[{
                    RowBox[{"-", "3"}], "/", "2"}]], ",", 
                   SubscriptBox["x", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]]}], "]"}]}]}], " ", "*)"}],
               "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"Join", "[", 
               RowBox[{"x", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x12", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "+", 
                  RowBox[{"\[CapitalDelta]x", "*", "0.5"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"=", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["x", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}]], "+", 
                   RowBox[{"\[CapitalDelta]x", "/", "2"}]}], "=", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    SubscriptBox["x", "i"], "}"}], ",", 
                    SubscriptBox["x", "n"]}], "}"}], "\[Congruent]", 
                   RowBox[{"{", 
                    SubscriptBox[
                    OverscriptBox["x", "^"], 
                    RowBox[{"i", "+", "1"}]], "}"}]}]}]}], ",", " ", 
                RowBox[{
                "contains", " ", "cell", " ", "center", " ", "of", " ", 
                 "penultimate", " ", "ghost", " ", 
                 RowBox[{"cell", " ", "[", 
                  RowBox[{
                   SubscriptBox["x", 
                    RowBox[{"n", "-", 
                    RowBox[{"1", "/", "2"}]}]], ",", 
                   SubscriptBox["x", 
                    RowBox[{"n", "+", 
                    RowBox[{"1", "/", "2"}]}]]}], "]"}]}]}], " ", "*)"}], 
              "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"Take", "[", 
               RowBox[{"uT", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", " ", 
              RowBox[{"(*", " ", 
               RowBox[{"=", 
                SubscriptBox["u", "i"]}], " ", "*)"}], "\[IndentingNewLine]", 
              "\t\t\t", 
              RowBox[{"Take", "[", 
               RowBox[{"uT", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"(*", " ", 
               RowBox[{"=", 
                SubscriptBox["u", 
                 RowBox[{"i", "+", "1"}]]}], " ", "*)"}], 
              "\[IndentingNewLine]", "\t\t\t", "dudxT"}], 
             RowBox[{"(*", " ", 
              RowBox[{"=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["u", 
                   RowBox[{"i", "+", "1"}]], "-", 
                  SubscriptBox["u", "i"]}], ")"}], "/", 
                "\[CapitalDelta]x"}]}], " ", "*)"}], "\[IndentingNewLine]", 
             "\t\t", "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"[", 
           RowBox[{
            RowBox[{"KTO2", "-", "0"}], ",", " ", 
            RowBox[{"eq", ".", " ", 
             RowBox[{"(", "4.14", ")"}]}]}], "]"}], ":", " ", 
          RowBox[{"{", 
           SubscriptBox["P", 
            RowBox[{"i", "+", 
             RowBox[{"1", "/", "2"}]}]], "}"}]}], "=", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Q", "[", 
             RowBox[{"t", ",", 
              SubscriptBox[
               OverscriptBox["x", "^"], "i"], ",", 
              SubscriptBox["u", "i"], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["u", 
                  RowBox[{"i", "+", "1"}]], "-", 
                 SubscriptBox["u", "i"]}], ")"}], "/", "\[CapitalDelta]x"}]}],
              "]"}], "+", 
            RowBox[{"Q", "[", 
             RowBox[{"t", ",", 
              SubscriptBox[
               OverscriptBox["x", "^"], 
               RowBox[{"i", "+", "1"}]], ",", 
              SubscriptBox["u", 
               RowBox[{"i", "+", "1"}]], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["u", 
                  RowBox[{"i", "+", "1"}]], "-", 
                 SubscriptBox["u", "i"]}], ")"}], "/", "\[CapitalDelta]x"}]}],
              "]"}]}], ")"}]}]}], " ", "*)"}], "\n", "\t\t", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"**", "**", " ", "Result", " ", "**", "**"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Return", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Differences", "[", "#1", "]"}]}], "+", 
                RowBox[{"Differences", "[", "#2", "]"}]}], ")"}], "/", 
              "\[CapitalDelta]x"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"H12", ",", "P12"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
        "]"}]}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"KTO2", "-", "0"}], ",", 
        RowBox[{"eq", ".", 
         RowBox[{"(", "4.13", ")"}]}]}], "]"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", "]"}], ",", " ", 
    RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", " ", 
    RowBox[{"CompilationOptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
       RowBox[{"\"\<ExpressionOptimization\>\"", "->", "True"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Code",
 CellLabel->"In[97]:=",ExpressionUUID->"08b99bba-0674-4582-8ff3-6f3f1c1a7eca"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Kurganov-Tadmor central scheme O(",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalDelta]x", "1"], TraditionalForm]],ExpressionUUID->
  "9a5ea9e3-2be0-4fbd-b4ae-1d98959a9b3c"],
 ") [KTO2-0] "
}], "NonEvaluatingSection",ExpressionUUID->"cdebb513-89bb-471a-95b1-\
5d36e7745bdf"],

Cell[CellGroupData[{

Cell["Formulas", \
"Subsection",ExpressionUUID->"e52a2a62-56f8-4b14-8a4d-3ec6d47c2322"],

Cell[TextData[{
 "[KTO1-0]: [A. Harten and et al. - 1983 - ",
 StyleBox["On upstream differencing and Godunov-type schemes for hyperbolic \
conservation laws",
  FontSlant->"Italic"],
 "]"
}], "Text",ExpressionUUID->"8a779acd-6d53-42c9-949e-afb355e00533"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SubscriptBox["u", "x"], ")"}], "j"], "\[Rule]", "0"}], 
  ";"}]], "DisplayFormulaNumbered",ExpressionUUID->"7e165126-af87-4ad5-9d3d-\
810793f1c104"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubsuperscriptBox["u", 
    RowBox[{"j", "+", 
     RowBox[{"1", "/", "2"}]}], "+"], "\[Rule]", 
   SubscriptBox["u", 
    RowBox[{"j", "+", "1"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubsuperscriptBox["u", 
    RowBox[{"j", "+", 
     RowBox[{"1", "/", "2"}]}], "-"], "\[Rule]", 
   SubscriptBox["u", "j"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"[", 
   RowBox[{
    RowBox[{"KTO2", "-", "0"}], ",", " ", 
    RowBox[{"eq", ".", " ", 
     RowBox[{"(", "4.5", ")"}]}], ",", " ", 
    RowBox[{"with", " ", "modified", " ", "definition", " ", "of", " ", 
     RowBox[{"(", 
      SubscriptBox["u", "x"], ")"}]}]}], "]"}], ",", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"O", "[", 
     SuperscriptBox["\[CapitalDelta]x", "1"], "]"}], " ", "reduction"}], 
   ";"}]}]}], \
"DisplayFormulaNumbered",ExpressionUUID->"986685bd-dcf5-43dc-92f4-\
c8094413e7bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["KT`O1v0 [KTO2-1]", \
"Subsection",ExpressionUUID->"8112363a-4340-4e6b-9e4c-fa47dc628d74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["H", 
       RowBox[{"i", "+", 
        RowBox[{"1", "/", "2"}]}]], "-", 
      SubscriptBox["H", 
       RowBox[{"i", "-", 
        RowBox[{"1", "/", "2"}]}]]}], ")"}], "\[CapitalDelta]x"]}], "\[Rule]", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", "\[CapitalDelta]x"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"t", ",", 
       SubscriptBox["x", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], "+", "i"}]], ",", 
       SubscriptBox["u", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "i"}]]}], "]"}], "+", 
     RowBox[{"F", "[", 
      RowBox[{"t", ",", 
       SubscriptBox["x", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], "+", "i"}]], ",", 
       SubscriptBox["u", "i"]}], "]"}], "-", 
     RowBox[{"F", "[", 
      RowBox[{"t", ",", 
       SubscriptBox["x", 
        RowBox[{
         FractionBox["1", "2"], "+", "i"}]], ",", 
       SubscriptBox["u", "i"]}], "]"}], "-", 
     RowBox[{"F", "[", 
      RowBox[{"t", ",", 
       SubscriptBox["x", 
        RowBox[{
         FractionBox["1", "2"], "+", "i"}]], ",", 
       SubscriptBox["u", 
        RowBox[{"1", "+", "i"}]]}], "]"}], "+", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], "+", "i"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["u", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "i"}]], "-", 
        SubscriptBox["u", "i"]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{
        FractionBox["1", "2"], "+", "i"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["u", "i"]}], "+", 
        SubscriptBox["u", 
         RowBox[{"1", "+", "i"}]]}], ")"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rule]", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "\[CapitalDelta]x"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"t", ",", 
         SubscriptBox["x", 
          RowBox[{
           FractionBox["1", "2"], "+", "i"}]], ",", 
         SubscriptBox["u", 
          RowBox[{"1", "+", "i"}]]}], "]"}], "-", 
       RowBox[{"F", "[", 
        RowBox[{"t", ",", 
         SubscriptBox["x", 
          RowBox[{"i", "-", 
           FractionBox["1", "2"]}]], ",", 
         SubscriptBox["u", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "i"}]]}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "\[CapitalDelta]x"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"i", "+", 
           FractionBox["1", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["u", 
            RowBox[{"1", "+", "i"}]], "-", 
           SubscriptBox["u", "i"]}], ")"}]}], "-", 
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"i", "-", 
           FractionBox["1", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["u", "i"], "-", 
           SubscriptBox["u", 
            RowBox[{"i", "-", "1"}]]}], ")"}]}]}], ")"}], " ", "[", 
      RowBox[{
       RowBox[{"KTO2", "-", "0"}], ",", " ", 
       RowBox[{"eq", ".", " ", 
        RowBox[{"(", "4.8", ")"}]}]}], "]"}], " ", "with", " ", 
     RowBox[{"F", "[", 
      RowBox[{"t", ",", 
       SubscriptBox["x", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], "+", "i"}]], ",", 
       SubscriptBox["u", "i"]}], "]"}]}], "-", 
    RowBox[{"F", "[", 
     RowBox[{"t", ",", 
      SubscriptBox["x", 
       RowBox[{
        FractionBox["1", "2"], "+", "i"}]], ",", 
      SubscriptBox["u", "i"]}], "]"}]}]}], "=", 
  RowBox[{"0", "+", 
   RowBox[{"O", 
    RowBox[{"(", 
     SuperscriptBox["\[CapitalDelta]x", "2"], 
     ")"}]}]}]}]}], \
"DisplayFormulaNumbered",ExpressionUUID->"0e646518-77d7-429a-8f54-\
d6c7b948f261"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "KT`O1v0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KT`O1v0", "[", "]"}], "[", 
     RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
    RowBox[{"\[CapitalDelta]x_", ",", "x_", ",", "x12_"}], "]"}], "[", 
   RowBox[{
   "F_", ",", "\[Lambda]dFdu_", ",", "Q_", ",", "B_", ",", "pars___"}], "]"}],
   ":=", "\[IndentingNewLine]", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "_Real"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"u", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Conserved", " ", 
           RowBox[{"quanties", ":", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SubsuperscriptBox["u", 
                 RowBox[{"-", "2"}], "0"], ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"-", "1"}], "0"], ",", 
                SubsuperscriptBox["u", "0", "0"], ",", "...", ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"nx", "-", "1"}], "0"], ",", 
                SubsuperscriptBox["u", "nx", "0"], ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"nx", "+", "1"}], "0"]}], "}"}], ",", "...", ",", 
              RowBox[{"{", 
               RowBox[{
                SubsuperscriptBox["u", 
                 RowBox[{"-", "2"}], 
                 RowBox[{"nu", "-", "1"}]], ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"-", "1"}], 
                 RowBox[{"nu", "-", "1"}]], ",", 
                SubsuperscriptBox["u", "0", 
                 RowBox[{"nu", "-", "1"}]], ",", "...", ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"nx", "-", "1"}], 
                 RowBox[{"nu", "-", "1"}]], ",", 
                SubsuperscriptBox["u", "nx", 
                 RowBox[{"nu", "-", "1"}]], ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"nx", "+", "1"}], 
                 RowBox[{"nu", "-", "1"}]]}], "}"}]}], "}"}]}]}], ",", " ", 
          RowBox[{"dim", "=", 
           RowBox[{"nu", "*", 
            RowBox[{"(", 
             RowBox[{"nx", "+", "4"}], ")"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", "\[CapitalDelta]u", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Differences", " ", "of", " ", "conserved", " ", 
           RowBox[{"quanties", ":", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "1"}], "0"], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "2"}], "0"]}], ",", 
                RowBox[{
                 SubsuperscriptBox["u", "0", "0"], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "1"}], "0"]}], ",", "...", ",", 
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "1"}], "0"], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "2"}], "0"]}], ",", 
                RowBox[{
                 SubsuperscriptBox["u", "nx", "0"], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "1"}], "0"]}], ",", 
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "+", "1"}], "0"], "-", 
                 SubsuperscriptBox["u", "nx", "0"]}]}], "}"}], ",", "...", 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "1"}], 
                  RowBox[{"nu", "-", "1"}]], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "2"}], 
                  RowBox[{"nu", "-", "1"}]]}], ",", 
                RowBox[{
                 SubsuperscriptBox["u", "0", 
                  RowBox[{"nu", "-", "1"}]], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "1"}], 
                  RowBox[{"nu", "-", "1"}]]}], ",", "...", ",", 
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "1"}], 
                  RowBox[{"nu", "-", "1"}]], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "2"}], 
                  RowBox[{"nu", "-", "1"}]]}], ",", 
                RowBox[{
                 SubsuperscriptBox["u", "nx", 
                  RowBox[{"nu", "-", "1"}]], "-", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "1"}], 
                  RowBox[{"nu", "-", "1"}]]}], ",", 
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "+", "1"}], 
                  RowBox[{"nu", "-", "1"}]], "-", 
                 SubsuperscriptBox["u", "nx", 
                  RowBox[{"nu", "-", "1"}]]}]}], "}"}]}], "}"}]}]}], ",", " ", 
          RowBox[{"dim", "=", 
           RowBox[{"nu", "*", 
            RowBox[{"(", 
             RowBox[{"nx", "+", "3"}], ")"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", "ux", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Reconstructed", " ", "derivatives", " ", 
            SubscriptBox[
             RowBox[{"(", 
              SubsuperscriptBox["u", "x", "j"], ")"}], "i"]}], "=", 
           RowBox[{"0.5", "*", 
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["u", 
               RowBox[{"i", "+", "1"}], "j"], "-", 
              SubsuperscriptBox["u", "i", "j"]}], ")"}], "*", 
            RowBox[{"\[Phi]", "[", 
             RowBox[{
              RowBox[{
               SubsuperscriptBox["u", "i", "j"], "-", 
               SubsuperscriptBox["u", 
                RowBox[{"i", "-", "1"}], "j"]}], ",", 
              RowBox[{
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", "1"}], "j"], "-", 
               SubsuperscriptBox["u", "i", "j"]}]}], "]"}]}]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{"nu", "*", 
            RowBox[{"(", 
             RowBox[{"nx", "+", "2"}], ")"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", "up12T", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Reconstructed", " ", "slopes", " ", 
            SubsuperscriptBox["u", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}], 
             RowBox[{"j", ",", "+"}]]}], "=", 
           RowBox[{
            SubsuperscriptBox["u", 
             RowBox[{"i", "+", "1"}], "j"], "-", 
            SubscriptBox[
             RowBox[{"(", 
              SubsuperscriptBox["u", "x", "j"], ")"}], 
             RowBox[{"i", "+", "1"}]]}]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{
           RowBox[{"(", "T", ")"}], ":", " ", 
           RowBox[{"values", " ", "at", " ", "constant", " ", 
            SubscriptBox["x", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}]], " ", "are", " ", "grouped"}]}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t\t", "um12T", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Reconstructed", " ", "slopes", " ", 
            SubsuperscriptBox["u", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}], 
             RowBox[{"j", ",", "-"}]]}], "=", 
           RowBox[{
            SubsuperscriptBox["u", "i", "j"], "+", 
            SubscriptBox[
             RowBox[{"(", 
              SubsuperscriptBox["u", "x", "j"], ")"}], "i"]}]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "Fp12", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Flux", " ", "through", " ", 
           SubscriptBox["x", 
            RowBox[{"i", "+", 
             RowBox[{"1", "/", "2"}]}]], " ", "using", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              SubsuperscriptBox["F", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], 
               RowBox[{"j", ",", "+"}]], "}"}], "\[Transpose]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", " ", 
          RowBox[{"dim", " ", "=", " ", 
           RowBox[{"nu", "*", "nx"}]}], ","}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", "Fm12", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Flux", " ", "through", " ", 
           SubscriptBox["x", 
            RowBox[{"i", "+", 
             RowBox[{"1", "/", "2"}]}]], " ", "using", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              SubsuperscriptBox["F", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], 
               RowBox[{"j", ",", "-"}]], "}"}], "\[Transpose]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"-", "2"}]}], "]"}], "]"}]}], ",", " ", 
          RowBox[{"dim", " ", "=", " ", 
           RowBox[{"nu", "*", "nx"}]}], ","}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", "\[Lambda]p12T", ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Jacobian", " ", "eigenvalues", " ", "at", " ", 
            RowBox[{
             SubscriptBox["x", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}]], ":", " ", 
             SubsuperscriptBox["\[Lambda]", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], "+"]}]}], "=", 
           RowBox[{"\[Lambda]dFdu", "[", 
            RowBox[{"t", ",", 
             RowBox[{"{", 
              RowBox[{
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], 
                RowBox[{"0", ",", "+"}]], ",", "...", ",", 
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], 
                RowBox[{
                 RowBox[{"nu", "-", "1"}], ",", "+"}]]}], "}"}], ",", 
             "params"}], "]"}]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "\[Lambda]m12T", ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Jacobian", " ", "eigenvalues", " ", "at", " ", 
            RowBox[{
             SubscriptBox["x", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}]], ":", " ", 
             SubsuperscriptBox["\[Lambda]", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], "-"]}]}], "=", 
           RowBox[{"\[Lambda]dFdu", "[", 
            RowBox[{"t", ",", 
             RowBox[{"{", 
              RowBox[{
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], 
                RowBox[{"0", ",", "-"}]], ",", "...", ",", 
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], 
                RowBox[{
                 RowBox[{"nu", "-", "1"}], ",", "-"}]]}], "}"}], ",", 
             "params"}], "]"}]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "a12T", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Approxmiate", " ", "velocities", " ", "at", " ", 
            RowBox[{
             SubscriptBox["x", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}]], ":", " ", 
             SubscriptBox["a", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}]]}]}], "=", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Max", "@", 
              RowBox[{"Abs", "@", 
               SubsuperscriptBox["\[Lambda]", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "+"]}]}], ",", 
             RowBox[{"Max", "@", 
              RowBox[{"Abs", "@", 
               SubsuperscriptBox["\[Lambda]", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "-"]}]}]}], "]"}]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "1"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "H12", " ", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Numerical", " ", "fluxes", " ", "at", " ", 
           SubscriptBox["x", 
            RowBox[{"i", "+", 
             RowBox[{"1", "/", "2"}]}]]}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t\t", "uT", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Conserved", " ", "quanties"}], ",", " ", 
          RowBox[{"dim", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "2"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "dudxT", ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Approximate", " ", "derivatives"}], ",", " ", 
          RowBox[{"dim", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
          RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", "P12"}], 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Diffusion", " ", "flux"}], ",", " ", 
         RowBox[{"dim", " ", "=", 
          RowBox[{"nu", "*", 
           RowBox[{"(", 
            RowBox[{"nx", "+", "1"}], ")"}]}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "}"}], ",", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"**", "**", " ", "Boundary"}], " ", 
        RowBox[{"condition", " ", "**", "**"}]}], " ", "*)"}], "\n", "\t\t", 
      RowBox[{
       RowBox[{"u", "=", 
        RowBox[{"B", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.", ",", "0."}], "}"}], ",", "#", ",", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0."}], "}"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{"v", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"nx", "*", "nu"}]}], "}"}]}], "]"}], ",", "nx"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"**", "**", " ", "Convection"}], " ", 
         RowBox[{"Flux", " ", "**", "**"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"\[CapitalDelta]u", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Differences", "[", "#", "]"}], "&"}], "/@", " ", "u"}]}], 
       " ", ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"up12T", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", 
                RowBox[{"-", "2"}]}], "}"}]}], "]"}], "&"}], "/@", "u"}], 
          ")"}], "]"}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"[", 
          RowBox[{
           RowBox[{"KTO2", "-", "0"}], ",", " ", 
           RowBox[{"eq", ".", " ", 
            RowBox[{"(", "4.5", ")"}]}]}], "]"}], ":", " ", 
         RowBox[{
         "modified", " ", "to", " ", "be", " ", "compatible", " ", "with", 
          " ", "generic", " ", "flux", " ", 
          RowBox[{"limiters", " ", "[", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["u", "\[RightVector]"], "0"], ",", 
            SubscriptBox[
             OverscriptBox["u", "\[RightVector]"], "1"], ",", "...", ",", 
            SubscriptBox[
             OverscriptBox["u", "\[RightVector]"], "nx"]}], "]"}]}]}], "*)"}],
        "\[IndentingNewLine]", "\t\t", 
       RowBox[{"um12T", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"-", "3"}]}], "}"}]}], "]"}], "&"}], "/@", "u"}], 
          ")"}], "]"}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"[", 
          RowBox[{
           RowBox[{"KTO2", "-", "0"}], ",", " ", 
           RowBox[{"eq", ".", " ", 
            RowBox[{"(", "4.5", ")"}]}]}], "]"}], ":", " ", 
         RowBox[{
         "modified", " ", "to", " ", "be", " ", "compatible", " ", "with", 
          " ", "generic", " ", "flux", " ", 
          RowBox[{"limiters", " ", "[", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["u", "\[RightVector]"], 
             RowBox[{"-", "1"}]], ",", 
            SubscriptBox[
             OverscriptBox["u", "\[RightVector]"], "0"], ",", "...", ",", 
            SubscriptBox[
             OverscriptBox["u", "\[RightVector]"], 
             RowBox[{"nx", "-", "1"}]]}], "]"}]}]}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"\[Lambda]p12T", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]dFdu", "[", 
            RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"x12", ",", "up12T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"\[Lambda]m12T", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]dFdu", "[", 
            RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"x12", ",", "um12T"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"a12T", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Max", "@", 
              RowBox[{"Abs", "@", "#1"}]}], ",", 
             RowBox[{"Max", "@", 
              RowBox[{"Abs", "@", "#2"}]}]}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Lambda]p12T", ",", "\[Lambda]m12T"}], "}"}]}], "]"}]}], 
       ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"[", 
          RowBox[{
           RowBox[{"KTO2", "-", "0"}], ",", " ", 
           RowBox[{"eq", ".", " ", 
            RowBox[{"(", "3.2", ")"}]}]}], "]"}], " ", "[", 
         RowBox[{
          RowBox[{"KTO2", "-", "0"}], ",", " ", 
          RowBox[{"footnote", " ", "2"}]}], "]"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "\n", "\t\t", 
       RowBox[{"Fp12", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"x12", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Take", "[", 
              RowBox[{"up12T", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Fm12", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"x12", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Take", "[", 
              RowBox[{"um12T", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
         "]"}]}], ";", "\n", "\t\t", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"H12", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"0.5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "a12T"}], "*", 
            RowBox[{"(", 
             RowBox[{"up12T", "-", "um12T"}], ")"}]}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"[", 
           RowBox[{
            RowBox[{"KTO2", "-", "0"}], ",", " ", 
            RowBox[{"eq", ".", " ", 
             RowBox[{"(", "4.4", ")"}]}]}], "]"}], ":", "  ", 
          RowBox[{"{", 
           SubscriptBox["H", 
            RowBox[{"i", "+", 
             RowBox[{"1", "/", "2"}]}]], "}"}]}], "=", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SubscriptBox["a", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}]], "2"]}], 
          RowBox[{"(", 
           RowBox[{
            SubsuperscriptBox["u", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}], "+"], "-", 
            SubsuperscriptBox["u", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}], "-"]}], ")"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"**", "**", " ", "Diffusion"}], " ", 
         RowBox[{"Flux", " ", "**", "**"}]}], " ", "*)"}], "\n", "\t\t", 
       RowBox[{"uT", "=", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "u", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"dudxT", "=", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", "\[CapitalDelta]u", "]"}], "/", 
           "\[CapitalDelta]x"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"P12", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"0.5", "*", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Q", "[", 
               RowBox[{"t", ",", "#1", ",", "#3", ",", "#5", ",", "pars"}], 
               "]"}], "+", 
              RowBox[{"Q", "[", 
               RowBox[{"t", ",", "#2", ",", "#4", ",", "#5", ",", "pars"}], 
               "]"}]}], "&"}], ",", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x12", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"\[CapitalDelta]x", "*", "0.5"}]}], "}"}], ",", 
                "x"}], "]"}], ",", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"=", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["x", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}]], "-", 
                   RowBox[{"\[CapitalDelta]x", "/", "2"}]}], "=", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["x", 
                    RowBox[{"-", "1"}]], ",", 
                    RowBox[{"{", 
                    SubscriptBox["x", "i"], "}"}]}], "}"}], "\[Congruent]", 
                   RowBox[{"{", 
                    SubscriptBox[
                    OverscriptBox["x", "^"], "i"], "}"}]}]}]}], ",", " ", 
                RowBox[{
                "contains", " ", "cell", " ", "center", " ", "of", " ", 
                 "second", " ", "ghost", " ", 
                 RowBox[{"cell", " ", "[", 
                  RowBox[{
                   SubscriptBox["x", 
                    RowBox[{
                    RowBox[{"-", "3"}], "/", "2"}]], ",", 
                   SubscriptBox["x", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]]}], "]"}]}]}], " ", "*)"}],
               "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"Join", "[", 
               RowBox[{"x", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x12", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "+", 
                  RowBox[{"\[CapitalDelta]x", "*", "0.5"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"=", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["x", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}]], "+", 
                   RowBox[{"\[CapitalDelta]x", "/", "2"}]}], "=", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    SubscriptBox["x", "i"], "}"}], ",", 
                    SubscriptBox["x", "n"]}], "}"}], "\[Congruent]", 
                   RowBox[{"{", 
                    SubscriptBox[
                    OverscriptBox["x", "^"], 
                    RowBox[{"i", "+", "1"}]], "}"}]}]}]}], ",", " ", 
                RowBox[{
                "contains", " ", "cell", " ", "center", " ", "of", " ", 
                 "penultimate", " ", "ghost", " ", 
                 RowBox[{"cell", " ", "[", 
                  RowBox[{
                   SubscriptBox["x", 
                    RowBox[{"n", "-", 
                    RowBox[{"1", "/", "2"}]}]], ",", 
                   SubscriptBox["x", 
                    RowBox[{"n", "+", 
                    RowBox[{"1", "/", "2"}]}]]}], "]"}]}]}], " ", "*)"}], 
              "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"Take", "[", 
               RowBox[{"uT", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", " ", 
              RowBox[{"(*", " ", 
               RowBox[{"=", 
                SubscriptBox["u", "i"]}], " ", "*)"}], "\[IndentingNewLine]", 
              "\t\t\t", 
              RowBox[{"Take", "[", 
               RowBox[{"uT", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"(*", " ", 
               RowBox[{"=", 
                SubscriptBox["u", 
                 RowBox[{"i", "+", "1"}]]}], " ", "*)"}], 
              "\[IndentingNewLine]", "\t\t\t", "dudxT"}], 
             RowBox[{"(*", " ", 
              RowBox[{"=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["u", 
                   RowBox[{"i", "+", "1"}]], "-", 
                  SubscriptBox["u", "i"]}], ")"}], "/", 
                "\[CapitalDelta]x"}]}], " ", "*)"}], "\[IndentingNewLine]", 
             "\t\t", "}"}]}], "]"}]}], "]"}]}], ";", "\n", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"[", 
           RowBox[{
            RowBox[{"KTO2", "-", "0"}], ",", " ", 
            RowBox[{"eq", ".", " ", 
             RowBox[{"(", "4.14", ")"}]}]}], "]"}], ":", " ", 
          RowBox[{"{", 
           SubscriptBox["P", 
            RowBox[{"i", "+", 
             RowBox[{"1", "/", "2"}]}]], "}"}]}], "=", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Q", "[", 
             RowBox[{"t", ",", 
              SubscriptBox[
               OverscriptBox["x", "^"], "i"], ",", 
              SubscriptBox["u", "i"], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["u", 
                  RowBox[{"i", "+", "1"}]], "-", 
                 SubscriptBox["u", "i"]}], ")"}], "/", "\[CapitalDelta]x"}]}],
              "]"}], "+", 
            RowBox[{"Q", "[", 
             RowBox[{"t", ",", 
              SubscriptBox[
               OverscriptBox["x", "^"], 
               RowBox[{"i", "+", "1"}]], ",", 
              SubscriptBox["u", 
               RowBox[{"i", "+", "1"}]], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["u", 
                  RowBox[{"i", "+", "1"}]], "-", 
                 SubscriptBox["u", "i"]}], ")"}], "/", "\[CapitalDelta]x"}]}],
              "]"}]}], ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"**", "**", " ", "Result", " ", "**", "**"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Return", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "0.5"}], "/", "\[CapitalDelta]x"}], "*", 
            RowBox[{"(", 
             RowBox[{"Fp12", "-", "Fm12"}], ")"}]}], "+", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Differences", "[", "#1", "]"}]}], "+", 
                 RowBox[{"Differences", "[", "#2", "]"}]}], ")"}], "/", 
               "\[CapitalDelta]x"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"H12", ",", "P12"}], "}"}]}], "]"}]}], ",", "1"}], 
         "]"}], "]"}]}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"KTO2", "-", "0"}], ",", 
        RowBox[{"eq", ".", 
         RowBox[{"(", "4.8", ")"}]}], ",", 
        RowBox[{"(", "4.13", ")"}]}], "]"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", "\[CapitalDelta]x"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{"t", ",", 
            SubscriptBox["x", 
             RowBox[{
              FractionBox["1", "2"], "+", "i"}]], ",", 
            SubscriptBox["u", 
             RowBox[{"1", "+", "i"}]]}], "]"}], "-", 
          RowBox[{"F", "[", 
           RowBox[{"t", ",", 
            SubscriptBox["x", 
             RowBox[{"i", "-", 
              FractionBox["1", "2"]}]], ",", 
            SubscriptBox["u", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "i"}]]}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", "\[CapitalDelta]x"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["a", 
            RowBox[{"i", "+", 
             FractionBox["1", "2"]}]], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["u", 
              RowBox[{"1", "+", "i"}]], "-", 
             SubscriptBox["u", "i"]}], ")"}]}], "-", 
          RowBox[{
           SubscriptBox["a", 
            RowBox[{"i", "-", 
             FractionBox["1", "2"]}]], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["u", "i"], "-", 
             SubscriptBox["u", 
              RowBox[{"i", "-", "1"}]]}], ")"}]}]}], ")"}]}], " ", "+", " ", 
       RowBox[{
        FractionBox["1", "\[CapitalDelta]x"], 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["P", 
           RowBox[{"i", "+", 
            RowBox[{"1", "/", "2"}]}]], "-", 
          SubscriptBox["P", 
           RowBox[{"i", "-", 
            RowBox[{"1", "/", "2"}]}]]}], ")"}]}]}], "*)"}], "\n", "\t\t", 
     "\n", "\t", "]"}], ",", " ", 
    RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", " ", 
    RowBox[{"CompilationOptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
       RowBox[{"\"\<ExpressionOptimization\>\"", "->", "True"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Code",
 CellLabel->
  "In[101]:=",ExpressionUUID->"60baa403-fc75-466a-8023-0bfb34f6155c"],

Cell[CellGroupData[{

Cell["Computations", \
"NonEvaluatingSubsubsection",ExpressionUUID->"56e56044-3d70-4441-bfaa-\
a5035ff86743"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"t", ",", 
       SubscriptBox["x", 
        RowBox[{"i", "+", 
         RowBox[{"1", "/", "2"}]}]], ",", 
       SubsuperscriptBox["u", 
        RowBox[{"i", "+", 
         RowBox[{"1", "/", "2"}]}], "+"]}], "]"}], "+", 
     RowBox[{"F", "[", 
      RowBox[{"t", ",", 
       SubscriptBox["x", 
        RowBox[{"i", "+", 
         RowBox[{"1", "/", "2"}]}]], ",", 
       SubsuperscriptBox["u", 
        RowBox[{"i", "+", 
         RowBox[{"1", "/", "2"}]}], "-"]}], "]"}]}], "2"], "-", 
   RowBox[{
    FractionBox[
     SubscriptBox["a", 
      RowBox[{"i", "+", 
       RowBox[{"1", "/", "2"}]}]], "2"], 
    RowBox[{"(", 
     RowBox[{
      SubsuperscriptBox["u", 
       RowBox[{"i", "+", 
        RowBox[{"1", "/", "2"}]}], "+"], "-", 
      SubsuperscriptBox["u", 
       RowBox[{"i", "+", 
        RowBox[{"1", "/", "2"}]}], "-"]}], ")"}]}]}], "//.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubsuperscriptBox["u", 
      RowBox[{"i", "+", 
       RowBox[{"1", "/", "2"}]}], "+"], "->", 
     SubscriptBox["u", 
      RowBox[{"i", "+", "1"}]]}], ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SubscriptBox["u", 
        RowBox[{
         FractionBox["1", "2"], "+", "i"}]], ")"}], "-"], "->", 
     SubscriptBox["u", "i"]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{"%", "-", 
     RowBox[{"(", 
      RowBox[{"%", "/.", 
       RowBox[{"i", "\[Rule]", 
        RowBox[{"i", "-", "1"}]}]}], ")"}]}], ")"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", "%", "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{
   SubscriptBox["x", "i_"], "\[RuleDelayed]", 
   RowBox[{"Sequence", "[", "]"}]}]}]}], "Input",
 CellLabel->
  "In[294]:=",ExpressionUUID->"a4c5f8aa-6a24-463f-afdc-6d87d86cd7dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{"t", ",", 
    SubscriptBox["x", 
     RowBox[{
      FractionBox["1", "2"], "+", "i"}]], ",", 
    SubscriptBox["u", "i"]}], "]"}], "/.", 
  RowBox[{"i", "\[Rule]", 
   RowBox[{"-", "1"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{"t", ",", 
    SubscriptBox["x", 
     RowBox[{
      FractionBox["1", "2"], "+", "i"}]], ",", 
    SubscriptBox["u", 
     RowBox[{"1", "+", "i"}]]}], "]"}], "/.", 
  RowBox[{"i", "\[Rule]", "0"}]}]}], "Input",
 CellLabel->"In[301]:=",ExpressionUUID->"74dfd4be-e2ac-46f1-9e82-9191c5ada32a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["KT`O1v1(=KT`O1) [KTO2-1]", \
"Subsection",ExpressionUUID->"d616972f-1c5a-4c3c-adfe-b782f42da268"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      SubsuperscriptBox["a", 
       RowBox[{"i", "+", 
        RowBox[{"1", "/", "2"}]}], "+"], 
      RowBox[{"F", "[", 
       RowBox[{"t", ",", 
        SubscriptBox["x", 
         RowBox[{"i", "+", 
          RowBox[{"1", "/", "2"}]}]], ",", 
        SubsuperscriptBox["u", 
         RowBox[{"i", "+", 
          RowBox[{"1", "/", "2"}]}], "-"]}], "]"}]}], "-", 
     RowBox[{
      SubsuperscriptBox["a", 
       RowBox[{"i", "+", 
        RowBox[{"1", "/", "2"}]}], "-"], 
      RowBox[{"F", "[", 
       RowBox[{"t", ",", 
        SubscriptBox["x", 
         RowBox[{"i", "+", 
          RowBox[{"1", "/", "2"}]}]], ",", 
        SubsuperscriptBox["u", 
         RowBox[{"i", "+", 
          RowBox[{"1", "/", "2"}]}], "+"]}], "]"}]}]}], 
    RowBox[{
     SubsuperscriptBox["a", 
      RowBox[{"i", "+", 
       RowBox[{"1", "/", "2"}]}], "+"], "-", 
     SubsuperscriptBox["a", 
      RowBox[{"i", "+", 
       RowBox[{"1", "/", "2"}]}], "-"]}]], "+", 
   RowBox[{
    FractionBox[
     RowBox[{
      SubsuperscriptBox["a", 
       RowBox[{"i", "+", 
        RowBox[{"1", "/", "2"}]}], "+"], 
      SubsuperscriptBox["a", 
       RowBox[{"i", "+", 
        RowBox[{"1", "/", "2"}]}], "-"]}], 
     RowBox[{
      SubsuperscriptBox["a", 
       RowBox[{"i", "+", 
        RowBox[{"1", "/", "2"}]}], "+"], "-", 
      SubsuperscriptBox["a", 
       RowBox[{"i", "+", 
        RowBox[{"1", "/", "2"}]}], "-"]}]], 
    RowBox[{"(", 
     RowBox[{
      SubsuperscriptBox["u", 
       RowBox[{"i", "+", 
        RowBox[{"1", "/", "2"}]}], "+"], "-", 
      SubsuperscriptBox["u", 
       RowBox[{"i", "+", 
        RowBox[{"1", "/", "2"}]}], "-"]}], ")"}]}]}], "//.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubsuperscriptBox["u", 
      RowBox[{"i", "+", 
       RowBox[{"1", "/", "2"}]}], "+"], "->", 
     SubscriptBox["u", 
      RowBox[{"i", "+", "1"}]]}], ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SubscriptBox["u", 
        RowBox[{
         FractionBox["1", "2"], "+", "i"}]], ")"}], "-"], "->", 
     SubscriptBox["u", "i"]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["a", 
      RowBox[{
       FractionBox["1", "2"], "+", "i"}]], ")"}], "+"], "\[Rule]", 
   "0"}]}], "\[IndentingNewLine]", 
 RowBox[{"%%", "/.", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["a", 
      RowBox[{
       FractionBox["1", "2"], "+", "i"}]], ")"}], "-"], "\[Rule]", 
   "0"}]}]}], "Input",
 CellLabel->
  "In[134]:=",ExpressionUUID->"e93620a4-a712-4ea5-88f4-d13351a6ae86"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["u", "i"]}], "+", 
      SubscriptBox["u", 
       RowBox[{"1", "+", "i"}]]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox["a", 
       RowBox[{
        FractionBox["1", "2"], "+", "i"}]], ")"}], "-"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox["a", 
       RowBox[{
        FractionBox["1", "2"], "+", "i"}]], ")"}], "+"]}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       SubscriptBox["a", 
        RowBox[{
         FractionBox["1", "2"], "+", "i"}]], ")"}], "-"]}], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox["a", 
       RowBox[{
        FractionBox["1", "2"], "+", "i"}]], ")"}], "+"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"F", "[", 
       RowBox[{"t", ",", 
        SubscriptBox["x", 
         RowBox[{
          FractionBox["1", "2"], "+", "i"}]], ",", 
        SubscriptBox["u", 
         RowBox[{"1", "+", "i"}]]}], "]"}]}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       SubscriptBox["a", 
        RowBox[{
         FractionBox["1", "2"], "+", "i"}]], ")"}], "-"]}], "+", 
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"t", ",", 
       SubscriptBox["x", 
        RowBox[{
         FractionBox["1", "2"], "+", "i"}]], ",", 
       SubscriptBox["u", "i"]}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       SubscriptBox["a", 
        RowBox[{
         FractionBox["1", "2"], "+", "i"}]], ")"}], "+"]}]}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       SubscriptBox["a", 
        RowBox[{
         FractionBox["1", "2"], "+", "i"}]], ")"}], "-"]}], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox["a", 
       RowBox[{
        FractionBox["1", "2"], "+", "i"}]], ")"}], "+"]}]]}]], "Output",
 CellLabel->
  "Out[134]=",ExpressionUUID->"b201d4c2-d159-4993-876d-42846dc624ed"],

Cell[BoxData[
 RowBox[{"F", "[", 
  RowBox[{"t", ",", 
   SubscriptBox["x", 
    RowBox[{
     FractionBox["1", "2"], "+", "i"}]], ",", 
   SubscriptBox["u", 
    RowBox[{"1", "+", "i"}]]}], "]"}]], "Output",
 CellLabel->
  "Out[135]=",ExpressionUUID->"3114d5aa-9a5d-4d68-8a65-7c3a169f86cd"],

Cell[BoxData[
 RowBox[{"F", "[", 
  RowBox[{"t", ",", 
   SubscriptBox["x", 
    RowBox[{
     FractionBox["1", "2"], "+", "i"}]], ",", 
   SubscriptBox["u", "i"]}], "]"}]], "Output",
 CellLabel->"Out[136]=",ExpressionUUID->"05dfeba7-2aa6-410f-bf49-76309557f2e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["Which"], "Input",
 CellLabel->
  "In[103]:=",ExpressionUUID->"3064db90-c583-47d1-bfeb-07276674fc0b"],

Cell[BoxData["Which"], "Output",
 CellLabel->"Out[103]=",ExpressionUUID->"93740d78-d2d6-4731-acb7-99108b8e389a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "KT`O1v1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"KT`O1v1", "[", 
       RowBox[{"\[Epsilon]_", ":", 
        RowBox[{"1.", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]]}]}], "]"}], "[", 
      RowBox[{"nx_", ",", "nu_"}], "]"}], "[", 
     RowBox[{"\[CapitalDelta]x_", ",", "x_", ",", "x12_"}], "]"}], "[", 
    RowBox[{
    "F_", ",", "\[Lambda]dFdu_", ",", "Q_", ",", "B_", ",", "pars___"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"u", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Conserved", " ", 
            RowBox[{"quanties", ":", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "2"}], "0"], ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "1"}], "0"], ",", 
                 SubsuperscriptBox["u", "0", "0"], ",", "...", ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "1"}], "0"], ",", 
                 SubsuperscriptBox["u", "nx", "0"], ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "+", "1"}], "0"]}], "}"}], ",", "...", ",", 
               RowBox[{"{", 
                RowBox[{
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "2"}], 
                  RowBox[{"nu", "-", "1"}]], ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"-", "1"}], 
                  RowBox[{"nu", "-", "1"}]], ",", 
                 SubsuperscriptBox["u", "0", 
                  RowBox[{"nu", "-", "1"}]], ",", "...", ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "-", "1"}], 
                  RowBox[{"nu", "-", "1"}]], ",", 
                 SubsuperscriptBox["u", "nx", 
                  RowBox[{"nu", "-", "1"}]], ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"nx", "+", "1"}], 
                  RowBox[{"nu", "-", "1"}]]}], "}"}]}], "}"}]}]}], ",", " ", 
           RowBox[{"dim", "=", 
            RowBox[{"nu", "*", 
             RowBox[{"(", 
              RowBox[{"nx", "+", "4"}], ")"}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t\t", "\[CapitalDelta]uT", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Differences", " ", "of", " ", "conserved", " ", 
            RowBox[{"quanties", ":", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubsuperscriptBox["u", 
                   RowBox[{"-", "1"}], "0"], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"-", "2"}], "0"]}], ",", 
                 RowBox[{
                  SubsuperscriptBox["u", "0", "0"], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"-", "1"}], "0"]}], ",", "...", ",", 
                 RowBox[{
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "-", "1"}], "0"], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "-", "2"}], "0"]}], ",", 
                 RowBox[{
                  SubsuperscriptBox["u", "nx", "0"], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "-", "1"}], "0"]}], ",", 
                 RowBox[{
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "+", "1"}], "0"], "-", 
                  SubsuperscriptBox["u", "nx", "0"]}]}], "}"}], ",", "...", 
               ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubsuperscriptBox["u", 
                   RowBox[{"-", "1"}], 
                   RowBox[{"nu", "-", "1"}]], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"-", "2"}], 
                   RowBox[{"nu", "-", "1"}]]}], ",", 
                 RowBox[{
                  SubsuperscriptBox["u", "0", 
                   RowBox[{"nu", "-", "1"}]], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"-", "1"}], 
                   RowBox[{"nu", "-", "1"}]]}], ",", "...", ",", 
                 RowBox[{
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "-", "1"}], 
                   RowBox[{"nu", "-", "1"}]], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "-", "2"}], 
                   RowBox[{"nu", "-", "1"}]]}], ",", 
                 RowBox[{
                  SubsuperscriptBox["u", "nx", 
                   RowBox[{"nu", "-", "1"}]], "-", 
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "-", "1"}], 
                   RowBox[{"nu", "-", "1"}]]}], ",", 
                 RowBox[{
                  SubsuperscriptBox["u", 
                   RowBox[{"nx", "+", "1"}], 
                   RowBox[{"nu", "-", "1"}]], "-", 
                  SubsuperscriptBox["u", "nx", 
                   RowBox[{"nu", "-", "1"}]]}]}], "}"}]}], "}"}]}]}], ",", 
           " ", 
           RowBox[{"dim", "=", 
            RowBox[{"nu", "*", 
             RowBox[{"(", 
              RowBox[{"nx", "+", "3"}], ")"}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", "uT", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Conserved", " ", "quanties"}], ",", " ", 
           RowBox[{"dim", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "2"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\n", "\t\t", "F12T", ",", 
         "\n", "\t\t", "\[Lambda]12T", ",", "\[IndentingNewLine]", "\t\t", 
         "Fp12T", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Flux", " ", "through", " ", 
             SubscriptBox["x", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}]], " ", "using", " ", 
             RowBox[{"{", 
              SubsuperscriptBox["F", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], 
               RowBox[{"j", ",", "+"}]], "}"}]}], "=", 
            RowBox[{"F", "[", 
             RowBox[{"t", ",", 
              RowBox[{"{", 
               RowBox[{
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{"0", ",", "+"}]], ",", "...", ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{
                  RowBox[{"nu", "-", "1"}], ",", "+"}]]}], "}"}], ",", 
              "params"}], "]"}]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "Fm12T", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Flux", " ", "through", " ", 
             SubscriptBox["x", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}]], " ", "using", " ", 
             RowBox[{"{", 
              SubsuperscriptBox["F", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], 
               RowBox[{"j", ",", "-"}]], "}"}]}], "=", 
            RowBox[{"F", "[", 
             RowBox[{"t", ",", 
              RowBox[{"{", 
               RowBox[{
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{"0", ",", "-"}]], ",", "...", ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{
                  RowBox[{"nu", "-", "1"}], ",", "-"}]]}], "}"}], ",", 
              "params"}], "]"}]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "\[Lambda]p12T", ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Jacobian", " ", "eigenvalues", " ", "at", " ", 
             RowBox[{
              SubscriptBox["x", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}]], ":", " ", 
              SubsuperscriptBox["\[Lambda]", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "+"]}]}], "=", 
            RowBox[{"\[Lambda]dFdu", "[", 
             RowBox[{"t", ",", 
              RowBox[{"{", 
               RowBox[{
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{"0", ",", "+"}]], ",", "...", ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{
                  RowBox[{"nu", "-", "1"}], ",", "+"}]]}], "}"}], ",", 
              "params"}], "]"}]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "\[Lambda]m12T", ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Jacobian", " ", "eigenvalues", " ", "at", " ", 
             RowBox[{
              SubscriptBox["x", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}]], ":", " ", 
              SubsuperscriptBox["\[Lambda]", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "-"]}]}], "=", 
            RowBox[{"\[Lambda]dFdu", "[", 
             RowBox[{"t", ",", 
              RowBox[{"{", 
               RowBox[{
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{"0", ",", "-"}]], ",", "...", ",", 
                SubsuperscriptBox["u", 
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], 
                 RowBox[{
                  RowBox[{"nu", "-", "1"}], ",", "-"}]]}], "}"}], ",", 
              "params"}], "]"}]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "ap12T", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Approxmiate", " ", "velocities", " ", "at", " ", 
             RowBox[{
              SubscriptBox["x", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}]], ":", " ", 
              SubsuperscriptBox["a", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "+"]}]}], "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Max", "@", 
               SubsuperscriptBox["\[Lambda]", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "+"]}], ",", 
              RowBox[{"Max", "@", 
               SubsuperscriptBox["\[Lambda]", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "-"]}], ",", "0"}], "]"}]}], ",", 
           " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "1"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\n", "\t\t", "am12T", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Approxmiate", " ", "velocities", " ", "at", " ", 
             RowBox[{
              SubscriptBox["x", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}]], ":", " ", 
              SubsuperscriptBox["a", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "-"]}]}], "=", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"Min", "@", 
               SubsuperscriptBox["\[Lambda]", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "+"]}], ",", 
              RowBox[{"Min", "@", 
               SubsuperscriptBox["\[Lambda]", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "-"]}], ",", "0"}], "]"}]}], ",", 
           " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "1"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "H12", " ", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Numerical", " ", "fluxes", " ", "at", " ", 
            SubscriptBox["x", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}]]}], ",", " ", 
           RowBox[{"dim", " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "\[IndentingNewLine]", "\t\t", "dudxT", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Approximate", " ", "derivatives"}], ",", " ", 
           RowBox[{"dim", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nx", "+", "1"}], ")"}], "*", "nu"}]}], ",", " ", 
           RowBox[{"(", "T", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", "P12"}], 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Diffusion", " ", "flux"}], ",", " ", 
          RowBox[{"dim", " ", "=", 
           RowBox[{"nu", "*", 
            RowBox[{"(", 
             RowBox[{"nx", "+", "1"}], ")"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", "}"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"**", "**", " ", "Boundary"}], " ", 
         RowBox[{"condition", " ", "**", "**"}]}], " ", "*)"}], "\n", "\t\t", 
       RowBox[{
        RowBox[{"u", "=", 
         RowBox[{
          RowBox[{"B", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.", ",", "0."}], "}"}], ",", "#", ",", 
               RowBox[{"{", 
                RowBox[{"0.", ",", "0."}], "}"}]}], "]"}], "&"}], "/@", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"v", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"nx", "*", "nu"}]}], "}"}]}], "]"}], ",", "nx"}], 
             "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\n", "\t\t", 
        RowBox[{"uT", "=", 
         RowBox[{"Transpose", "[", "u", "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"\[CapitalDelta]uT", "=", 
         RowBox[{"Differences", "[", "uT", "]"}]}], ";", "\n", "\t\t", "\n", 
        "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"**", "**", " ", "Convection"}], " ", 
          RowBox[{"Flux", " ", "**", "**"}]}], " ", "*)"}], "\n", "\t\t", 
        RowBox[{"\[Lambda]p12T", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Lambda]dFdu", "[", 
             RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x12", ",", 
             RowBox[{"uT", "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"\[Lambda]m12T", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Lambda]dFdu", "[", 
             RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x12", ",", 
             RowBox[{"uT", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", 
                RowBox[{"-", "2"}]}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"ap12T", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Max", "[", "#1", "]"}], ",", 
              RowBox[{"Max", "[", "#2", "]"}], ",", "0"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Lambda]p12T", ",", "\[Lambda]m12T"}], "}"}]}], "]"}]}],
         ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"[", 
           RowBox[{
            RowBox[{"KTO2", "-", "1"}], ",", " ", 
            RowBox[{"eq", ".", " ", 
             RowBox[{"(", "3.2", ")"}]}]}], "]"}], " ", "[", 
          RowBox[{
           RowBox[{"KTO2", "-", "0"}], ",", " ", 
           RowBox[{"footnote", " ", "2"}]}], "]"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"am12T", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"Min", "[", "#1", "]"}], ",", 
              RowBox[{"Min", "[", "#2", "]"}], ",", "0"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Lambda]p12T", ",", "\[Lambda]m12T"}], "}"}]}], "]"}]}],
         ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"[", 
           RowBox[{
            RowBox[{"KTO2", "-", "1"}], ",", " ", 
            RowBox[{"eq", ".", " ", 
             RowBox[{"(", "3.2", ")"}]}]}], "]"}], " ", "[", 
          RowBox[{
           RowBox[{"KTO2", "-", "0"}], ",", " ", 
           RowBox[{"footnote", " ", "2"}]}], "]"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", "\n", "\t\t", 
        RowBox[{"Fp12T", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x12", ",", 
             RowBox[{"uT", "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Fm12T", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"t", ",", "#1", ",", "#2", ",", "pars"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x12", ",", 
             RowBox[{"uT", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", 
                RowBox[{"-", "2"}]}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\n", "\t\t", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"H12", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Which", "[", "\n", "\t\t\t", 
              RowBox[{
               RowBox[{"#3", "\[Equal]", "0"}], ",", "#1", ",", "\n", 
               "\t\t\t", 
               RowBox[{"#4", "\[Equal]", "0"}], ",", "#2", ",", "\n", 
               "\t\t\t", 
               RowBox[{
                RowBox[{"#3", "-", "#4"}], "<", "\[Epsilon]"}], ",", 
               RowBox[{"0", "*", "#1"}], ",", 
               RowBox[{"(*", " ", 
                RowBox[{"0.5", 
                 RowBox[{"(", 
                  RowBox[{"#1", "+", "#2"}], ")"}]}], "*)"}], "\n", "\t\t\t", 
               "True", ",", 
               RowBox[{"0", "*", "#1"}]}], "]"}], "&"}], 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#3", "*", "#2"}], "-", 
                RowBox[{"#4", "*", "#1"}], "+", 
                RowBox[{"#3", "*", "#4", "*", "#5"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"#3", "-", "#4"}], ")"}]}], " ", "*)"}], ",", "\n", 
            "\t\t", 
            RowBox[{"{", 
             RowBox[{
             "Fp12T", ",", "Fm12T", ",", "ap12T", ",", "am12T", ",", 
              "\[CapitalDelta]uT"}], "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"[", 
            RowBox[{
             RowBox[{"KTO2", "-", "1"}], ",", " ", 
             RowBox[{"eq", ".", " ", 
              RowBox[{"(", "3.15", ")"}]}]}], "]"}], ":", " ", 
           RowBox[{"{", 
            SubscriptBox["H", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}]], "}"}]}], "=", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{
               SubsuperscriptBox["a", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "+"], 
               RowBox[{"F", "[", 
                RowBox[{"t", ",", 
                 SubscriptBox["x", 
                  RowBox[{"i", "+", 
                   RowBox[{"1", "/", "2"}]}]], ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"i", "+", 
                   RowBox[{"1", "/", "2"}]}], "-"]}], "]"}]}], "-", 
              RowBox[{
               SubsuperscriptBox["a", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "-"], 
               RowBox[{"F", "[", 
                RowBox[{"t", ",", 
                 SubscriptBox["x", 
                  RowBox[{"i", "+", 
                   RowBox[{"1", "/", "2"}]}]], ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"i", "+", 
                   RowBox[{"1", "/", "2"}]}], "+"]}], "]"}]}]}], 
             RowBox[{
              SubsuperscriptBox["a", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "+"], "-", 
              SubsuperscriptBox["a", 
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], "-"]}]], "+", 
            RowBox[{
             FractionBox[
              RowBox[{
               SubsuperscriptBox["a", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "+"], 
               SubsuperscriptBox["a", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "-"]}], 
              RowBox[{
               SubsuperscriptBox["a", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "+"], "-", 
               SubsuperscriptBox["a", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "-"]}]], 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "+"], "-", 
               SubsuperscriptBox["u", 
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], "-"]}], ")"}], " ", "or", " ", 
             FractionBox["1", "2"], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"F", "[", 
                RowBox[{"t", ",", 
                 SubscriptBox["x", 
                  RowBox[{"i", "+", 
                   RowBox[{"1", "/", "2"}]}]], ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"i", "+", 
                   RowBox[{"1", "/", "2"}]}], "+"]}], "]"}], "+", 
               RowBox[{"F", "[", 
                RowBox[{"t", ",", 
                 SubscriptBox["x", 
                  RowBox[{"i", "+", 
                   RowBox[{"1", "/", "2"}]}]], ",", 
                 SubsuperscriptBox["u", 
                  RowBox[{"i", "+", 
                   RowBox[{"1", "/", "2"}]}], "-"]}], "]"}]}], ")"}], " ", 
             "if", " ", 
             SubsuperscriptBox["a", 
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], "+"]}], "-", 
            SubsuperscriptBox["a", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}], "-"]}], "<", 
           RowBox[{"\[Epsilon]", " ", "[", 
            RowBox[{"KAMM", ",", " ", 
             RowBox[{"Remark", " ", "2.2"}]}], "]"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t\t\t  ", "\n", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"**", "**", " ", "Diffusion"}], " ", 
          RowBox[{"Flux", " ", "**", "**"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"P12", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Q", "[", 
              RowBox[{"t", ",", "#1", ",", "#2", ",", 
               RowBox[{"#3", "/", "\[CapitalDelta]x"}], ",", "pars"}], "]"}], 
             "&"}], ",", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x12", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"\[CapitalDelta]x", "*", "0.5"}]}], "}"}], ",", 
                "x"}], "]"}], ",", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"=", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["x", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}]], "-", 
                   RowBox[{"\[CapitalDelta]x", "/", "2"}]}], "=", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["x", 
                    RowBox[{"-", "1"}]], ",", 
                    RowBox[{"{", 
                    SubscriptBox["x", "i"], "}"}]}], "}"}], "\[Congruent]", 
                   RowBox[{"{", 
                    SubscriptBox[
                    OverscriptBox["x", "^"], "i"], "}"}]}]}]}], ",", " ", 
                RowBox[{
                "contains", " ", "cell", " ", "center", " ", "of", " ", 
                 "second", " ", "ghost", " ", 
                 RowBox[{"cell", " ", "[", 
                  RowBox[{
                   SubscriptBox["x", 
                    RowBox[{
                    RowBox[{"-", "3"}], "/", "2"}]], ",", 
                   SubscriptBox["x", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]]}], "]"}]}]}], " ", "*)"}],
               "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"Take", "[", 
               RowBox[{"uT", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", " ", 
              RowBox[{"(*", " ", 
               RowBox[{"=", 
                SubscriptBox["u", "i"]}], " ", "*)"}], "\[IndentingNewLine]", 
              "\t\t\t", "\[CapitalDelta]uT"}], 
             RowBox[{"(*", " ", 
              RowBox[{"=", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["u", 
                  RowBox[{"i", "+", "1"}]], "-", 
                 SubscriptBox["u", "i"]}], ")"}]}], "*)"}], 
             "\[IndentingNewLine]", "\t\t", "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"[", 
            RowBox[{
             RowBox[{"KTO2", "-", "0"}], ",", " ", 
             RowBox[{
              RowBox[{"eq", ".", " ", 
               RowBox[{"(", "4.14", ")"}]}], " ", "first", " ", "order", " ", 
              "reduction", " ", 
              RowBox[{"(", 
               RowBox[{"Gudanov", " ", "upwind"}], ")"}]}]}], "]"}], ":", " ", 
           RowBox[{"{", 
            SubscriptBox["P", 
             RowBox[{"i", "+", 
              RowBox[{"1", "/", "2"}]}]], "}"}]}], "=", 
          RowBox[{"Q", "[", 
           RowBox[{"t", ",", 
            SubscriptBox[
             OverscriptBox["x", "^"], 
             RowBox[{"i", "+", "1"}]], ",", 
            SubscriptBox["u", 
             RowBox[{"i", "+", "1"}]], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["u", 
                RowBox[{"i", "+", "1"}]], "-", 
               SubscriptBox["u", "i"]}], ")"}], "/", "\[CapitalDelta]x"}]}], 
           "]"}]}], " ", "*)"}], "\n", "\t\t", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"**", "**", " ", "Result", " ", "**", "**"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Return", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Differences", "[", "#1", "]"}]}], "+", 
                 RowBox[{"Differences", "[", "#2", "]"}]}], ")"}], "/", 
               "\[CapitalDelta]x"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"H12", ",", "P12"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
         "]"}]}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"KTO2", "-", "0"}], ",", 
         RowBox[{"eq", ".", 
          RowBox[{"(", "4.13", ")"}]}]}], "]"}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", "\t", "]"}], ",", " ", 
     RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", " ", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], ",", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "->", "True"}]}], "}"}]}]}],
     "\[IndentingNewLine]", "]"}]}], "\n"}], "\n", 
 RowBox[{"ClearAll", "[", "KT`O1", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`O1", "=", "KT`O1v1"}], ";"}]}], "Code",
 CellLabel->"In[104]:=",ExpressionUUID->"38e71165-938d-49dc-be75-c1fd1def2221"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", \
"Section",ExpressionUUID->"776b9fe5-881e-40c6-9a5b-6dba4a87cef7"],

Cell[CellGroupData[{

Cell["Linear advection equation (LAE) [KTO2-0, Example 2]", \
"NonEvaluatingSubsection",ExpressionUUID->"41887e92-a37b-4299-bf80-\
53f8d9277c6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{"u", "[", 
      RowBox[{"t", ",", "x"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["\[PartialD]", "x"], 
     RowBox[{"u", "[", 
      RowBox[{"t", ",", "x"}], "]"}]}]}], "\[Equal]", "0"}], ",", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"0", ",", "x"}], "]"}], "\[Equal]", 
     RowBox[{"Sin", "[", "x", "]"}]}], ";"}], " ", "[", 
   RowBox[{
    RowBox[{"KTO2", "-", "0"}], ",", 
    RowBox[{"eq", ".", " ", 
     RowBox[{"(", "6.4", ")"}]}]}], 
   "]"}]}]], \
"DisplayFormulaNumbered",ExpressionUUID->"44a46fe4-9c38-48a0-bde9-\
23cc3a43e991"],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "+", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"t", ",", "x"}], "]"}], ",", "x"}], "]"}]}], "\[Equal]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"0", ",", "x"}], "]"}], "\[Equal]", 
      RowBox[{"Sin", "[", "x", "]"}]}]}], "}"}], ",", "u", ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "x"}], "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[480]:=",ExpressionUUID->"d403fe1b-a05a-4a4b-9e40-b7f4c7751ab7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LAE`pde", "=", 
   RowBox[{"Sequence", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#3", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}], "&"}], ",", 
     RowBox[{
      RowBox[{"{", "1", "}"}], "&"}], ",", 
     RowBox[{
      RowBox[{"{", "0", "}"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LAE`ics", "=", 
   RowBox[{
    RowBox[{"Sin", "[", "#", "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LAE`systems", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", 
           RowBox[{"n", ",", "1"}], "]"}], "[", 
          RowBox[{"0.", ",", 
           RowBox[{"2.", "*", "\[Pi]"}]}], "]"}], "[", 
         RowBox[{"0.", ",", "1"}], "]"}], "[", 
        RowBox[{"LAE`pde", ",", "BC`periodic"}], "]"}], "[", "LAE`ics", "]"}],
       "[", "None", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", 
       RowBox[{"{", 
        RowBox[{
        "40", ",", "80", ",", "160", ",", "320", ",", "640", ",", "1280"}], 
        "}"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[305]:=",ExpressionUUID->"c3569952-5b93-46d9-8987-5aa5f467e284"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LAE`solutions", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solve", "[", "s", "]"}], "[", "False", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "LAE`systems"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[493]:=",ExpressionUUID->"bc5da91e-0ec5-43db-b415-d2f993bd185f"],

Cell[BoxData[
 RowBox[{"KT`system`pde`print", "[", 
  RowBox[{"LAE`systems", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellLabel->
  "In[918]:=",ExpressionUUID->"a14b24f6-a274-42cf-bca5-6bb2281bb1df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rate", ":", " ", 
   SubscriptBox["r", "i"]}], "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Log", "[", 
     RowBox[{
      SubscriptBox["\[Epsilon]", "i"], "/", 
      SubscriptBox["\[Epsilon]", 
       RowBox[{"i", "-", "1"}]]}], "]"}]}], "/", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{
      SubscriptBox["n", "i"], "/", 
      SubscriptBox["n", 
       RowBox[{"i", "-", "1"}]]}], "]"}], " ", "[", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
       "Rate_of"}], "_convergence"}]}], 
    "]"}]}]}]], \
"DisplayFormulaNumbered",ExpressionUUID->"f75a7f8f-065c-4596-9548-\
fc2643d93fe7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KT`system`solution`xui`t1", "[", "#", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "LAE`solutions"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"#", "-", "1"}], "]"}], "&"}], "/@", 
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ")"}]}], "&"}], "/@", 
   "%"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Length", "[", "#", "]"}], ",", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "/", 
       RowBox[{"Length", "[", "#", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"#", ",", "\[Infinity]"}], "]"}], "/", 
       RowBox[{"Length", "[", "#", "]"}]}]}], "}"}], "&"}], "/@", "%"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"%", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"%", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Log", "@", 
          RowBox[{"Ratios", "[", 
           RowBox[{"%", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]}], "/", 
        RowBox[{"Log", "@", 
         RowBox[{"Ratios", "[", 
          RowBox[{"%", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], ",", "0"}], 
      "]"}], ",", 
     RowBox[{"%", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Log", "@", 
          RowBox[{"Ratios", "[", 
           RowBox[{"%", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}]}], "/", 
        RowBox[{"Log", "@", 
         RowBox[{"Ratios", "[", 
          RowBox[{"%", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], ",", "0"}], 
      "]"}]}], "}"}], "\[Transpose]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", 
  RowBox[{"%", ",", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"None", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<N\>\"", ",", "\"\<\!\(\*SuperscriptBox[\(L\), \(1\)]\)-error\>\"",
         ",", "\"\<Rate\>\"", ",", 
        "\"\<\!\(\*SuperscriptBox[\(L\), \(\[Infinity]\)]\)-error\>\"", ",", 
        "\"\<Rate\>\""}], "}"}]}], "}"}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[494]:=",ExpressionUUID->"28b9dfae-7c69-409e-a67b-e798215e1f7b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system`generate", "[", "KT`O1v0", "]"}], "[", 
        RowBox[{"320", ",", "1"}], "]"}], "[", 
       RowBox[{"0.", ",", 
        RowBox[{"2.", "*", "\[Pi]"}]}], "]"}], "[", 
      RowBox[{"0.", ",", "1"}], "]"}], "[", 
     RowBox[{"LAE`pde", ",", "BC`periodic"}], "]"}], "[", "LAE`ics", "]"}], 
   "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT`system`solve", "[", "%", "]"}], "[", "True", "]"}], "\n", 
 RowBox[{"%", "//", "KT`system`solution`xui`t`Manipulate"}]}], "Input",
 CellLabel->"In[308]:=",ExpressionUUID->"e4387fa5-a41d-4c11-a183-57db1ba78c07"]
}, Closed]],

Cell[CellGroupData[{

Cell["Linear advection with position dependent speed", \
"NonEvaluatingSubsection",ExpressionUUID->"a1e1ee22-b305-4765-8b12-\
fc09d74854e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{"u", "[", 
      RowBox[{"t", ",", "x"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["\[PartialD]", "x"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], 
       RowBox[{"u", "[", 
        RowBox[{"t", ",", "x"}], "]"}]}], ")"}]}]}], "\[Equal]", "0"}], ",", 
  " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"0", ",", "x"}], "]"}], "\[Equal]", 
     RowBox[{"v", "[", "x", "]"}]}], ";"}], " ", "[", 
   RowBox[{
    RowBox[{"KTO2", "-", "0"}], ",", 
    RowBox[{"eq", ".", " ", 
     RowBox[{"(", "6.4", ")"}]}]}], 
   "]"}]}]], \
"DisplayFormulaNumbered",ExpressionUUID->"fae0997e-7d49-4859-8863-\
bd811e304e8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LAE`pde", "=", 
   RowBox[{"Sequence", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", 
        RowBox[{"#3", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "&"}], ",", 
     RowBox[{
      RowBox[{"{", "1", "}"}], "&"}], ",", 
     RowBox[{
      RowBox[{"{", "0", "}"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LAE`ics", "=", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"2", "<", "#", "<", "4"}], ",", "1", ",", "0"}], "]"}], "&"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LAE`systems", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KT`system`generate", "[", "KT`O1v0", "]"}], "[", 
           RowBox[{"n", ",", "1"}], "]"}], "[", 
          RowBox[{"0.", ",", "20"}], "]"}], "[", 
         RowBox[{"0.", ",", "1."}], "]"}], "[", 
        RowBox[{"LAE`pde", ",", "BC`linearExtrapolation"}], "]"}], "[", 
       "LAE`ics", "]"}], "[", "None", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", 
       RowBox[{"{", 
        RowBox[{
        "40", ",", "80", ",", "160", ",", "320", ",", "640", ",", "1280"}], 
        "}"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[146]:=",ExpressionUUID->"cbb4ccbc-8fa2-4995-8e7c-4bed4dcc1d7f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "+", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"1", " ", 
          RowBox[{"u", "[", 
           RowBox[{"t", ",", "x"}], "]"}]}], ",", "x"}], "]"}]}], "\[Equal]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"0", ",", "x"}], "]"}], "\[Equal]", 
      RowBox[{"v", "[", "x", "]"}]}]}], "}"}], ",", 
   RowBox[{"u", "[", 
    RowBox[{"t", ",", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "x"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"LAE`analyticSol", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Inactive", "[", "Function", "]"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"v", "[", "x_", "]"}], "\[RuleDelayed]", 
        RowBox[{"LAE`ics", "[", "x", "]"}]}]}], "/.", 
      RowBox[{"x", "\[Rule]", 
       RowBox[{"Slot", "[", "1", "]"}]}]}], "/.", 
     RowBox[{"t", "\[Rule]", "1."}]}], "]"}], "//", "Activate"}]}]}], "Input",
 CellLabel->
  "In[149]:=",ExpressionUUID->"f7291d68-53a9-44de-b373-c08d535bac3d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"t", ",", "x"}], "]"}], "\[Rule]", 
    RowBox[{"v", "[", 
     RowBox[{
      RowBox[{"-", "t"}], "+", "x"}], "]"}]}], "}"}], "}"}]], "Output",
 CellLabel->
  "Out[149]=",ExpressionUUID->"3a78979e-e0b2-4451-b770-994354271c13"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"2", "<", 
     RowBox[{
      RowBox[{"-", "1.`"}], "+", "#1"}], "<", "4"}], ",", "1", ",", "0"}], 
   "]"}], "&"}]], "Output",
 CellLabel->"Out[150]=",ExpressionUUID->"62ac2908-b5b9-4904-8d9d-c5bd591ef7dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"LAE`solutions", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solve", "[", "s", "]"}], "[", "False", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "LAE`systems"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[151]:=",ExpressionUUID->"c2713c58-0402-4cba-a12e-fa9191dc3fe4"],

Cell[CellGroupData[{

Cell[BoxData["\<\"0 (2020-11-23T17:48:19): \
KT`system`solution[nt=36,tw=0.0049985 \
s][KT`system[KT`O1v0,...][nx=40,nu=1][...][t0=0.,t1=1.][...][...,pde`t$2623,\
pde`u$2623]][...]\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[151]:=",ExpressionUUID->"afbfd5c0-5159-4e3d-b126-35216cd5123a"],

Cell[BoxData["\<\"0 (2020-11-23T17:48:19): \
KT`system`solution[nt=48,tw=0.009962 \
s][KT`system[KT`O1v0,...][nx=80,nu=1][...][t0=0.,t1=1.][...][...,pde`t$2682,\
pde`u$2682]][...]\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[151]:=",ExpressionUUID->"b95d73e6-cb09-4f04-8ff2-ebeadce30332"],

Cell[BoxData["\<\"0 (2020-11-23T17:48:19): \
KT`system`solution[nt=68,tw=0.0200224 \
s][KT`system[KT`O1v0,...][nx=160,nu=1][...][t0=0.,t1=1.][...][...,pde`t$2741,\
pde`u$2741]][...]\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[151]:=",ExpressionUUID->"dfdcf33c-7bbc-4538-beac-87f8fd4d3e61"],

Cell[BoxData["\<\"0 (2020-11-23T17:48:19): \
KT`system`solution[nt=95,tw=0.0649387 \
s][KT`system[KT`O1v0,...][nx=320,nu=1][...][t0=0.,t1=1.][...][...,pde`t$2802,\
pde`u$2802]][...]\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[151]:=",ExpressionUUID->"8d30f62a-e847-4f89-b8ca-649c9d1a5843"],

Cell[BoxData["\<\"0 (2020-11-23T17:48:19): \
KT`system`solution[nt=135,tw=0.1449716 \
s][KT`system[KT`O1v0,...][nx=640,nu=1][...][t0=0.,t1=1.][...][...,pde`t$2977,\
pde`u$2977]][...]\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[151]:=",ExpressionUUID->"77543163-1688-469a-a1bd-88e5725c6840"],

Cell[BoxData["\<\"0 (2020-11-23T17:48:20): \
KT`system`solution[nt=213,tw=0.4305219 \
s][KT`system[KT`O1v0,...][nx=1280,nu=1][...][t0=0.,t1=1.][...][...,pde`t$3152,\
pde`u$3152]][...]\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[151]:=",ExpressionUUID->"f6d9b700-4c88-4601-bac8-1eee8132f8dc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"LAE`analyticSol", "[", "x", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "20"}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"KT`system`solution`xui`t1", "[", 
      RowBox[{"Last", "@", "LAE`solutions"}], "]"}], "//", "ListPlot"}]}], 
   "}"}], "]"}]], "Input",
 CellLabel->
  "In[152]:=",ExpressionUUID->"f18a2543-59c4-4772-a722-a9b38bfbe94b"],

Cell[BoxData[
 GraphicsBox[{{{{}, {}, 
     TagBox[
      {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
       Opacity[1.], LineBox[CompressedData["
1:eJxTTMoPSmViYGBQB2IQPbcuic0wZbYdAxQcuazgE65QaQ/j/z+2r1lBoRPO
n3ugV55VYSacn2NbmvtdfiWcf/l3xpQP8jvhfPbbj9Tfyp+E8xeeml/4Wv4m
nL9ufeftHL1XcH66/cWZb4o+w/l5TzUfb1n3E87nUmxRv2/B4ADj9wmc1lqY
wAzn7zSX3eqXh+A/icu3/1ON4FuvFQ4Jn47gv/CMqeU9h+A7N789X2nNAuf/
+MpfGiTGCucryyb9/6+M4Pu5bOlca4jgL50UMY/DF8EP0l94fF8zgr82w0hK
+yOCn3Q7ZD/zGTY4n2v2w9zCmwj+pqg8mfvPEHzmW+2VuxjZ4fwlN3YZF5oj
+D4z3B/dc0Hwv4RfmeAThOC7Xn/7Vj0XwX92VWHFvUUIft/UtWE+GxB8s1Ar
1l17Efx7Isc3q59G8NuvBCdNvYHgG0x5IMD8DMGf2zQ9+MMnBB8Ai52JFQ==

        "]], 
       LineBox[{{3.006377551020408, 1.}, {3.0069811085362694`, 1.}, {
        3.033208539529572, 1.}, {3.059435970522874, 1.}, {3.1643456944960837`,
         1.}, {3.269255418469293, 1.}, {3.4649731724233637`, 1.}, {
        3.6606909263774345`, 1.}, {4.085147536096799, 1.}, {4.481400757831468,
         1.}, {4.675629756339107, 1.}, {4.869858754846746, 1.}, {
        4.922543642200059, 1.}, {4.975228529553371, 1.}, {4.981814140472535, 
        1.}, {4.988399751391699, 1.}, {4.9936224489795915`, 1.}}], 
       LineBox[CompressedData["
1:eJxFz3lIEwAYBfB5LEIXoZXNpmPq8tjhNLVQyspFeVPOdUzTNtsUy0niSNTw
gLVJqVOXiiYjp0YMtWRKGo6akpm6ysyKFom6JCFCx8qZZQXxfQ8ej9+fz0eU
nyJ2JBAISX/7b/uiw2cVW3YeIfzPnI4cJtiKFhu/N5C3o6Xf+vi3vNCrxLoB
nh/6qlf+bncGujyO+b7mALpBq01XpqDJQxXDx8+hb7/MpBIvoLt+UeYq8tAP
z6izSpRos6s8V2pA+xdKilIZu8DsqE88TQg6nHCWs7wfHXMz7nMZF53RwUrV
paMbZ1Y5jrVoYkTZUq8VvWhrOu067AGOt+Req79CBicvqphU6h7w8oio/Fk3
BRzsNuvNzfQGuxy2Cc1WKvjEV8EPXz4N/M540UHA8gH3K0czaDa0hCibM5l8
wVkFJf2kFj8wJ5tpShTSwS/cWa6yyL3gRz2VrSwnf3CJA+Pk5Ee0i7k4VqoP
AFu6fNSa0kCwOtDTeZAfBFa1SMaENAZYoD5vIi2h14512jUGJnjBElNkVLDA
7YdCKVNCNrhbLnPLZgeDFfysBCcbOsJ8555iigNuDmrtnkoIAZc9rm5OGEQn
Ufidz+mh4KPSsTS3KrTGS0SftKHpI3cbk9P24T+2kTFtQEuszq/GGWFg0YNV
WlUt+nIlbyO+Di3j6d+SGtBKm6xG1YjuibT/bGpD259sznbp0KppUvXoGLpF
m5dzfRytLTRxYyfQAx6q9QkT2izYkfP6DTpgwZM7v4AO0RdTOyzoKPkHu3gJ
nRjQdv/LMrrgEo26soIuPVhh77Oi5dvmZwpt6OZe7Y21NXR7uXP20Dpad0oc
U7qB1vs+9Y7+jTZY/e2bm+g/o4kKCw==
        "]]},
      Annotation[#, "Charting`Private`Tag$3734#1"]& ], {}}, {}}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.004583333333333334], 
     AbsoluteThickness[1.6], 
     StyleBox[PointBox[CompressedData["
1:eJxd2nVYVWvTB2AapLtjF6B0N3uNii02BqjYgWK3YGB3gXoUC8VWbOxWFFEw
wECUEFEQtokJvms947fn+jj/vNf9Hg/CZq3nmfnNiIeM7zFcTYX/R1NFhf1v
k3+26rg/9Vdfy/1/71T63cqr1+9r7G/y748pfT33W56Kxqkmf/6s0kZdV5zd
onmxyX9/Vemjo417bFG/3uTr3VS60L243UiN202+/h2l/9RmRgZo5jb5+/KU
lh6b4K+q9aDJ31+gtPO5beYj1R82+X4eKR1iu2DNffXHTb6/J0p3mj1KN0Cj
sMn3W6R0/MvoRVs0njb5/p8pPSnSX0VV83mTn+eF0ou3W88eqVnc5Od7qfR/
fxu+3dcsafLzvlL68KCKCQFar5v8/KVKlw56MzV6QWmTz6NM6QSTPifnLShr
8vmUK/3l2t2PJxeUN/m8KpROnhThVbWgosnn90ZpbWnWGNuFb5p8npVKr30s
PhC9sLLJ5/tWaduFqW/nLXzb5POuUnpPgLbs1MKqJp//O6U9K2cOrlr4rsnv
473S2Wkfttsuet/k91OtdMu2wt9Y3eT3VaN0bv1Dm/mLapr8/j4o3WtfVJ9T
iz40+X3WKv2qT3Zq1aLaJr/fOqVH6rg9sl1c1+T3rVD609l0oy6LFU1+/x+V
vnRqyV5oTcbngaxm0LJN7A0yPh+flG43/FfF5NZkfF7IKy+dTFl1g4zPz2el
H1okive1JuPzRLYc53L16g0yPl9flI69/Xrgi9ZkfN7IOxz/a/hyg4zP31el
30zrkW4QRcbnkdwiXy/c9SYZn89vSo9zvfUcosj4vJJPzp0zI/YmGZ/feqV/
PA22mhJFxueZHOHz6fSqm2R8vr8rPX/pQf4RIuPzTr5dOvTL1ZtkfP5/KK0X
6rD+RRQZ3wdyt3VFPl9vkvH9+Kl02vs1+QZtyPi+kJ+37MB/RGR8f34p7bhF
eMLI+D6Rh36+cCj2Fhnfr99K7+84teOUNmR838i1GV7vV90i4/v3R2m/31VL
9rUh4/tInt5zl8u1W2R8PxuUFr67F23I+L6SVTTMh329Rcb3t1HpNv3vqxm2
JeP7TF5+avEu19tkfL//Kp2vD9CyLRnfd7L58J+vYm+T8f1XgWVnzZ3G9XYN
OzzwuTxMqgKjzl2Jr7NeGobngQrs+/rMc1bls7B83SDDdkNVYMK608WLnMTh
eD6ogEr90uujMwaHfzqzvqTnbhXooTvr+X9q28LxvFAB93UO+YHFj8PNhir4
b1kFbEWOLd9HaUfg+aEK8eWnE9YXBkcEGXVOSpSqQl/bIu82R4dH4HmiCm6z
TuWlXFwX0ffC/k6zhqrCqLCHH1YPOB+B54sqvNHvUrPya1kE/zDYLdmtCtf2
d5/qv04rEs8bVQiboBJqEeMWuc1sSPWGClVICNc3OHC4cySeP2rQeUTC4Hdt
EiOvXrl8bqdUDQbPLdj6UrQyEs8jNeit1WbUoyUHIsvH2C07MlQNNrYo2Nb8
261IPJ/U4FNK9MG/n8oiNaxn9D2/Ww0Mc+J23fj0OxLPKzXwOZ9ecei2udz1
5hPXnAo1CApbPOzlGk85nl/q4LBuQ5yxW5S8wwTf74+l6uC17FjVyTGxcjzP
1EFfTXK8Zu8E+Vj71fwrrA4+M6BqYOhCOZ5v6vBT17bx24lN8tV3qtNqd6tD
+23qq+c+OSjH804dMlMevc8YfEl+fIrwiarDmC5HE/Y2z5fj+acBly+dez1I
o1T+WCScGBqw4McISek3hRzPQw0odHS5FvWzUS78afNhGjB24WI/N28DDs9H
DWiVxi3UvG7LWc8cwH8JDSjZ2WXXpDeuHJ6XGnBo9O3qd7kBXJjz+QzPNxow
98nPQ357W3J4fmqC3tOQfvvl0dyAh5aTwmSakBwaXdT/YB8Oz1NNEC/ZtmR3
9hBubvLklu2GaULdf7VP73wdy+H5qgmJjXtW+9ZM5Xa1KDDutUcT8ixbaZhw
8zg8bzVhbuiCoqzNS7ibhR78I6sJWd0qsiflreXw/NWC2LjeQz9M3cS9nb8s
K1GmBdkmnYa9NtvJ4XmsBbP/2k/rsDuTa+b1ds6sYVqQ01U9UJp+mMPzWQsO
7TfekbrpBOf+olWXJXu0YPeBDyuf3sjm8LzWguRN7drZv7nEdVm8wyH1jRZk
iId/uzv/OofntzbMfQpbvq6/zU3w+/Nhp0wb1k8ZZ24qvcfhea4Ne9Yf8Umx
KODWv+p78cgwbVgVErUoJf8Rh+e7Nry4+LzftOxC7vTy0yvO79GGKX7WK4bd
eMbhea8N7UxaDnlRVcw9DTKNy3mjDYOOXz420fo1h+e/DogmDq70k5Vxv8rH
uT2R6YBulWte2ulyDu8DHUiNX+81P+wNZ7/m3s/SYTqwzVAedPZIJYf3gw5I
dtiMeKxbxXHhze/W7tGBHVmxpwd3ecfhfaED3f3Gin5Ofc/xf3jzrzc60PpP
m9ygedUc3h/N4N1+8d+ssTXcgg1lI7Wdm8HfO9Y9noV/4PA+aQZJcRD5qu4D
t5eTB5sPbwazJxSXLFhSy+H90gzezzTb+027jrtTs0VLnNkMnmxXWZQxqY7D
+4b/+ubvelrn1nE1m74XelY2g6GGaQfeGCs4vH904VJORG5SBwVnENUrM8xZ
F3aMN2jpPk3B4X2kC/oG+g/U/1NwPh+P8W+QLuwui/r28qSCw/tJF7p6PVgY
fUfBCW9Lr0xdWOQV1/LoUwWH95UuHLU22ONQoeCmtE8wG1ypC1nb/McsqlFw
eH/pga5LofOuTwpu09fb5YnOelBXU3BJo17B4X2mB1Xxo52kPxUcfzidmDVc
DzIHD/Ht9VvB4f2mB/P77vR98UfBvew8b/6STD04U5M5+G2DgsP7Tg9MrhYW
pjcquMYfL7ulVurBsQVt91v9VXB4/+nDhl07Zo3mLcoMFe1y1ofIGT/G7OCN
96E+lA4v23Gdd+vuGxVHhuvDQNnYAc954/2oD21SYt9V8R7e8Pny+Ux9uHy3
xOETb7wv9aFTtaKinvfSA11X51Tqg9uB7Jm/eOP9aQDWL0RH//A+GHN4wBNn
A1iQVqbZyBvvUwM4f75LoeD7qs08y4YbwI3ADt3/8sb71QCyy05uEcx/c/yv
1ADmxt29JRjvWwOwnV/4SrBJ7PV7vyoNYFlSVK1gvH8NoeBUyjfBAVpOW7Vd
DKHfN49fgvE+NoTrDvf+CO59YnaC+QhDWFPINQrG+9kQPGMM/gqeOfBZqHiv
IWw/kcyM97Uh7P/vPPNW3UD+CDGEOzHFzHh/G8Gmux+YL59Z9yzMxQhM1OuZ
8T43guDnv5hLh9TtazfCCNoNaGDG+90IRh1oZFYz6jS9114jGNfzLzPe90Zw
4QDa+cK+toPfGkFAIRrvf2Ooq0bv8VfTCzYzhuPf0FgPGIPWb/TpZcf4V9YY
1jagsT4whteNaHZd9TSGSX/RWC8Yw9l/fhpo0KrjZGOo/GesH4zhwz+/W3Hh
QLcNxlD/z1hPGEPDP/8qG83f+Mbw5Z+xvjCG2n/WCxFuIGPI+GesN4wh9t/3
x67PL8ZQ8OPf58HqDxM4V472fCO8oSaQvAaN9YgJzBuJny8XJjwxJnAmBX8f
WJ+YQKNBHXO3tQ+tpvc0gRn2d5ixXjGBzNx+zIPfzuWvMBMIVHNlzw/WLyZQ
O/sbe97Ydb7BBAxdcj8LxnrGBLY0P8Ge3wXrX3ZZftIERiy0zRKM9Y0JGHcb
1Upw2rvlZ9Y+NgEn7bM9hPcF6x0TyMm411N4v/bKQx03fTGBPsOLAn/wxvrH
FNqIdvxW8Bbepm1mprC1xEm3lDfWQ6ZwInmagfD+s/LC3xRqAvu0XsEb6yNT
0Hj1WNGCN39ZxxzsaQqWNYVn5/PnDdZLphC0rzxjBH8e1Wz8fPHYZFNYqhoz
eSN/fmH9ZAr5x9/HHPvBn8f87Ze9wRQGP0996PZVwWE9ZQqzh8zo376WP59b
d+V/ZFMYYto8WI8/T7G+4v/+M+XpLZ7w57VQ7jw2hUPf6y6oX1FwWG+ZgsmX
TNi2S8F5Kw7F5X4xhSWVkJA+U8Fh/WUG4ujK9G5R/HnOP00FZmbwqsuFZtcb
6zisx8zA3Gf7qHuZdVwP9sKYwcfcrLzIoDoO6zMz+F7tMNbgSC03lD2wZnAl
YYjhIu1aDus1MzAzsJqe1PoDx8qvyWbwX/belFXxNRzWb2Zgkzv+eau4am4x
+4WZQfWQN7PCg99zWM+ZweagA1Xyb1XcJvaBmUFRxYBL8s1vOazvzGCK2Oxx
lKyS28++YTMoeTv5fPT2Cg7rPTPoMf31A1P9cu4c+w/MoM2+na45k0s5rP/M
4btDZOCW7BIOaQ6bfI+NfJL6gsN60BzcWxZnNCx/yr1kBZs5TChfsGHNnicc
1ofm8Ptann+/6odcLSvAzMGoZZrbzNsPOKwXzeFBUNc5ds1zucbvQkFlDuFG
74pkf2/9qx/NIT1upjpEX+eMWIFkDtLzoeMjxZf/1ZPmcEjcYGG47CzHvp1T
5mAwR2ZSduPkv/rSHPbH39meOS+L82MFjDn4mdRnPS3c/6/eNIeK03OuzRq4
m2vNChJzKHMdeD+hYtu/+tMCPpqOPDuiYCPXixUYFuCk1ePVprB1/+pRC9h5
4U+S/pVl3HBWMFhASEbO0es6C/7VpxZgf/7d5sjnszn2cfSyAI/Ho3q8bj7l
X71qARvbV32OKx/LLWUXugV0DRySlzpr2L/61QK+tz4Vc+pSf+4/dkFbgHuF
68CF9T3/1bMWsCxgXmzK5E7cQXbhWoDa8lnTwrJa/atvLSDqXUjDJK9Q7gK7
QC0g9uuegs95Pv/qXQtIuNiwO8PPhbvPLkTeofO9v+s6/Kt/LcEy7bXe4QJT
7hW74CzBJyinTNVZ5189bAkXqztGGx1rlCvYhWUJhwtv1nbo/kWO9bEldNw7
LDnT6p1cRV24gCzhctLZxKibJXKsly2h8ZTETRTySG7S79KJ5CmWUPfUcIDY
5rYc62dLiKhd5/Vz9Xk5exxSLcFl5Nbdb3dlybGetoSFl7fHmR/KkAdo2qYs
P2UJ3q17hT4vSpNjfW0JIaoT9mj3XCZvE3fn/don/PfrOT+oh12yHOttS2hz
yHgYlzZB3vv4tO6bvlrClO9RhxZcGCLH+tsKHjYa16b96iXni0/+RrCC6gJV
H/fO7eRYj1uBvOJdnMm+UDl7HAOsYP605OK9ah5yrM+tYG+jzcy4GEf58pPC
/2MFfQ569TjYwViO9boVdKnUXLC5n6p8azOhguT/PddYZR7zORLrdytYliXr
OiGoIvJwvFDRWMHQxafzH/58HIn1PP/nx3JtLLfejLx0euWVS6esIN7Ho/SV
xelIrO+t4OSK0ocvRmVGstfhiRWc2DEhJnN9WiTW+/zPZ3gxyWHtosjSwe9X
5361gthmpakfhk2NxPrfGtouCfCbZjI88lP2pvoCc2tQn9n3YMWGXpHYD1iD
kU2Bdm5960i+GBr4NMAaxktyjrYJ8Y/E/sAaHLQqT6rHSiKFaquklzU8WrLo
j+tYk0jsF6zhQkt5vPUIlUj2Ok6xhsJvbddPy6iLwP7BGvIf3JVFzHoZEWTc
Pa061Ro+ntO2afDPjcB+whp+mi9vn/I9O6LdiL9/Pp6yhi0d1S5qPsqMwP7C
Gma2HuBnt3NDhPBpf3/Cf38/bbS0t8yPwH7DGm5NNGvfe/D4iATT/nkNX/n/
3rLxbavNcRHYf9iA05b9f59Et4/A48AG/BO0Ah75BEZgP2IDYastLZdFSCJW
Xj7Ll3A28MT3/aH4NKMI7E9soEAxMLl95a9wVk3E2MCxE6C66/jbcOxXbPh+
IfTl2l6Pw48mWIyxmmoDN4KHdw4zuBqO/YsNvDd4plDsOhjOX2aPHNJsIHWP
/8zczhvDsZ+xgY1Jiq+VOinh7Dg6bQMqox6OHr0oMRz7GxuoMXsqGwx9w8vH
ijLcCvmv3ybCpJV163Dsd2yg0W+gXPOLV/iX6w+a+X6zAatxiaYpJdbh2P/Y
wl5FVHaxmXq4hk3yxGALW/jzbGKY2dm6MOyHbMG3vGdyY7NnYZbj3Z9HBtqC
i7zztTHq18OwP7KFm1yzGW/LD4ex4zDGFj7u8jpnWZMWhv2SLejXXFvW22Ze
WIidcALawkudDC24PDoM+ydbSPQeFKFf3COsw0ThCbCFU/cPBe9uGx6G/ZQt
DI38EmN1xTmMf5in9zltC8uvX+hdtNMwDPsrW2h19/Ls2NpvoWMdNrweUGgL
28ebXHZOKAvFfssW7iUYX5DOzwllx/E3W5g27mCzy5eOhWL/ZQfLJWf33p64
JXT1XQX/K7ID44Ql4yYZzQ/FfswOqi+Neni3w6jQHU7bLScG2sGWC6NiTuj2
DMX+zA5SgipSe08ODj0+tfOc6TF2sDRrx7rpl0Sh2K/ZwfOMUX4XNXRDhe4j
eaodlFnFdgxcUxeC/ZsdmG/bebuyujCEXQdpdvB5sGGiWunVEOzn7OBuWdK6
528zQoSffvlpO2hQNU7eELkiBPs7OxjdY/gxr3tTQvhmymFdoR3oa/ZPGhTW
OwT7PTvoPGZV0gFDCBFOm03f7OBc2d15+2Obh2D/Zw/rM2ZBfIVOiPWsIR+2
WdjDwd9zrlp++hSM/aA9HNs5yvaxU3Ewu44C7cHTJzg2MPV8MPaH9rC/72r3
vn8ygsNcrvBXkD3YRU2e7HVhZTD2i/bwkJu5sdppTHAnvpo+PtUetFq1jytR
7xmM/aM9nKvwv3tbERE84JHdiuw0ezBe+3agz3zbYOwn7WFzK7sL3TTVgsc1
z/186bQ9HF++p6zkWE0Q9pf81z97vlfHp3eC2HVYaA/b182aMdrtWBD2m/Zg
0LEmNdzlv6C1T1z4ksceJjSmSIbGTQvC/tMBtvQevssoKS6If3laPLRwgFl9
+jdMymwThP2oA3zetbBNQk9pEF+sr3sa6AAZn4ZP3OKjFYT9qQMs29XN49PO
T4E3i3x/lsQ4wPHi6e8dtQsCsV91gPivWV3kpscD2XU81QGyr7TdHSXeGoj9
qwP4LtIN05k0M/BtilDxOUCdmnvcW0m/QOxnHeBKwZlJdadaB/54Jtx4DhBQ
sq/MOEoaiP2tA+iffHnbOFc1sJm38MY7QHmOie1UrZoA7Hcd4OCdYzVJ2fcC
bBcJP7EDLD3Q+cfjjvsDsP91hF/Ze4M3LVgXgOWAI3RsWB7p+GpSAPbDjrCo
xVNFkla3gAjf+ge6QY4Qe903d8KCwADsjx3hme84ldBw6wD+sg4y6e0IP9K3
pNmO+OqP/bIj+CYmF/q7PPePL+mx3WqaI1TYVo5M73TJH/tnR0gcN31e8ufN
/uy72egIr0dEBto5JfljP+0IF6N7F/c7MMiflSNnHMFi044l5bJIf+yvHWFs
/sYj60Md/dfzb79bkSPkBY84rP1C1R/7bUdYBceNZ7qV+u0J1I/0rXeEoPk1
A817XvHD/tsJpufcPfrCOMNPuG2DLZ3g8ZDprzy+zPPDftwJimWOdmu6xfvd
LhulLw9ygryFY/tF927ph/25E7jdX3Q0/YrIj5VDvZ3g/HurvDqHRl/s152g
8+x+h9Ydf+3Lv6zFHac5QZGoVXqA+xVf7N+dwMFt+u7LF7f6Ct1k941OcDtA
v3fV8dm+2M87QcmmkulxfeJ89cIkh/qccYIhLbLLf/YO8cX+3gmM2izdbOBt
5Wu/tsB0YJET3IyyOyk5WO+D/b4TKOolt6Ojnvh4CuVYvRP0DWv/jNt0wgf7
fxHoRbV4OenBOh92vOmJ4Hz+ho6rPo/3wTxABJLpujvdUzr7CLdxiJ0I+g2L
STHf6OaD+YAIFu2zqsov0Pbx/XrzWbg7b9fEcfVP33hjXiACfauTXW5WXPcO
dUrX58JF4N1nZ4sueTu9MT8QwdnEx2+u/UnybtVxMrTqJIIZPR7eub+6nzfm
CSK4OGqqStmEIG923MaJoOaqeuxlsZk35gsiqF4s72k15aNXz53i/e3HiMBt
4fjcL6PzvDBvEIFV6tCwnI/7vPrf+1HcabYIHjcYb54rXeiF+YMIinX7lg43
HOw1rD6fPxJFoFYtH1A9KMIL8wgR3IyP2bB1pJWX0O322CqC648P39yQ8MUT
8wkRnDjlDP2f53uy4/+QCOpD129rm3fAE/MKETz8eMDo+ZeFnsK/7XtBBJdi
30dvfz/IE/MLEZy5t1K85WOY55IMj9dx9/ivP6dP5MqxFp6YZ4hg0I6YsoEN
Hz2EZjW+WATteqQu8t+R64H5hgjWP39rOeLyHo/NP160HVIjgnuTimTNpPM8
MO8QwdVN90NrSvp6sOvotwgaO8uXblfx98D8QwzvbhUNOPhD3+NAl2VHR+mJ
oWjYuun5dZXumIeIITtcM140+ar7iZmD+JZeDO79X4f7r9vsjvmIGDK+GMyL
g0nuwtsz3l0M+pc7268p7eiOeYkYThuueFl9QOp+I9+w46RwMUxLvKszZ/cf
N8xPxFCatN3v3PEnbux67CSGzZZVC3YcOeKGeQr/9VTmlbi4L3J74nzp+Iw4
MVgN/n7+wN8BbpiviCHXJvGHu2WgWwl/280eIwaVUrOFm6cYuGHeIoYXPmEv
Rkx604L/lzZzZ4vhV9nnP3vcL7bA/EUMjqesN75rvaFF3d5W0SkrxKAWccb6
g1dCC8xjxOBjI2vW52DLFuy63iqGLSqP1G7us2qB+YwYdI5P3eM9VdFcqE6X
HhJDEhfRavCtm80xrxHD+u1t1w4P2dpcp/kd/pESQ15y+kDHUxObY34jhlSr
G+mikrbNjXvu4EtmMVw+/OeMcxeH5pjniEGi12FyVsZnV5s507qtLxbDhL2d
2/9clOOK+Y4Y5rtdvHFp+jZXVj7UiMFOfXWLu10nuWLeI4at54unDklt68oX
82c3/xYDGOpXqu60c8X8RwKb3HotnHnjo4v/3981W/Uk4Hl3v7a2100XzIMk
cDA6zifBerNLuNtjpx12EtiTqaVSvnSsC+ZDEkiRb3fxvwYuQvqT4S6B5okJ
tv+lmLlgXiSBccf/bL+0+K0zK2fCJTB8fuXwmjvnnDE/ksBee2erdy1XOQtv
x/5OEjj/Lc25YfIgZ8yTJJBUe/KNbR8/54FFQoIjAQ07uXRAKw1nzJcksDb9
mf1VjyLZCFUhUZBAasjf3zL9/TLMmyTwecT6txMLZ8rGewgdrgRKHqhkccmd
ZJg/SWBrM+fKdj/sZTOE8mqFBHr1yzZcEV4nxTyK/3xi0pd8jrginZcidAAS
cPCW7TP8ukaK+ZQE/M/kXnX2HCTlvxm+IuX/vr4r96YG+kgxr5JAaWtv0QhT
Falwm1y5IIEdb2aV+i3Nl2B+xf97Le5z/ebtki3qpvyNLYG7boktgwckSjDP
ksAy56K3q0vCJbuFcq9YAll6H1Ztk+lKMN+SwBqv4s+D5M/Eh/pdvXanRgIT
vFM/XQ3eK8a8i//8zvx4aOY4RSxUf/d+87/fotOrxzW2FGP+JYVZcu9jprlG
4otZ41rk60nBxChe59y5YhHmYVKoeTx2c+qrfSK+2OFLNCm8SnPbta3dFBHm
Y1I4HJv7+exfED0Qyk93KXSLeXFok52+CPMyKcSCpkP1+yInoVt7Fi4FmxN7
de+OznDC/EwKYZ1G+i1vkejEH378AS2FJ48WHCm4EuSEeZoUst4VS37OVHWq
WiwckFIIdP+1/u+4XEfM16TQ/ZaHrvXhDY4fjwsHlBSeT2z8uP5+f0fM26Tw
o+b9nPsXZI4/hXJ4thT6flMYn+1d64D5mxRKHh6V7ht2ykGVvaBSOOO/sVt1
0WwHzOOksMbYa2PG3lYOuuwFkcKhwNKXHxboOGA+J4XO3beddticb2/KHlAp
nJyj+VvzywZ7zOuksLTZ59LyQ33t7dgDIgX7Bw63ol462GN+JwXVpVM6Bxwu
s2Pl+T0pcB9vz5k9cY8d5nlS2D/iwuudViPtPNgHJIXBxlUKx8kt7DDfk8Lw
fb2a6fepsQ1k36AUXm+Lu1z932FbzPuksOpBdp9620TbSPYHpGAwa8MPixwP
W8z/ZLBu2Ozvs9NrbNoOKhuhpi+DbjbvZzsePmCDeaAMpk7wH7fJeqQNtgsy
sKl0htGmMhvMB2Ug84/dZ/Wo1LrPmTUPdDxkMNJrRu1P8VZrzAtlMEchXhej
EWPNvnyEDIZr6B6p8jOyxvxQBtLrs5JbSW5bCdWVUWcZ7LrulFKsSLbCPFEG
x+t3jgyX+1vxzSnfwstAxfODXDKxyhLzRRkEz/f7DT+3WLL2ZawMirfNvrU+
ONoS80YZ+H3bX5d2tMGCP2wfWifJwNU/uibQ/bAF5o8yiN9oM0OnpK8F+/FW
yqDNiWE3M7tpWGAeKYML6e1LPm84ap5aMZEvYWSgc39MZJ1ljDnmkzJYnuti
cn3xL7N0ww6JksP853fTv4dBu+1mmFfK4ICz04n5IZwZa6cuyqB2cp+Xp+pf
mmJ+KQOrPqrn21rMMBXSi+Z5Mmh58alF93ITU8wzZbBqhtbu6Ix9Juzjfcl/
vdbNV7gfCjfBfFMGWQuM9J4uzjO+cj4zwvsD//XGOoZdy+pnjHmnDPRWbPQp
/l5hlFOZNMHvD//9V6qdzR+RYIT5pzN8se/w64mk1pC1d/rOkLbvl39VRIIh
5qHO4Oy7tt7sdrkBX9w9C7F3Bs939x+MvtfLAPNRZ3g1tXpq4alr+uzX6+EM
i0ZLC1Lfu+pjXuoM1t8j5vxwXq5Xve45x0U4Q7LzYZukiVW6mJ86w9NV5y0i
i0FXOK1bdeb//NmpxWePrm+GeaozKDp/lTi9LtZh7WZ/Z4guyNRdMsFMB/NV
Z/i/fRahOmo/lox5K5k9XklkzF/JFqOFE5uMeSzZIVV4YsmYz5JZ+3uYjHkt
2ataSATJmN+S2eOdR8Y8lyx0G/EvyZjvktuPETp4Mua9ZNaO/yFj/uuidL9r
QodDxjyYzF4vezLmw+QxVlM7jPcgY15M5n+5/JFLxvyYzOKBzmTMk8lCmjej
PxnzZTJ7vceSMW8mb6zb33luEhnzZ/J2m3n8FU/GPJrM4op0MubT5KzxXu+W
HiZjXk1mx8tFMubX5Gu3XnZdk0fGPJssVCvrX5Ix3yaz+OQDGfNucjHfHWz+
Q8b821VpdrzpkzEPJ39IFypUMubj5K85wg1NxryczOKcCDLm52S++ed/Q2TM
08nseO1PxnydLHTfWWPJmLeT+eJ1+YkkMubvZBYvrSRjHk/2/XaXb9nJmM+T
2fF+mIx5PblVpxn9rlwkY35P7jit66rreWTM88ks7npJxnyfLKTbdz6QMe8n
s+vlDxnz/+ZKC59uvj4Z5wFkvlle+8iejNcTmcVvHmScF5CX7Pb98SyCjPMD
MrveOpNxnkDe/PN1/Ov+ZJwvkIVqvXwsGecNZBYHJpFx/kAWuuN3K8k4jyCz
6zWdjPMJMl8s8x05GecV5Hu/q/mOhIzzCzKLJ/PIOM8gl3QXbiQyzjfI7Hr/
QMZ5B1lIo/7+IeP8o4XS9Y+ERJ+M8xAyxqVknI+QdVoIiScZ5yVkVl5EknF+
Quab89FG0WScp5AlB3tsMx1AxvkKmcW3iWSct5DZtCeZjPMXMitvVpFxHkMW
ThenbWScz5Cj5y/eKTlCxnkNmd3ml8g4vyHzLwv/EZJxnkNm5VUJGec75PGe
FeO9a8k47yEL3apfAxnnP25Ks3jbgIzzILKQDoU6kHE+RGblnScZ50XkLRpW
k7lIMs6PyLu9hQSGjPMkMovbB5BxvkTmL2f+iiDjvInMystkMs6fyEI623UV
GedR5AdawhNIxvkUmcX/R8g4ryK/7l/AlyRknF+RWXl7n4zzLPLHE3NmxpeQ
cb5FFv72IbVknHeR2TiigYzzL3elhbd9tAEZ52FkU6G8diDjfIws3K7jPck4
LyPLWCBMxvkZmY1Hosk4TyMHskCUjPM1ciQLJMk4byO3ZYEgGedv5K4skCPj
PI7MxjXbyDifIw9igRQZ53Vk1l5cIuP8jjyRBTJknOeRZ7FAhIzzPTIbH9WS
cd5HXsECATLO/zyUZu2NARnngeR01hCTcT5IzmQNKRnnhWQ2zook4/yQfIY1
ZGScJ5JZezWAjPNFcg5rSMg4byQXsIaAjPNHMhuvrSLjPJJcxgpiMs4nyay9
O0LGeSX5MysIyTi/JP9mBRkZ55lkdVYQkXG+SdZnBQkZ551k1l42kHH+6am0
A7uQyTgPJbuwC5GM7SnZi11IZJyXkoPZhUDG+SmZtbfRZJynktuzA5GM81Vy
d3YgkXHeSu7HDgQyzl/JQ9gLScZ5LJm119vIOJ8lT2YPJBnnteQk9kCQcX5L
ZuPZ+2Sc55JXsQ+EjPNdMmvva8k47yVvZ/8HGee/XkrvYwNdMs6DyTguJuN8
mHyWDVzJOC8ms3hBTsb5MfkuG4iScZ5MfsQGnGScL5PZtzuOjPNmcsUkeYjN
HDLOn8ks3lhNxnk0mW+u+CuNjPNpMkvrj5JxXk1mH9dlMs6vycJ0rMUDMs6z
ySxeeUXG+TbZaaeIL6HIOO8mN7/3vcivkYzzb2+l2a/LkIzzcDL/w8pDHck4
HyezeMeLjPNycsfpQqJIxvk5uWeGkKiQcZ5OZo/LQDLO18nDfggVNRnn7WQW
L80h4/ydPLWLcKKScR5PFqqvHtvJOJ8ns8f1KBnn9WSh2+l3mYzzezKLtx6Q
cZ5P3ul88XD8KzLO98kHum3gPxIyzvvJ7HVpJOP830dpFtdok3EfgMx+nUZk
3A8gj2CBOxn3BcjVG4SEiYz7A+RxLBAn4z4B+YsQH3mTcb+AzB6vYDLuG5B/
vxc6FDLuH5DnsUCZjPsIZA0WEJNxP4HM4qw+ZNxXILPHPZ6M+wvkdSyQJeM+
A9mCBaxk3G8g/8cCUzLuO5BZvDaXjPsPZPb6LSHjPgTZhQWUZNyPIB9igSMZ
9yXI3ixAJOP+BJnFffvIuE9BDmEBHxn3K8gXWWBHxn0LMrAAjoz7F+SbLFAj
4z4GmcWP+WTczyCz4+kpGfc1yN1ZgEXG/Q1yEQukyLjPQY5lARMZ9zvILA79
TsZ9D/JQFgCRcf/DV+kqFuiQcR+EPIYFNGTcDyErWOBCxn0RMotnnci4P0Jm
x7crGfdJyEks4CDjfglZSHcmBpNx34S8iAUQZNw/IbO4uB0Z91HIq1lAQMb9
FLIpa/jJuK9C3sgaeDLur5BtWUNOxn0WMouvx5Nxv4XMrrfpZNx3Ie9jDTAZ
91/IHqyhJeM+DPkYa1DJuB9DZnH6JjLuy5DPsQaSjPsz5EjWEJJxn4Z8jTV4
ZNyvIbdhDRsZ923ILN6/Qsb9GzK7/nPIuI9DfsQaJDLu55D7sIaHjPs65GLW
wJBxf4fMxg1VZNznIb9hDQYZ93vIo1jDQMZ9H/IH1gCQcf/HT+mJrKAn4z4Q
mY0/jMi4H0Rm5ZEVGfeFyA2sgCbj/hA5hRXEZNwnImuJhAKXjPtFZDaOCSbj
vhGZlWscGfePyBtYQUnGfSSy1TThCSHjfhI5nRV8ZNxXIrPxUDwZ95fIrHwc
ScZ9JnLzvD+KrPFk3G8iHxn8btnx6WTcdyILyyQn55Jx/4nMxlVLyLgPRWbl
7Boy7keRL2dv/JS9iYz7UmThNDm3g4z7U+Sc8kS+pCXjPhWZjc+yyLhfRWbl
dTYZ963IfK3x5coVMu5fkYX0/1oOGfexyP0faLveyCfjfhaZjfOeknFfi8zK
/ddk3N8iC9O6nCoy7nOR+WZy9V0FGfe7yJ/P7eJbPDLue5HZePEvGfe//JVm
7Yc2GffByHNnCRUhGffDyOrGwo1Ixn0xMv8y8icCGdebyDjuJOM+GRnbITLu
l5HNWQNCxn0z8mbWAJBx/4zswApwMu6jkdn4tSsZ99PIrD3rQ8Z9NfJBVgCS
cX+N7MUKMDLus5FPsAKIjPttZDYOnk7GfTcyaxfnknH/jcyxC5iM+3DkG+wC
JON+HLk9u4DIuC9HZuPpHWTcnyOz9nUfGffpyIXsACTjfh25HzuAyLhvRy5h
BwAZ9+/IbFyeQ8Z9PDJrp/PJuJ9HTmAPIBn39ch1B4QHgIz7e+TJ7BdAxn0+
MhvfK8i430dm7f13Mu77kfGfAKX/BxQM1co=
       "]],
      FontFamily->"Helvetica",
      FontSize->12]}, {{}, {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  BaseStyle->{FontFamily -> "Helvetica", FontSize -> 12},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Directive[
    GrayLevel[0], 
    Thickness[0.002]],
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 20}, {0., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[152]=",ExpressionUUID->"ec814d2c-5339-454a-9813-542ee36c4af9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KT`system`solution`xui`t1", "[", "#", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "LAE`solutions"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", 
      RowBox[{"(", 
       RowBox[{"LAE`analyticSol", "/@", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ")"}]}], "]"}], "&"}], "/@",
    "%"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Length", "[", "#", "]"}], ",", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "/", 
       RowBox[{"Length", "[", "#", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"#", ",", "\[Infinity]"}], "]"}], "/", 
       RowBox[{"Length", "[", "#", "]"}]}]}], "}"}], "&"}], "/@", "%"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"%", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"%", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Log", "@", 
          RowBox[{"Ratios", "[", 
           RowBox[{"%", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]}], "/", 
        RowBox[{"Log", "@", 
         RowBox[{"Ratios", "[", 
          RowBox[{"%", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], ",", "0"}], 
      "]"}], ",", 
     RowBox[{"%", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Log", "@", 
          RowBox[{"Ratios", "[", 
           RowBox[{"%", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}]}], "/", 
        RowBox[{"Log", "@", 
         RowBox[{"Ratios", "[", 
          RowBox[{"%", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], ",", "0"}], 
      "]"}]}], "}"}], "\[Transpose]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", 
  RowBox[{"%", ",", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"None", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<N\>\"", ",", "\"\<\!\(\*SuperscriptBox[\(L\), \(1\)]\)-error\>\"",
         ",", "\"\<Rate\>\"", ",", 
        "\"\<\!\(\*SuperscriptBox[\(L\), \(\[Infinity]\)]\)-error\>\"", ",", 
        "\"\<Rate\>\""}], "}"}]}], "}"}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[153]:=",ExpressionUUID->"3b3adcbb-3882-45f9-91fb-a0e4186cb9a9"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"N\"\>",
       HoldForm], 
      TagBox["\<\"\\!\\(\\*SuperscriptBox[\\(L\\), \\(1\\)]\\)-error\"\>",
       HoldForm], 
      TagBox["\<\"Rate\"\>",
       HoldForm], 
      TagBox["\<\"\\!\\(\\*SuperscriptBox[\\(L\\), \
\\(\[Infinity]\\)]\\)-error\"\>",
       HoldForm], 
      TagBox["\<\"Rate\"\>",
       HoldForm]},
     {"40", "0.053441250387443656`", "0", "0.010863364436833068`", "0"},
     {"80", "0.038910977653095175`", "0.4577765345232597`", 
      "0.005551526266026285`", "0.9685146146866962`"},
     {"160", "0.02786285957959765`", "0.4818338989559935`", 
      "0.002874781621799475`", "0.9494320940302285`"},
     {"320", "0.019824273792685993`", "0.4910753123073136`", 
      "0.001474104487713094`", "0.963613578790658`"},
     {"640", "0.014061263825343001`", "0.49554174820308794`", 
      "0.0007500127740297108`", "0.9748517168500122`"},
     {"1280", "0.009958179259420875`", "0.49777237853298817`", 
      "0.00037958355441871055`", "0.9824976789584948`"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "Rows" -> {False, True, {False}, False}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {
     None, {"N", "\!\(\*SuperscriptBox[\(L\), \(1\)]\)-error", "Rate", 
       "\!\(\*SuperscriptBox[\(L\), \(\[Infinity]\)]\)-error", 
       "Rate"}}]]]], "Output",
 CellLabel->
  "Out[157]//TableForm=",ExpressionUUID->"fa121636-39eb-4ea2-b946-\
9006d49e7231"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KT`system`solution`\[CapitalDelta]x", "[", "#", "]"}], "&"}], "/@",
   "LAE`solutions"}]], "Input",
 CellLabel->
  "In[158]:=",ExpressionUUID->"52a68561-8f05-40da-8f73-a15a224c0c32"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.5128205128205128`", ",", "0.25316455696202533`", ",", 
   "0.12578616352201258`", ",", "0.06269592476489028`", ",", 
   "0.03129890453834116`", ",", "0.01563721657544957`"}], "}"}]], "Output",
 CellLabel->"Out[158]=",ExpressionUUID->"36c59434-63e8-4e91-acf5-12b2a26cb6b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KT`system`solution`xui`t1", "[", "#", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "LAE`solutions"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", 
      RowBox[{"(", 
       RowBox[{"LAE`analyticSol", "/@", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ")"}]}], "]"}], "&"}], "/@",
    "%"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"20", "/", 
       RowBox[{"Length", "[", "#", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "/", 
       RowBox[{"Length", "[", "#", "]"}]}]}], "}"}], "&"}], "/@", "%"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ListLogLogPlot"}], "\[IndentingNewLine]", 
 RowBox[{"NonlinearModelFit", "[", 
  RowBox[{"%%", ",", 
   RowBox[{"a", " ", 
    SuperscriptBox["\[CapitalDelta]x", "b"]}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", "\[CapitalDelta]x"}], 
  "]"}]}], "Input",
 CellLabel->
  "In[159]:=",ExpressionUUID->"8c987323-90d6-40c7-807c-9ed9dec48429"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], 
    PointBox[{{-0.6931471805599453, -2.9291723520588437`}, \
{-1.3862943611198906`, -3.246478866290144}, {-2.0794415416798357`, \
-3.580460674849696}, {-2.772588722239781, -3.9208481430181052`}, \
{-3.4657359027997265`, -4.264331508634822}, {-4.1588830833596715`, \
-4.60936102937558}}]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{-4.3047929716285855`, -4.740845328496545},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{
     Charting`ScaledTicks[{Log, Exp}], 
     Charting`ScaledFrameTicks[{Log, Exp}]}, {
     Charting`ScaledTicks[{Log, Exp}], 
     Charting`ScaledFrameTicks[{Log, Exp}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& )}},
  PlotRange->{{-4.3047929716285855`, -0.6931471805599453}, \
{-4.740845328496545, -2.9291723520588437`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->FrontEndValueCache[{
     Charting`ScaledTicks[{Log, Exp}], 
     Charting`ScaledTicks[{Log, Exp}]}, {{{-3.912023005428146, 
       FormBox[
        TagBox[
         InterpretationBox[
          StyleBox["\"0.02\"", ShowStringCharacters -> False], 0.02, 
          AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
       0.}}, {-2.995732273553991, 
       FormBox[
        TagBox[
         InterpretationBox[
          StyleBox["\"0.05\"", ShowStringCharacters -> False], 0.05, 
          AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
       0.}}, {-2.3025850929940455`, 
       FormBox[
        TagBox[
         InterpretationBox[
          StyleBox["\"0.10\"", ShowStringCharacters -> False], 0.1, 
          AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
       0.}}, {-1.6094379124341003`, 
       FormBox[
        TagBox[
         InterpretationBox[
          StyleBox["\"0.20\"", ShowStringCharacters -> False], 0.2, 
          AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
       0.}}, {-0.6931471805599453, 
       FormBox[
        TagBox[
         InterpretationBox[
          StyleBox["\"0.50\"", ShowStringCharacters -> False], 0.5, 
          AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
       0.}}, {-4.605170185988091, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-4.199705077879927, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.506557897319982, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.2188758248682006`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-2.8134107167600364`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-2.659260036932778, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-2.5257286443082556`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-2.4079456086518722`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-1.8971199848858813`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-1.2039728043259361`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-0.916290731874155, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-0.5108256237659907, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-0.35667494393873245`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-0.2231435513142097, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-0.10536051565782628`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {0., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}}, {{-4.605170185988091, 
       FormBox[
        TagBox[
         InterpretationBox[
          StyleBox["\"0.01\"", ShowStringCharacters -> False], 0.01, 
          AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
       0.}}, {-3.912023005428146, 
       FormBox[
        TagBox[
         InterpretationBox[
          StyleBox["\"0.02\"", ShowStringCharacters -> False], 0.02, 
          AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
       0.}}, {-3.506557897319982, 
       FormBox[
        TagBox[
         InterpretationBox[
          StyleBox["\"0.03\"", ShowStringCharacters -> False], 0.03, 
          AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
       0.}}, {-3.2188758248682006`, 
       FormBox[
        TagBox[
         InterpretationBox[
          StyleBox["\"0.04\"", ShowStringCharacters -> False], 0.04, 
          AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
       0.}}, {-2.995732273553991, 
       FormBox[
        TagBox[
         InterpretationBox[
          StyleBox["\"0.05\"", ShowStringCharacters -> False], 0.05, 
          AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
       0.}}, {-6.214608098422191, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-5.521460917862246, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-5.115995809754082, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-4.8283137373023015`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-4.422848629194137, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-4.268697949366879, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-4.135166556742356, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-4.017383521085972, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.816712825623821, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.7297014486341915`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.649658740960655, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.575550768806933, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.4420193761824103`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.3813947543659757`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.3242363405260273`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.270169119255751, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.170085660698769, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.123565645063876, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.079113882493042, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-3.036554268074246, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-2.9565115604007097`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-2.9187712324178627`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-2.8824035882469876`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-2.8473122684357177`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-2.8134107167600364`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}}}]]], "Output",
 CellLabel->
  "Out[162]=",ExpressionUUID->"c09c6623-70be-4ea1-9d4d-7812e7a7baad"],

Cell[BoxData[
 TagBox[
  RowBox[{"FittedModel", "[", 
   TagBox[
    PanelBox[
     TagBox[
      RowBox[{"0.07483138760282321`", " ", 
       SuperscriptBox["\[CapitalDelta]x", "0.4786315376857081`"]}],
      Short[#, 2]& ],
     FrameMargins->5],
    Editable -> False], "]"}],
  InterpretTemplate[
  FittedModel[{
    "Nonlinear", {$CellContext`a -> 0.07483138760282321, $CellContext`b -> 
      0.4786315376857081}, {{$CellContext`\[CapitalDelta]x}, $CellContext`a \
$CellContext`\[CapitalDelta]x^$CellContext`b}}, {1}, {{
      Rational[1, 2], 0.053441250387443656`}, {
      Rational[1, 4], 0.038910977653095175`}, {
      Rational[1, 8], 0.02786285957959765}, {
      Rational[1, 16], 0.019824273792685993`}, {
      Rational[1, 32], 0.014061263825343001`}, {
      Rational[1, 64], 0.009958179259420875}}, 
    Function[Null, 
     Internal`LocalizedBlock[{$CellContext`a, $CellContext`b, $CellContext`\
\[CapitalDelta]x}, #], {HoldAll}]]& ],
  Editable->False,
  SelectWithContents->True,
  Selectable->True]], "Output",
 CellLabel->"Out[163]=",ExpressionUUID->"55b1ff45-27fc-4e1c-bfa4-2942349d0cf5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Burgers\[CloseCurlyQuote] Equation: Pre- and Post-shock Solutions (BE) \
[KTO2-0, Example 3]\
\>", "NonEvaluatingSubsection",ExpressionUUID->"cfbbfb3c-78e0-45ba-ae37-\
e9f1d0aa6dd4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "t"], 
      RowBox[{"u", "[", 
       RowBox[{"t", ",", "x"}], "]"}]}], "+", 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"u", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "2"], "/", "2"}], ")"}]}]}], 
    "\[Equal]", "0"}], ";"}], " ", "[", 
  RowBox[{
   RowBox[{"KTO2", "-", "0"}], ",", 
   RowBox[{"eq", ".", " ", 
    RowBox[{"(", "6.5", ")"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"0", ",", "x"}], "]"}], "\[Equal]", 
    RowBox[{
     FractionBox["1", "2"], "+", 
     RowBox[{"Sin", "[", "x", "]"}]}]}], ";"}], " ", "[", 
  RowBox[{
   RowBox[{"KTO2", "-", "0"}], ",", 
   RowBox[{"eq", ".", " ", 
    RowBox[{"(", "6.6", ")"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"t", ",", "x"}], "]"}], "==", 
   RowBox[{
    FractionBox["1", "2"], "+", 
    RowBox[{"Sin", "[", 
     RowBox[{"x", "-", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"t", ",", "x"}], "]"}], " ", "t"}]}], "]"}]}]}], ",", " ", 
  RowBox[{
   RowBox[{"\[ForAll]", " ", 
    RowBox[{"0", "\[LessEqual]", "t", "<", 
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"Min", "[", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"0", ",", "x"}], "]"}], ",", "x"}], "]"}], "]"}]]}]}]}], 
   "=", 
   RowBox[{"1", " ", "[", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
       "Burgers"}], "%27", "_equation"}]}], 
    "]"}]}]}]}], \
"DisplayFormulaNumbered",ExpressionUUID->"9e67c23b-8706-4356-8300-\
5a371dd3d261"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BE`pde", "=", 
   RowBox[{"Sequence", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"#3", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "2"], "/", "2"}], "}"}], "&"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#3", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}], "&"}], ",", 
     RowBox[{
      RowBox[{"{", "0", "}"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BE`ics", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], "+", 
     RowBox[{"Sin", "[", "#", "]"}]}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BE`systems", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KT`system`generate", "[", "KT`O1", "]"}], "[", 
           RowBox[{"n", ",", "1"}], "]"}], "[", 
          RowBox[{"0.", ",", 
           RowBox[{"2.", "*", "\[Pi]"}]}], "]"}], "[", 
         RowBox[{"0.", ",", "2"}], "]"}], "[", 
        RowBox[{"BE`pde", ",", "BC`periodic"}], "]"}], "[", "BE`ics", "]"}], 
      "[", "None", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", 
       RowBox[{"{", 
        RowBox[{
        "40", ",", "80", ",", "160", ",", "320", ",", "640", ",", "1280"}], 
        "}"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[951]:=",ExpressionUUID->"7a888ed1-94e5-46e7-820d-d3047ba1631b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BE`solutions", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solve", "[", "s", "]"}], "[", "False", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "BE`systems"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[954]:=",ExpressionUUID->"93d9127d-32a6-4d61-8862-d301af7c4d03"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BE`solution`analytic", "[", 
   RowBox[{
    RowBox[{"t_", "/;", 
     RowBox[{"0", "<=", "t", "<", "1"}]}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"u", "/.", 
   RowBox[{
    RowBox[{"NSolve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], "+", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "-", 
          RowBox[{"u", " ", "t"}]}], "]"}]}], "\[Equal]", "u"}], ",", "u", 
      ",", "Reals"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellLabel->
  "In[190]:=",ExpressionUUID->"afb0d9b8-d78e-4bc7-9f6f-9216b0fb482b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KT`system`solution`xui`t", "[", 
      RowBox[{"#", ",", "0.5"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "BE`solutions"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"BE`solution`analytic", "[", 
         RowBox[{"0.5", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ")"}]}], "&"}], "/@", 
   "%"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Length", "[", "#", "]"}], ",", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "/", 
       RowBox[{"Length", "[", "#", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"#", ",", "\[Infinity]"}], "]"}], "/", 
       RowBox[{"Length", "[", "#", "]"}]}]}], "}"}], "&"}], "/@", "%"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"%", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"%", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Log", "@", 
          RowBox[{"Ratios", "[", 
           RowBox[{"%", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]}], "/", 
        RowBox[{"Log", "@", 
         RowBox[{"Ratios", "[", 
          RowBox[{"%", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], ",", "0"}], 
      "]"}], ",", 
     RowBox[{"%", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Log", "@", 
          RowBox[{"Ratios", "[", 
           RowBox[{"%", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}]}], "/", 
        RowBox[{"Log", "@", 
         RowBox[{"Ratios", "[", 
          RowBox[{"%", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], ",", "0"}], 
      "]"}]}], "}"}], "\[Transpose]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", 
  RowBox[{"%", ",", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"None", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<N\>\"", ",", "\"\<\!\(\*SuperscriptBox[\(L\), \(1\)]\)-error\>\"",
         ",", "\"\<Rate\>\"", ",", 
        "\"\<\!\(\*SuperscriptBox[\(L\), \(\[Infinity]\)]\)-error\>\"", ",", 
        "\"\<Rate\>\""}], "}"}]}], "}"}]}]}], "]"}]}], "Input",
 CellLabel->"In[955]:=",ExpressionUUID->"8196f229-1d3d-49d6-90a9-2e4426048320"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Burgers-Type Equation with Saturating Dissipation (BESD) [KTO2-0, Example 6, \
eq. (6.8)]\
\>", "NonEvaluatingSubsection",ExpressionUUID->"57b6a936-cd97-4ca6-adec-\
b3cc28ddbfcd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "t"], 
      RowBox[{"u", "[", 
       RowBox[{"t", ",", "x"}], "]"}]}], "+", 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      RowBox[{"(", 
       SuperscriptBox[
        RowBox[{"u", "[", 
         RowBox[{"t", ",", "x"}], "]"}], "2"], ")"}]}]}], "\[Equal]", 
    RowBox[{
     SubscriptBox["\[PartialD]", "x"], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "u"}], 
       SqrtBox[
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[PartialD]", "x"], "u"}], ")"}], "2"]}]]], 
      ")"}]}]}], ";"}], " ", "[", 
  RowBox[{
   RowBox[{"KTO2", "-", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"eq", ".", " ", 
      RowBox[{"(", "1.3", ")"}]}], " ", "with", " ", "f", 
     RowBox[{"(", "u", ")"}]}], "=", 
    SuperscriptBox["u", "2"]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"0", ",", "x"}], "]"}], "\[Equal]", 
    RowBox[{"Piecewise", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1.2", ",", 
         RowBox[{"X", "<", "0"}]}], "}"}], "}"}], ",", 
      RowBox[{"-", "1.2"}]}], "]"}]}], ";"}], " ", "[", 
  RowBox[{
   RowBox[{"KTO2", "-", "0"}], ",", 
   RowBox[{"eq", ".", " ", 
    RowBox[{"(", "6.8", ")"}]}]}], 
  "]"}]}], "DisplayFormulaNumbered",ExpressionUUID->"56aa24e3-9dd7-455c-887c-\
7a9c632f5e80"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BESD`pde", "=", 
   RowBox[{"Sequence", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#3", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "}"}], "&"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", 
        RowBox[{"#3", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "&"}], ",", 
     RowBox[{
      RowBox[{"{", 
       FractionBox[
        RowBox[{"#4", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"#4", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "2"]}]]], "}"}], "&"}]}], "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"BESD`ics", "=", 
   RowBox[{
    RowBox[{"Piecewise", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1.2", ",", 
         RowBox[{"#", "<", "0"}]}], "}"}], "}"}], ",", 
      RowBox[{"-", "1.2"}]}], "]"}], "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"BESD`system", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"KT`system`generate", "[", "KT`O1", "]"}], "[", 
         RowBox[{"400", ",", "1"}], "]"}], "[", 
        RowBox[{
         RowBox[{"-", "3."}], ",", 
         RowBox[{"+", "3."}]}], "]"}], "[", 
       RowBox[{"0.", ",", "1.5"}], "]"}], "[", 
      RowBox[{"BESD`pde", ",", "BC`linearExtrapolation"}], "]"}], "[", 
     "BESD`ics", "]"}], "[", "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[965]:=",ExpressionUUID->"d382a4c1-ccac-4c20-b4a0-a8b3565b9691"],

Cell[BoxData[
 RowBox[{"BESD`solution", "=", 
  RowBox[{
   RowBox[{"KT`system`solve", "[", 
    RowBox[{"BESD`system", ",", 
     RowBox[{"PrecisionGoal", "\[Rule]", "16"}]}], "]"}], "[", 
   "]"}]}]], "Input",
 CellLabel->
  "In[968]:=",ExpressionUUID->"6a493ec0-883f-4d7d-8fcb-01f046b375e2"],

Cell[BoxData[
 RowBox[{"KT`system`solution`xui`t`Manipulate", "[", 
  RowBox[{"BESD`solution", ",", 
   RowBox[{"Mesh", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellLabel->"In[969]:=",ExpressionUUID->"4822af62-03f3-423c-94b9-0c7a57c6f88e"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["O(N=1) Model in d=0", \
"Chapter",ExpressionUUID->"6220a04a-533a-45c0-8674-099e62863e91"],

Cell[CellGroupData[{

Cell["Exact solution", \
"Section",ExpressionUUID->"38fce45d-0bed-4645-abce-54f85538d3ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "G\[Phi]", "]"}], ";", 
  RowBox[{"Protect", "[", "\[Phi]2", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G\[Phi]", "[", 
   RowBox[{"m_", ",", 
    RowBox[{"n_", ":", "n"}]}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"EvenQ", "[", "m", "]"}], ",", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "!!"}], 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "i"}], "-", "2"}], ")"}]}], ")"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"m", "/", "2"}]}], "}"}]}], "]"}]}]], 
     RowBox[{"\[Phi]2", "[", 
      RowBox[{"m", "/", "2"}], "]"}]}], ",", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\[CapitalGamma]\[Phi]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]\[Phi]", "[", 
    RowBox[{"m_", ",", 
     RowBox[{"n_", ":", "n"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mastereq", ",", "eq", ",", "\[CapitalGamma]", ",", "\[Phi]", ",", "Z", 
       ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OddQ", "[", "m", "]"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"m", "\[Equal]", "2"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"1", "/", 
          RowBox[{"G\[Phi]", "[", 
           RowBox[{"2", ",", "n"}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"mastereq", "=", 
       RowBox[{
        RowBox[{"\[CapitalGamma]", "[", "\[Phi]", "]"}], "==", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalGamma]", "'"}], "[", "\[Phi]", "]"}], "\[Phi]"}],
          "-", 
         RowBox[{"Log", "[", 
          RowBox[{
           RowBox[{"Z", "[", 
            RowBox[{
             RowBox[{"\[CapitalGamma]", "'"}], "[", "\[Phi]", "]"}], "]"}], 
           "/", 
           RowBox[{"Z", "[", "0", "]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eq", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"mastereq", ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]", ",", "m"}], "}"}]}], "]"}], "//.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Derivative", "[", "i_", "]"}], "[", "Z", "]"}], "[", 
              RowBox[{
               SuperscriptBox["\[CapitalGamma]", "\[Prime]",
                MultilineFunction->None], "[", "\[Phi]", "]"}], "]"}], "/;", 
             RowBox[{"OddQ", "[", "i", "]"}]}], "\[RuleDelayed]", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Derivative", "[", "i_", "]"}], "[", "\[CapitalGamma]",
                "]"}], "[", "\[Phi]", "]"}], "/;", 
             RowBox[{"OddQ", "[", "i", "]"}]}], "\[RuleDelayed]", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Derivative", "[", "i_", "]"}], "[", "Z", "]"}], "[", 
              "0", "]"}], "/;", 
             RowBox[{"EvenQ", "[", "i", "]"}]}], "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"G\[Phi]", "[", 
              RowBox[{"i", ",", "n"}], "]"}], "*", 
             RowBox[{"Z", "[", "0", "]"}]}]}]}], "}"}]}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "i_", "]"}], "[", "\[CapitalGamma]", 
           "]"}], "[", "\[Phi]", "]"}], "\[Rule]", 
         RowBox[{"\[CapitalGamma]", "[", "i", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eq", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"\[CapitalGamma]", "[", "2", "]"}], "\[Rule]", 
           RowBox[{"1", "/", 
            RowBox[{"G\[Phi]", "[", 
             RowBox[{"2", ",", "n"}], "]"}]}]}]}], "/.", 
         RowBox[{
          RowBox[{"\[CapitalGamma]", "[", "i_", "]"}], "\[RuleDelayed]", 
          RowBox[{"\[CapitalGamma]\[Phi]", "[", 
           RowBox[{"i", ",", "n"}], "]"}]}]}], "//", "Expand"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\[CapitalGamma]m", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]m", "[", "\[Phi]2f_Function", "]"}], "[", 
   RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"symbolic", ",", "\[Phi]2i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OddQ", "[", "m", "]"}], ",", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"symbolic", "=", 
      RowBox[{"\[CapitalGamma]\[Phi]", "[", 
       RowBox[{"m", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]2i", "=", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Level", "[", 
           RowBox[{"symbolic", ",", "\[Infinity]", ",", 
            RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}], ",", 
          RowBox[{"\[Phi]2", "[", "_", "]"}]}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"\[Phi]2", "[", "i_", "]"}], "\[RuleDelayed]", "i"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[Phi]2i", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Phi]2", "[", "i", "]"}], "\[Rule]", 
         RowBox[{"\[Phi]2f", "[", 
          RowBox[{"i", ",", "n"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "\[Phi]2i"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"symbolic", "/.", "\[Phi]2i"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->
  "In[260]:=",ExpressionUUID->"00f75380-8fb5-4683-bbcc-0c2a24354599"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[Phi]2Analytic", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Analytic", "[", 
    RowBox[{"U\[CurlyPhi]_", ",", "pars___"}], "]"}], "[", "assumptions___", 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"int", ",", "m", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"int", "=", 
      FractionBox[
       RowBox[{
        SuperscriptBox["2", "m"], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Rho]", 
            FractionBox[
             RowBox[{"n", "-", "2"}], "2"]], 
           SuperscriptBox["\[Rho]", "m"], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"U\[CurlyPhi]", "[", 
              RowBox[{
               SqrtBox[
                RowBox[{"2", "\[Rho]"}]], ",", "pars"}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Rho]", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
          RowBox[{"Assumptions", "\[Rule]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", "assumptions", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"n", ">", "0"}], ",", 
                RowBox[{"m", ">", "0"}]}], "}"}]}], "]"}], "]"}]}]}], "]"}]}], 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Rho]", 
           FractionBox[
            RowBox[{"n", "-", "2"}], "2"]], 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"U\[CurlyPhi]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{"2", "\[Rho]"}]], ",", "pars"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Rho]", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"Assumptions", "\[Rule]", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "assumptions", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"n", ">", "0"}], ",", 
               RowBox[{"m", ">", "0"}]}], "}"}]}], "]"}], "]"}]}]}], "]"}]]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mi", ",", "ni"}], "}"}], "\[Function]", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"int", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"m", "\[Rule]", "mi"}], ",", 
           RowBox[{"n", "\[Rule]", "ni"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[266]:=",ExpressionUUID->"c3a137c4-e3d7-4390-ae5d-beb5c376bc9e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[Phi]2Numeric", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Numeric", "[", 
    RowBox[{"U\[CurlyPhi]_", ",", "pars___"}], "]"}], "[", 
   RowBox[{"opts_", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "}"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sopts", "=", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"Sequence", "@@", "opts"}], "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}], "\[Function]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["2", "m"], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Rho]", 
           FractionBox[
            RowBox[{"n", "-", "2"}], "2"]], 
          SuperscriptBox["\[Rho]", "m"], 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"U\[CurlyPhi]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{"2", "\[Rho]"}]], ",", "pars"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Rho]", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
         "sopts"}], "]"}]}], 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Rho]", 
          FractionBox[
           RowBox[{"n", "-", "2"}], "2"]], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"U\[CurlyPhi]", "[", 
            RowBox[{
             SqrtBox[
              RowBox[{"2", "\[Rho]"}]], ",", "pars"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Rho]", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
        "sopts"}], "]"}]]}]}], "]"}]}]}], "Input",
 CellLabel->
  "In[268]:=",ExpressionUUID->"583c4450-bac8-4d09-a972-2177a452f1ba"],

Cell[CellGroupData[{

Cell["Formulas", \
"NonEvaluatingSubsection",ExpressionUUID->"f346669a-e84d-413a-94bd-\
bae89926c8db"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]", "[", "m", "]"}], "->", 
    RowBox[{
     RowBox[{"\[CapitalGamma]m", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "]"}], "[", 
     RowBox[{"m", ",", "n"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "4", ",", "6"}], "}"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1", ",", 
    FractionBox["n", 
     RowBox[{"\[Phi]", "[", 
      RowBox[{"1", ",", "n"}], "]"}]], ",", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["n", "2"]}], 
     SuperscriptBox[
      RowBox[{"\[Phi]", "[", 
       RowBox[{"1", ",", "n"}], "]"}], "2"]], ",", 
    FractionBox[
     RowBox[{"60", " ", 
      SuperscriptBox["n", "3"]}], 
     SuperscriptBox[
      RowBox[{"\[Phi]", "[", 
       RowBox[{"1", ",", "n"}], "]"}], "3"]]}], "}"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], "/", "%"}], "//", 
  "Expand"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"%%%", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "%%", ",", "%"}], "}"}],
     "\[Transpose]"}], "//.", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"m_", ",", "n_"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<<\>\"", ",", 
       SuperscriptBox[
        RowBox[{"(", 
         SuperscriptBox["\[Phi]", "2"], ")"}], "m"], ",", "\"\<>\>\""}], 
      "}"}], "]"}]}]}], "//", "TableForm"}]}], "Input",
 CellLabel->
  "In[381]:=",ExpressionUUID->"943ce892-e215-4a19-96f9-dff533091372"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[CapitalGamma]", "[", "2", "]"}], "\[Rule]", 
    FractionBox["n", 
     RowBox[{"\[Phi]", "[", 
      RowBox[{"1", ",", "n"}], "]"}]]}], ",", 
   RowBox[{
    RowBox[{"\[CapitalGamma]", "[", "4", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["n", "2"]}], 
      SuperscriptBox[
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "n"}], "]"}], "2"]], "-", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["n", "3"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "n"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", "n"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"\[Phi]", "[", 
         RowBox[{"1", ",", "n"}], "]"}], "4"]}]]}]}], ",", 
   RowBox[{
    RowBox[{"\[CapitalGamma]", "[", "6", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{"60", " ", 
       SuperscriptBox["n", "3"]}], 
      SuperscriptBox[
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "n"}], "]"}], "3"]], "-", 
     FractionBox[
      RowBox[{"135", " ", 
       SuperscriptBox["n", "4"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "n"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", "n"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"\[Phi]", "[", 
         RowBox[{"1", ",", "n"}], "]"}], "5"]}]], "+", 
     FractionBox[
      RowBox[{"90", " ", 
       SuperscriptBox["n", "5"], " ", 
       SuperscriptBox[
        RowBox[{"\[Phi]", "[", 
         RowBox[{"2", ",", "n"}], "]"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", "+", "n"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"\[Phi]", "[", 
         RowBox[{"1", ",", "n"}], "]"}], "7"]}]], "-", 
     FractionBox[
      RowBox[{"15", " ", 
       SuperscriptBox["n", "5"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "n"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", "n"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "n"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"\[Phi]", "[", 
         RowBox[{"1", ",", "n"}], "]"}], "6"]}]]}]}]}], "}"}]], "Output",
 CellLabel->
  "Out[381]=",ExpressionUUID->"e450b8f0-07d7-402b-a8ce-df84058d4f44"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", 
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"n", " ", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"2", ",", "n"}], "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", "n"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "n"}], "]"}], "2"]}]]}], ",", 
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"9", " ", "n", " ", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"2", ",", "n"}], "]"}]}], 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "n"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "n"}], "]"}], "2"]}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["n", "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "n"}], "]"}], "2"]}], 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "+", "n"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "n"}], "]"}], "4"]}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["n", "2"], " ", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"3", ",", "n"}], "]"}]}], 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "n"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"4", "+", "n"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "n"}], "]"}], "3"]}]]}]}], "}"}]], "Output",
 CellLabel->
  "Out[383]=",ExpressionUUID->"b1bbae9b-7391-4b30-bc21-0a0f3efe503c"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"\[CapitalGamma]", "[", "0", "]"}], "1", "0"},
    {
     RowBox[{"\[CapitalGamma]", "[", "2", "]"}], 
     FractionBox["n", 
      TemplateBox[{"\"<\"", 
        SuperscriptBox["\[Phi]", "2"], "\">\""},
       "RowDefault"]], "1"},
    {
     RowBox[{"\[CapitalGamma]", "[", "4", "]"}], 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["n", "2"]}], 
      SuperscriptBox[
       TemplateBox[{"\"<\"", 
         SuperscriptBox["\[Phi]", "2"], "\">\""},
        "RowDefault"], "2"]], 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"n", " ", 
        TemplateBox[{"\"<\"", 
          SuperscriptBox["\[Phi]", "4"], "\">\""},
         "RowDefault"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "n"}], ")"}], " ", 
        SuperscriptBox[
         TemplateBox[{"\"<\"", 
           SuperscriptBox["\[Phi]", "2"], "\">\""},
          "RowDefault"], "2"]}]]}]},
    {
     RowBox[{"\[CapitalGamma]", "[", "6", "]"}], 
     FractionBox[
      RowBox[{"60", " ", 
       SuperscriptBox["n", "3"]}], 
      SuperscriptBox[
       TemplateBox[{"\"<\"", 
         SuperscriptBox["\[Phi]", "2"], "\">\""},
        "RowDefault"], "3"]], 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"9", " ", "n", " ", 
        TemplateBox[{"\"<\"", 
          SuperscriptBox["\[Phi]", "4"], "\">\""},
         "RowDefault"]}], 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "n"}], ")"}], " ", 
        SuperscriptBox[
         TemplateBox[{"\"<\"", 
           SuperscriptBox["\[Phi]", "2"], "\">\""},
          "RowDefault"], "2"]}]], "+", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox["n", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"\"<\"", 
           SuperscriptBox["\[Phi]", "4"], "\">\""},
          "RowDefault"], "2"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"2", "+", "n"}], ")"}], "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"\"<\"", 
           SuperscriptBox["\[Phi]", "2"], "\">\""},
          "RowDefault"], "4"]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["n", "2"], " ", 
        TemplateBox[{"\"<\"", 
          SuperscriptBox["\[Phi]", "6"], "\">\""},
         "RowDefault"]}], 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"4", "+", "n"}], ")"}], " ", 
        SuperscriptBox[
         TemplateBox[{"\"<\"", 
           SuperscriptBox["\[Phi]", "2"], "\">\""},
          "RowDefault"], "3"]}]]}]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->
  "Out[384]//TableForm=",ExpressionUUID->"dc270c6a-3d99-4ec6-b90a-\
3de7a7bc1574"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Numerical derivatives", \
"Section",ExpressionUUID->"e6ee4dfa-9165-4802-99f3-48da478d8974"],

Cell[CellGroupData[{

Cell["Formulas", \
"NonEvaluatingSubsection",ExpressionUUID->"043d3f66-cd54-408c-8dfe-\
3601c35c1d67"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InterpolatingPolynomial", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[CapitalDelta]x", " ", "i"}], ",", 
         RowBox[{"u", "[", "i", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", "x"}], "]"}], "//",
    "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"%", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1"}], "}"}]}], "]"}], "/.", 
    RowBox[{"x", "\[Rule]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"u", "[", "j_", "]"}], "\[RuleDelayed]", 
    SubscriptBox["f", 
     RowBox[{"i", "+", "j"}]]}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"i", "\[Rule]", "0"}]}], "/.", 
    RowBox[{
     RowBox[{
      SubscriptBox["f", "i_"], "/;", 
      RowBox[{"i", "<", "0"}]}], "\[RuleDelayed]", 
     RowBox[{"-", 
      SubscriptBox["f", 
       RowBox[{"-", "i"}]]}]}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InterpolatingPolynomial", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[CapitalDelta]x", " ", "i"}], ",", 
         RowBox[{"u", "[", "i", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}], ",", "x"}], "]"}], "//",
    "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"%", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1"}], "}"}]}], "]"}], "/.", 
    RowBox[{"x", "\[Rule]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"u", "[", "j_", "]"}], "\[RuleDelayed]", 
    SubscriptBox["f", 
     RowBox[{"i", "+", "j"}]]}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{"i", "\[Rule]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{
     SubscriptBox["f", "i_"], "/;", 
     RowBox[{"i", "<", "0"}]}], "\[RuleDelayed]", 
    RowBox[{"-", 
     SubscriptBox["f", 
      RowBox[{"-", "i"}]]}]}]}], "//", 
  "Simplify"}]}], \
"Input",ExpressionUUID->"adc6631b-1088-4e78-a278-0e360304a097"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InterpolatingPolynomial", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[CapitalDelta]x", " ", "i"}], ",", 
         RowBox[{"u", "[", "i", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "]"}], ",", "x"}], "]"}], "//",
    "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"%", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1"}], "}"}]}], "]"}], "/.", 
    RowBox[{"x", "\[Rule]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"u", "[", "j_", "]"}], "\[RuleDelayed]", 
    SubscriptBox["f", 
     RowBox[{"i", "+", "j"}]]}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{"i", "\[Rule]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{
     SubscriptBox["f", "i_"], "/;", 
     RowBox[{"i", "<", "0"}]}], "\[RuleDelayed]", 
    RowBox[{"-", 
     SubscriptBox["f", 
      RowBox[{"-", "i"}]]}]}]}], "//", 
  "Simplify"}]}], \
"Input",ExpressionUUID->"964593b9-b8f2-4915-8e18-dfb99bfc8248"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InterpolatingPolynomial", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[CapitalDelta]x", " ", "i"}], ",", 
         RowBox[{"u", "[", "i", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}], ",", "x"}], "]"}], "//",
    "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"%", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "3"}], "}"}]}], "]"}], "/.", 
    RowBox[{"x", "\[Rule]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"u", "[", "j_", "]"}], "\[RuleDelayed]", 
    SubscriptBox["f", 
     RowBox[{"i", "+", "j"}]]}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"i", "\[Rule]", "0"}]}], "/.", 
    RowBox[{
     RowBox[{
      SubscriptBox["f", "i_"], "/;", 
      RowBox[{"i", "<", "0"}]}], "\[RuleDelayed]", 
     RowBox[{"-", 
      SubscriptBox["f", 
       RowBox[{"-", "i"}]]}]}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InterpolatingPolynomial", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[CapitalDelta]x", " ", "i"}], ",", 
         RowBox[{"u", "[", "i", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "]"}], ",", "x"}], "]"}], "//",
    "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"%", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "3"}], "}"}]}], "]"}], "/.", 
    RowBox[{"x", "\[Rule]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"u", "[", "j_", "]"}], "\[RuleDelayed]", 
    SubscriptBox["f", 
     RowBox[{"i", "+", "j"}]]}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{"i", "\[Rule]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{
     SubscriptBox["f", "i_"], "/;", 
     RowBox[{"i", "<", "0"}]}], "\[RuleDelayed]", 
    RowBox[{"-", 
     SubscriptBox["f", 
      RowBox[{"-", "i"}]]}]}]}], "//", "Simplify"}]}], "Input",
 CellLabel->
  "In[995]:=",ExpressionUUID->"bc03ade4-1850-472b-9c67-ba98668d18b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InterpolatingPolynomial", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[CapitalDelta]x", " ", "i"}], ",", 
         RowBox[{"u", "[", "i", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "]"}], ",", "x"}], "]"}], "//",
    "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"%", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "5"}], "}"}]}], "]"}], "/.", 
    RowBox[{"x", "\[Rule]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"u", "[", "j_", "]"}], "\[RuleDelayed]", 
    SubscriptBox["f", 
     RowBox[{"i", "+", "j"}]]}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{"i", "\[Rule]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{
     SubscriptBox["f", "i_"], "/;", 
     RowBox[{"i", "<", "0"}]}], "\[RuleDelayed]", 
    RowBox[{"-", 
     SubscriptBox["f", 
      RowBox[{"-", "i"}]]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InterpolatingPolynomial", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[CapitalDelta]x", " ", "i"}], ",", 
         RowBox[{"u", "[", "i", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}], ",", "x"}], "]"}], "//",
    "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"%", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "5"}], "}"}]}], "]"}], "/.", 
    RowBox[{"x", "\[Rule]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"u", "[", "j_", "]"}], "\[RuleDelayed]", 
    SubscriptBox["f", 
     RowBox[{"i", "+", "j"}]]}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"i", "\[Rule]", "0"}]}], "/.", 
  RowBox[{
   RowBox[{
    SubscriptBox["f", "i_"], "/;", 
    RowBox[{"i", "<", "0"}]}], "\[RuleDelayed]", 
   RowBox[{"-", 
    SubscriptBox["f", 
     RowBox[{"-", "i"}]]}]}]}]}], "Input",
 CellLabel->"In[977]:=",ExpressionUUID->"3ab1b077-da0e-4d13-99cb-7a549d116671"]
}, Closed]],

Cell[CellGroupData[{

Cell["Implementation", \
"Subsection",ExpressionUUID->"6f3fd08c-7691-4cca-908b-bdd6a74e0856"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalGamma]2O\[CapitalDelta]x2C", "[", "uxi_List", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[CapitalDelta]x", "=", 
       RowBox[{
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"f1", "=", 
       RowBox[{"uxi", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"f1", "/", "\[CapitalDelta]x"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalGamma]2O\[CapitalDelta]x4C", "[", "uxi_List", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[CapitalDelta]x", "=", 
       RowBox[{
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"f1", "=", 
       RowBox[{"uxi", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"f2", "=", 
       RowBox[{"uxi", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "8"}], "f1"}], "+", "f2"}], ")"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"6", "\[CapitalDelta]x"}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]2O\[CapitalDelta]x6C", "[", "uxi_List", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{
         RowBox[{"uxi", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
         RowBox[{"uxi", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", 
       RowBox[{"f1", "=", 
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"f2", "=", 
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"f3", "=", 
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"45", "f1"}], "-", 
        RowBox[{"9", "f2"}], "+", "f3"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"30", "\[CapitalDelta]x"}], ")"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalGamma]4O\[CapitalDelta]x2C", "[", "uxi_List", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[CapitalDelta]x", "=", 
       RowBox[{
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"f1", "=", 
       RowBox[{"uxi", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"f2", "=", 
       RowBox[{"uxi", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "f1"}], "+", "f2"}], ")"}], "/", 
     RowBox[{"(", 
      SuperscriptBox["\[CapitalDelta]x", "3"], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]4O\[CapitalDelta]x4C", "[", "uxi_List", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{
         RowBox[{"uxi", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
         RowBox[{"uxi", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", 
       RowBox[{"f1", "=", 
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"f2", "=", 
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"f3", "=", 
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"13", "f1"}], "-", 
         RowBox[{"8", "f2"}], "+", "f3"}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"4", 
        SuperscriptBox["\[CapitalDelta]x", "3"]}], ")"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalGamma]6O\[CapitalDelta]x2C", "[", "uxi_List", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[CapitalDelta]x", "=", 
       RowBox[{
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"f1", "=", 
       RowBox[{"uxi", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"f2", "=", 
       RowBox[{"uxi", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"f3", "=", 
       RowBox[{"uxi", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"10", "f1"}], "-", 
       RowBox[{"8", "f2"}], "+", 
       RowBox[{"2", "f3"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", 
       SuperscriptBox["\[CapitalDelta]x", "5"]}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalGamma]6O\[CapitalDelta]x4C", "[", "uxi_List", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[CapitalDelta]x", "=", 
       RowBox[{
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"uxi", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"f1", "=", 
       RowBox[{"uxi", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"f2", "=", 
       RowBox[{"uxi", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"f3", "=", 
       RowBox[{"uxi", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"f4", "=", 
       RowBox[{"uxi", "[", 
        RowBox[{"[", 
         RowBox[{"5", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"58", "f1"}], "-", 
       RowBox[{"52", "f2"}], "+", 
       RowBox[{"18", "f3"}], "-", "2"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"6", 
       SuperscriptBox["\[CapitalDelta]x", "5"]}], ")"}]}]}], 
   "]"}]}]}], "Input",
 CellLabel->
  "In[270]:=",ExpressionUUID->"a798fab6-945e-493a-832f-0652c8ed2e9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\[CapitalGamma]n", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]n", "[", "\[CapitalGamma]_", "]"}], "[", 
   RowBox[{
    RowBox[{"sol_", "/;", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"sol", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"KT`system`solution", "[", "___", "]"}], "[", "___", "]"}], 
        "[", "___", "]"}]}], "]"}]}], ",", 
    RowBox[{"t_", ":", "\"\<IR\>\""}]}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"t", "===", "\"\<IR\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{"\[CapitalGamma]", "[", 
     RowBox[{
      RowBox[{"KT`system`solution`xui`t1", "[", "sol", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\[CapitalGamma]", "[", 
     RowBox[{
      RowBox[{"KT`system`solution`xui`t", "[", 
       RowBox[{"sol", ",", "t"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[277]:=",ExpressionUUID->"87794fd3-3efa-46e6-acfa-47b77172a070"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["ICs", "Section",ExpressionUUID->"a393e76a-f52e-4003-95be-7c6b2deab7b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PiecewiseMonomial", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PiecewiseMonomial", "[", 
   RowBox[{"a_", ",", "c_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", ",", "f", ",", "y", ",", "df"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", "=", 
      RowBox[{"Length", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "i_", "]"}], "[", "x_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"a", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
         RowBox[{"n", "[", 
          RowBox[{"[", "i", "]"}], "]"}]]}], "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", ">", "1"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"i", "-", "1"}], "]"}], "[", 
           RowBox[{"a", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"a", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
            RowBox[{"n", "[", 
             RowBox[{"[", "i", "]"}], "]"}]]}]}], ",", "0"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"df", "[", "i_", "]"}], "[", "x_", "]"}], ":=", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "i", "]"}], "[", "y", "]"}], ",", "y"}], "]"}], "/.", 
       RowBox[{"y", "\[Rule]", "x"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"Piecewise", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"df", "[", "i", "]"}], "[", 
                RowBox[{"Slot", "[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", 
                RowBox[{"Slot", "[", "1", "]"}], "<", 
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"l", "-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"df", "[", "l", "]"}], "[", 
            RowBox[{"Slot", "[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Function", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"Piecewise", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"f", "[", "i", "]"}], "[", 
                RowBox[{"Slot", "[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", 
                RowBox[{"Slot", "[", "1", "]"}], "<", 
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"l", "-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"f", "[", "l", "]"}], "[", 
            RowBox[{"Slot", "[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[279]:=",ExpressionUUID->"91431c35-f672-43ea-8165-336e7fac761d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PiecewiseMonomialAnti", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PiecewiseMonomialAnti", "[", 
   RowBox[{"a_", ",", "c_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", ",", "f", ",", "y", ",", "df", ",", "fi", ",", "Fi"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", "=", 
      RowBox[{"Length", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "i_", "]"}], "[", "x_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"a", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
         RowBox[{"n", "[", 
          RowBox[{"[", "i", "]"}], "]"}]]}], "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", ">", "1"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"i", "-", "1"}], "]"}], "[", 
           RowBox[{"a", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"a", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
            RowBox[{"n", "[", 
             RowBox[{"[", "i", "]"}], "]"}]]}]}], ",", "0"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"df", "[", "i_", "]"}], "[", "x_", "]"}], ":=", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "i", "]"}], "[", "y", "]"}], ",", "y"}], "]"}], "/.", 
       RowBox[{"y", "\[Rule]", "x"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fi", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"df", "[", "i", "]"}], "[", 
           RowBox[{"Slot", "[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"Slot", "[", "1", "]"}], "<", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"l", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fi", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"fi", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "/.", 
            RowBox[{
             RowBox[{"Slot", "[", "1", "]"}], "\[Rule]", 
             RowBox[{"Abs", "[", 
              RowBox[{"Slot", "[", "1", "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"fi", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], "\[LessEqual]", 
            RowBox[{"Slot", "[", "1", "]"}], "<", "0"}]}], "}"}], "}"}], ",", 
        "fi"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Fi", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", "i", "]"}], "[", 
           RowBox[{"Slot", "[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"Slot", "[", "1", "]"}], "<", 
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"l", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fi", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Fi", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"Slot", "[", "1", "]"}], "\[Rule]", 
             RowBox[{"Abs", "[", 
              RowBox[{"Slot", "[", "1", "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Fi", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], "\[LessEqual]", 
            RowBox[{"Slot", "[", "1", "]"}], "<", "0"}]}], "}"}], "}"}], ",", 
        "Fi"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{"Piecewise", "[", 
           RowBox[{"fi", ",", 
            RowBox[{
             RowBox[{"df", "[", "l", "]"}], "[", 
             RowBox[{"Slot", "[", "1", "]"}], "]"}]}], "]"}], "//", 
          "Simplify"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Function", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{"Piecewise", "[", 
           RowBox[{"Fi", ",", 
            RowBox[{
             RowBox[{"f", "[", "l", "]"}], "[", 
             RowBox[{"Slot", "[", "1", "]"}], "]"}]}], "]"}], "//", 
          "Simplify"}], "]"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->
  "In[281]:=",ExpressionUUID->"5dfa80a0-fe57-4867-9285-8f3ca69590a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PiecewisePolynomial", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PiecewisePolynomial", "[", 
   RowBox[{"a_", ",", "c_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", ",", "f", ",", "y", ",", "df"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", "=", 
      RowBox[{"Length", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "i_", "]"}], "[", "x_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"a", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
         RowBox[{"n", "[", 
          RowBox[{"[", "i", "]"}], "]"}]]}], "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", ">", "1"}], ",", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"i", "-", "1"}], "]"}], "[", 
          RowBox[{"a", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "0"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"df", "[", "i_", "]"}], "[", "x_", "]"}], ":=", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "i", "]"}], "[", "y", "]"}], ",", "y"}], "]"}], "/.", 
       RowBox[{"y", "\[Rule]", "x"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"Piecewise", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"df", "[", "i", "]"}], "[", 
                RowBox[{"Slot", "[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", 
                RowBox[{"Slot", "[", "1", "]"}], "<", 
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"l", "-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"df", "[", "l", "]"}], "[", 
            RowBox[{"Slot", "[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Function", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"Piecewise", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"f", "[", "i", "]"}], "[", 
                RowBox[{"Slot", "[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", 
                RowBox[{"Slot", "[", "1", "]"}], "<", 
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"l", "-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"f", "[", "l", "]"}], "[", 
            RowBox[{"Slot", "[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[283]:=",ExpressionUUID->"44499f15-619f-47ac-8166-20a34983e178"],

Cell[CellGroupData[{

Cell["Scenario 1", \
"Subsection",ExpressionUUID->"50092d83-33c7-4d6c-8bc9-1fe90661c867"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ICS1", "=", 
   RowBox[{"PiecewiseMonomialAnti", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], ",", 
       RowBox[{"-", "2"}], ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[285]:=",ExpressionUUID->"80002497-955c-491f-a157-b973029383da"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scenario 2", \
"Subsection",ExpressionUUID->"592a2161-5c47-446a-b1ce-3672d8c3f312"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ICS2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "#"}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"3", "!"}]], 
        SuperscriptBox["#", "3"]}]}], "&"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], 
        SuperscriptBox["#", "2"]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"4", "!"}]], 
        SuperscriptBox["#", "4"]}]}], "&"}]}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[286]:=",ExpressionUUID->"2735fc24-e788-44fb-bde5-f2d4b711c16c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ICS2plus", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"3", "!"}]], 
        SuperscriptBox["#", "3"]}]}], "&"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        SuperscriptBox["#", "2"]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"4", "!"}]], 
        SuperscriptBox["#", "4"]}]}], "&"}]}], "}"}]}], ";"}]], "Input",
 CellLabel->"In[287]:=",ExpressionUUID->"a3fcfb09-a123-416c-b2f6-537f026501b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scenario 3", \
"Subsection",ExpressionUUID->"88283085-efd7-4efe-ad8b-b196d6cfd223"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ICS3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "-", 
       RowBox[{
        FractionBox["4", "20"], 
        SuperscriptBox["#", "3"]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"5", "!"}]], 
        SuperscriptBox["#", "5"]}]}], "&"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        SuperscriptBox["#", "2"]}], "-", 
       RowBox[{
        FractionBox["1", "20"], 
        SuperscriptBox["#", "4"]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"6", "!"}]], 
        SuperscriptBox["#", "6"]}]}], "&"}]}], "}"}]}], ";"}]], "Input",
 CellLabel->"In[288]:=",ExpressionUUID->"eb37d1c3-fba4-4d67-b7ae-5265cc698c4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scenario 4", \
"Subsection",ExpressionUUID->"215cbf45-1c6b-4e60-8bd7-1b6a94ab9de9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ICS4", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Piecewise", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], 
            FractionBox["#", 
             RowBox[{"3", 
              SuperscriptBox[
               RowBox[{"(", 
                SuperscriptBox["#", "2"], ")"}], 
               RowBox[{"2", "/", "3"}]]}]]}], ",", 
           RowBox[{"#", "\[LessEqual]", 
            SqrtBox["8"]}]}], "}"}], "}"}], ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{"Piecewise", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              SuperscriptBox["#", "2"], ")"}], 
             RowBox[{"1", "/", "3"}]]}], ",", 
           RowBox[{"#", "\[LessEqual]", 
            SqrtBox["8"]}]}], "}"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          SuperscriptBox["#", "2"]}], "-", "6"}]}], "]"}], "&"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->"In[289]:=",ExpressionUUID->"32c2a92d-182d-44fd-a23e-5749ef5b0d6e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["FRG", "Section",ExpressionUUID->"c8a66bf0-809d-4a79-bfd1-af51febe5220"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{"u", "[", 
      RowBox[{"t", ",", "\[Sigma]"}], "]"}]}], "-", 
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Sigma]"], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[PartialD]", "t"], 
         RowBox[{
          SubscriptBox["r", "b"], "[", "t", "]"}]}], ")"}], 
       FractionBox[
        RowBox[{"n", "-", "1"}], 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "b"], "[", "t", "]"}], "+", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"t", ",", "\[Sigma]"}], "]"}], "/", "\[Sigma]"}]}]]}], 
      ")"}]}], "-", 
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Sigma]"], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[PartialD]", "t"], 
         RowBox[{
          SubscriptBox["r", "b"], "[", "t", "]"}]}], ")"}], 
       FractionBox["1", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "b"], "[", "t", "]"}], "+", 
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Sigma]"], 
          RowBox[{"u", "[", 
           RowBox[{"t", ",", "\[Sigma]"}], "]"}]}]}]]}], ")"}]}]}], "=", 
   "0"}], ",", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{"u", "[", 
      RowBox[{"t", ",", "\[Sigma]"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Sigma]"], 
     RowBox[{"F", "[", 
      RowBox[{"t", ",", "\[Sigma]", ",", "u"}], "]"}]}]}], "=", 
   RowBox[{
    SubscriptBox["\[PartialD]", "\[Sigma]"], 
    RowBox[{"Q", "[", 
     RowBox[{"t", ",", "\[Sigma]", ",", "u", ",", 
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Sigma]"], "u"}]}], "]"}]}]}], ",", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"t", ",", "\[Sigma]", ",", "u"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[PartialD]", "t"], 
       RowBox[{
        SubscriptBox["r", "b"], "[", "t", "]"}]}], ")"}], 
     FractionBox[
      RowBox[{"n", "-", "1"}], 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "b"], "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"t", ",", "\[Sigma]"}], "]"}], "/", "\[Sigma]"}]}]]}], "=", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], 
     FractionBox[
      RowBox[{
       SubscriptBox["r", "b"], "[", "t", "]"}], 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "b"], "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"t", ",", "\[Sigma]"}], "]"}], "/", "\[Sigma]"}]}]]}]}]}], 
  ",", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox[
    RowBox[{"\[PartialD]", 
     RowBox[{"F", "[", 
      RowBox[{"t", ",", "\[Sigma]", ",", "u"}], "]"}]}], 
    RowBox[{"\[PartialD]", "u"}]], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"+", 
      FractionBox["1", "2"]}], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[PartialD]", "t"], 
       RowBox[{
        SubscriptBox["r", "b"], "[", "t", "]"}]}], ")"}], 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "\[Sigma]"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["r", "b"], "[", "t", "]"}], "\[Sigma]"}], "+", 
         RowBox[{"u", "[", 
          RowBox[{"t", ",", "\[Sigma]"}], "]"}]}], ")"}], "2"]]}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], 
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], 
     FractionBox[
      RowBox[{
       RowBox[{
        SubscriptBox["r", "b"], "[", "t", "]"}], "\[Sigma]"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["r", "b"], "[", "t", "]"}], "\[Sigma]"}], "+", 
         RowBox[{"u", "[", 
          RowBox[{"t", ",", "\[Sigma]"}], "]"}]}], ")"}], "2"]]}]}]}], ",", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Q", "[", 
    RowBox[{"t", ",", "\[Sigma]", ",", "u", ",", 
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Sigma]"], "u"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{"Q", "[", 
     RowBox[{"t", ",", 
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Sigma]"], "u"}]}], "]"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[PartialD]", "t"], 
        RowBox[{
         SubscriptBox["r", "b"], "[", "t", "]"}]}], ")"}], 
      FractionBox["1", 
       RowBox[{
        RowBox[{
         SubscriptBox["r", "b"], "[", "t", "]"}], "+", 
        RowBox[{
         SubscriptBox["\[PartialD]", "\[Sigma]"], 
         RowBox[{"u", "[", 
          RowBox[{"t", ",", "\[Sigma]"}], "]"}]}]}]]}], "=", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      FractionBox[
       RowBox[{
        SubscriptBox["r", "b"], "[", "t", "]"}], 
       RowBox[{
        RowBox[{
         SubscriptBox["r", "b"], "[", "t", "]"}], "+", 
        RowBox[{
         SubscriptBox["\[PartialD]", "\[Sigma]"], 
         RowBox[{"u", "[", 
          RowBox[{"t", ",", "\[Sigma]"}], "]"}]}]}]]}]}]}]}], ",", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"where", " ", 
    RowBox[{
     SubscriptBox["r", "b"], "[", "t", "]"}]}], "=", 
   RowBox[{
    RowBox[{"\[CapitalLambda]", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", "t"}], "]"}], " ", "and", "  ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "t"], 
      RowBox[{
       SubscriptBox["r", "b"], "[", "t", "]"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[CapitalLambda]"}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "t"}], "]"}]}], "=", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "b"], "[", "t", "]"}], 
       "."}]}]}]}]}]}]], \
"DisplayFormulaNumbered",ExpressionUUID->"e52e3155-36c9-4e58-976f-\
64fae4ec82d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ON0d`PDE`F", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "x", ",", "u", ",", "pars"}], "}"}], "\[Function]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n\[Pi]", "=", 
         RowBox[{
          RowBox[{"pars", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ",", 
        RowBox[{"rb", "=", 
         RowBox[{
          RowBox[{"pars", "[", 
           RowBox[{"[", "2", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"-", "t"}], "]"}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.5", "n\[Pi]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rb", " ", "x"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rb", " ", "x"}], "+", 
            RowBox[{"u", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ")"}]}], "}"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ON0d`PDE`dFdx", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "x", ",", "u", ",", "pars"}], "}"}], "\[Function]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n\[Pi]", "=", 
         RowBox[{
          RowBox[{"pars", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ",", 
        RowBox[{"rb", "=", 
         RowBox[{
          RowBox[{"pars", "[", 
           RowBox[{"[", "2", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"-", "t"}], "]"}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], "n\[Pi]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rb", " ", "x"}], ")"}], "/", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rb", " ", "x"}], "+", 
             RowBox[{"u", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "2"]}], ")"}]}], 
       "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ON0d`PDE`Q", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "x", ",", "u", ",", "dudx", ",", "pars"}], "}"}], 
    "\[Function]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rb", "=", 
        RowBox[{
         RowBox[{"pars", "[", 
          RowBox[{"[", "2", "]"}], "]"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", "t"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], 
        RowBox[{"(", 
         RowBox[{"rb", "/", 
          RowBox[{"(", 
           RowBox[{"rb", "+", 
            RowBox[{"dudx", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ")"}]}], "}"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ON0d`PDE", "=", 
   RowBox[{"Sequence", "[", 
    RowBox[{"ON0d`PDE`F", ",", "ON0d`PDE`dFdx", ",", "ON0d`PDE`Q"}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->
  "In[290]:=",ExpressionUUID->"2b37aa9b-152d-4eea-8010-07c2233674e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ON0d`PDE`BC", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "vin", "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", "=", "vin"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "5"}], "]"}], "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], " ", "=", " ", 
          RowBox[{"-", 
           SubscriptBox["u", "2"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "4"}], "]"}], "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", "=", " ", 
          RowBox[{"-", 
           SubscriptBox["u", "1"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], "=", 
         RowBox[{"0", "*", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", "0"], " ", "=", " ", "0"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "3"}]}], "]"}], "]"}]}], "-", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"-", "4"}]}], "]"}], "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", "n"], " ", "=", " ", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["u", 
             RowBox[{"n", "-", "1"}]]}], " ", "-", " ", 
           RowBox[{
            SubscriptBox["u", 
             RowBox[{"n", "-", "2"}]], " ", "[", 
            RowBox[{"linear", " ", "extrapolation"}], "]"}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "3"}]}], "]"}], "]"}]}], "-", 
          RowBox[{"2", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "4"}]}], "]"}], "]"}]}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"n", "+", "1", " "}]], "=", " ", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["u", 
             RowBox[{"n", "-", "1"}]]}], " ", "-", " ", 
           RowBox[{"2", 
            RowBox[{
             SubscriptBox["u", 
              RowBox[{"n", "-", "2"}]], " ", "[", 
             RowBox[{"linear", " ", "extrapolation"}], "]"}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", "v"}]}], "\[IndentingNewLine]", "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[294]:=",ExpressionUUID->"957e3395-ebb7-4442-a424-e1f8a37c0e56"],

Cell[CellGroupData[{

Cell["Entropy functionals", \
"Subsection",ExpressionUUID->"9aa50fad-3ec7-4f77-817b-69e81ad428fb"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"i", "=", "0"}], 
    RowBox[{"n", "-", "1"}]], 
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["u", 
        RowBox[{"i", "+", "1"}]], "-", 
       SubscriptBox["u", 
        RowBox[{"i", "-", "1"}]]}], ")"}], "2"], 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubscriptBox["\[Delta]", 
        RowBox[{"i", ",", "0"}]], "+", 
       SubscriptBox["\[Delta]", 
        RowBox[{"i", ",", 
         RowBox[{"n", "-", "1"}]}]]}], ")"}], 
     "\[CapitalDelta]x"}]]}]}]], \
"DisplayFormulaNumbered",ExpressionUUID->"524570e9-3925-4f23-8f12-\
118a04cc8b40"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CFunctional", "[", 
    RowBox[{"y_", ":", 
     RowBox[{"(", 
      RowBox[{"y", "\[Function]", 
       SuperscriptBox["y", "2"]}], ")"}]}], "]"}], "[", 
   RowBox[{"sol_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[CapitalDelta]x", ",", "n", ",", "uiPadded", ",", "duidxCentral"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalDelta]x", "=", 
      RowBox[{"KT`system`solution`\[CapitalDelta]x", "[", "sol", "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"KT`system`solution`nx", "[", "sol", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"uiPadded", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ArrayPad", "[", 
           RowBox[{
            RowBox[{"KT`system`solution`ui`t", "[", 
             RowBox[{"sol", ",", "t"}], "]"}], ",", "2"}], "]"}], "}"}], "//",
          "ON0d`PDE`BC"}], "//", "Flatten"}], "//", 
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"duidxCentral", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"3", ";;"}], "]"}], "]"}], "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"-", "3"}]}], "]"}], "]"}]}], "&"}], "@", "uiPadded"}],
          ")"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "\[CapitalDelta]x"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", "#", "]"}], "&"}], "/@", "duidxCentral"}], ")"}],
         "*", 
        RowBox[{"ArrayPad", "[", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", 
            RowBox[{"n", "-", "2"}]}], "]"}], ",", "1", ",", 
          RowBox[{"1", "/", "2"}]}], "]"}], "*", "\[CapitalDelta]x"}], ")"}], 
      "//", "Total"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[295]:=",ExpressionUUID->"34048a48-877b-4d1e-8a61-0742d2da3c63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CFunctionalExplicit", "[", 
   RowBox[{"sol_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "\[CapitalDelta]x", ",", "ui", ",", "ui0"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"KT`system`solution`nx", "[", "sol", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]x", "=", 
      RowBox[{"KT`system`solution`\[CapitalDelta]x", "[", "sol", "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"ui", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ArrayPad", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"KT`system`solution`xui`t", "[", 
              RowBox[{"sol", ",", "t"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
         "}"}], "//", "ON0d`PDE`BC"}], "//", "First"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ui0", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ArrayPad", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"KT`system`solution`xui`t0", "[", "sol", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
         "}"}], "//", "ON0d`PDE`BC"}], "//", "First"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", "\[CapitalDelta]x"}]]}], 
      RowBox[{"Sum", "[", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ui", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1", "+", "3"}], "]"}], "]"}], "-", 
             RowBox[{"ui", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "1", "+", "3"}], "]"}], "]"}]}], ")"}], "2"],
           "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ui0", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1", "+", "3"}], "]"}], "]"}], "-", 
             RowBox[{"ui0", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "1", "+", "3"}], "]"}], "]"}]}], ")"}], 
           "2"]}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"i", ",", "0"}], "]"}], "+", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"i", ",", 
             RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[296]:=",ExpressionUUID->"ebb5db3a-90ed-400d-a5ab-14b37974ad1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{"1", 
     RowBox[{"(*", "n", "*)"}], ",", 
     RowBox[{"1.", "*", 
      SuperscriptBox["10", "6"]}]}], 
    RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"systems", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "n", "]"}],
           "[", 
          RowBox[{"0", ",", "10."}], "]"}], "[", 
         RowBox[{"0.", ",", "60."}], "]"}], "[", 
        RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "params"}], "]"}], "[", 
       "ICS1", "]"}], "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "400", ",", "800", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sols1even", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"KT`system`solve", "[", 
      RowBox[{"s", ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
     RowBox[{"True", ",", "True", ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "60", ",", 
        RowBox[{"1", "/", "4"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "systems"}], "}"}]}], "]"}]}]}], "Input",
 CellLabel->
  "In[218]:=",ExpressionUUID->"a0eabeee-feba-4d31-aa13-42d268d28dd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"KT`system`solution`nx", "[", "s", "]"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c0", "=", 
           RowBox[{
            RowBox[{"CFunctional", "[", "]"}], "[", 
            RowBox[{"s", ",", "0"}], "]"}]}], ",", 
          RowBox[{"c1", "=", 
           RowBox[{
            RowBox[{"CFunctional", "[", "]"}], "[", 
            RowBox[{"s", ",", "60"}], "]"}]}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"Hold", "[", "Sequence", "]"}], "[", 
         RowBox[{"c0", ",", "c1", ",", 
          RowBox[{"c1", "-", "c0"}]}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "sols1even"}], "}"}]}], "]"}], "//", 
  "ReleaseHold"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"%%", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], "]"}]}], "Input",
 CellLabel->
  "In[221]:=",ExpressionUUID->"37f41ab1-2180-4084-a108-f316cfdd2217"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"KT`system`solution`nx", "[", "s", "]"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c0", "=", 
           RowBox[{
            RowBox[{"CFunctional", "[", "]"}], "[", 
            RowBox[{"s", ",", "0"}], "]"}]}], ",", 
          RowBox[{"c1", "=", 
           RowBox[{
            RowBox[{"CFunctional", "[", "]"}], "[", 
            RowBox[{"s", ",", "60"}], "]"}]}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"Hold", "[", "Sequence", "]"}], "[", 
         RowBox[{"c0", ",", "c1", ",", 
          RowBox[{"c1", "-", "c0"}]}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "sols"}], "}"}]}], "]"}], "//", 
  "ReleaseHold"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"%%", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], "]"}]}], "Input",
 CellLabel->
  "In[209]:=",ExpressionUUID->"9297aedd-9841-413d-b5a3-48224aaad997"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{"1", 
     RowBox[{"(*", "n", "*)"}], ",", 
     RowBox[{"1.", "*", 
      SuperscriptBox["10", "12"]}]}], 
    RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"systems", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "n", "]"}],
           "[", 
          RowBox[{"0", ",", "10."}], "]"}], "[", 
         RowBox[{"0.", ",", "60."}], "]"}], "[", 
        RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "params"}], "]"}], "[", 
       "ICS2", "]"}], "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "401", ",", "801", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sols2", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"KT`system`solve", "[", 
      RowBox[{"s", ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
     RowBox[{"True", ",", "True", ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "60", ",", 
        RowBox[{"1", "/", "4"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "systems"}], "}"}]}], "]"}]}]}], "Input",
 CellLabel->
  "In[212]:=",ExpressionUUID->"b2bd5dd5-2675-4dd4-9848-d56092522b04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"KT`system`solution`nx", "[", "s", "]"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c0", "=", 
           RowBox[{
            RowBox[{"CFunctional", "[", "]"}], "[", 
            RowBox[{"s", ",", "0"}], "]"}]}], ",", 
          RowBox[{"c1", "=", 
           RowBox[{
            RowBox[{"CFunctional", "[", "]"}], "[", 
            RowBox[{"s", ",", "60"}], "]"}]}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"Hold", "[", "Sequence", "]"}], "[", 
         RowBox[{"c0", ",", "c1", ",", 
          RowBox[{"c1", "-", "c0"}]}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "sols2"}], "}"}]}], "]"}], "//", 
  "ReleaseHold"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"%%", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], "]"}]}], "Input",
 CellLabel->
  "In[215]:=",ExpressionUUID->"a87a6950-676a-4317-9e1b-2cacd23e30e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Numeric", "[", 
    RowBox[{"ICS3", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NumberForm", "[", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Simplify", "@", 
      RowBox[{"FunctionExpand", "@", 
       RowBox[{
        RowBox[{"\[CapitalGamma]m", "[", "%", "]"}], "[", 
        RowBox[{"2", ",", "10"}], "]"}]}]}], ",", "37"}], "]"}], ",", "37"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]2O\[CapitalDelta]x2C", "[", 
     RowBox[{
      RowBox[{"KT`system`solution`xui`t1", "[", "sol", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "%"}], "-", "1"}], "//", 
  "ScientificForm"}]}], "Input",
 CellLabel->
  "In[313]:=",ExpressionUUID->"1bdf2827-6359-439c-bd1a-1c2b6f4f9c81"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CFunctional", "[", "]"}], "[", 
   RowBox[{"sol", ",", "0"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"CFunctional", "[", "]"}], "[", 
         RowBox[{"sol", ",", "t"}], "]"}], "-", "%"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "56", ",", 
       RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Line", "[", "#", "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
       RowBox[{"%", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}], "\[Transpose]"}], 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
       RowBox[{"Thickness", "[", ".005", "]"}], ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"GUCD`goetheBlau", ",", "GUCD`emoRot"}], "}"}], ",", 
         SuperscriptBox[
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "-", " ", "1."}], ")"}], "/", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"Length", "[", "%", "]"}], " ", "-", " ", "1"}], " ", 
             ")"}]}], " ", ")"}], 
          FractionBox["1", "3"]]}], "]"}]}], "}"}], "&"}], ",", 
    RowBox[{"Length", "@", "%"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], ",", "1"}], "]"}], "]"}], "&"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"%", ",", "%%"}], "}"}]}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "56"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "200"}], ",", "2000"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", ".01", "]"}], ",", "Gray"}], "}"}], 
         "}"}]}]}], "]"}], ",", "%"}], "}"}], ",", 
   RowBox[{"GridLines", "->", "Automatic"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<t\>\"", ",", 
      "\"\<C[\!\(\*SubscriptBox[\(\[PartialD]\), \(x\)]\)u(t,x)]\>\"", ",", 
      "\"\<u[t=0,\[Sigma]]=\[Sigma]-\!\(\*FractionBox[SuperscriptBox[\(\
\[Sigma]\), \(3\)], \(5\)]\)+\!\(\*FractionBox[SuperscriptBox[\(\[Sigma]\), \
\(5\)], \(120\)]\), \[CapitalLambda]=\!\(\*SuperscriptBox[\(10\), \(12\)]\), \
O(N=10), n=101\>\""}], "}"}]}]}], "]"}]}], "Input",
 CellLabel->"In[323]:=",ExpressionUUID->"e9588d4f-db42-4f00-aa10-994fa0038eae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["O(1) Tests", \
"Subsection",ExpressionUUID->"e79a697c-2ddd-42dc-81df-890d3c2ae57b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "800"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{"1", 
     RowBox[{"(*", "n", "*)"}], ",", 
     RowBox[{"1.", "*", 
      SuperscriptBox["10", "6"]}]}], 
    RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "n", "]"}], 
       "[", 
       RowBox[{"0", ",", "10."}], "]"}], "[", 
      RowBox[{"0.", ",", "60."}], "]"}], "[", 
     RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "params"}], "]"}], "[", 
    "ICS1", "]"}], "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SC1O1`sol", "=", 
   RowBox[{
    RowBox[{"KT`system`solve", "[", 
     RowBox[{"%", ",", 
      RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
    RowBox[{"True", ",", "True"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{"1", 
     RowBox[{"(*", "n", "*)"}], ",", 
     RowBox[{"1.", "*", 
      SuperscriptBox["10", "12"]}]}], 
    RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "n", "]"}], 
       "[", 
       RowBox[{"0", ",", "10."}], "]"}], "[", 
      RowBox[{"0.", ",", "60."}], "]"}], "[", 
     RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "params"}], "]"}], "[", 
    "ICS2", "]"}], "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SC2O1`sol", "=", 
   RowBox[{
    RowBox[{"KT`system`solve", "[", 
     RowBox[{"%", ",", 
      RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
    RowBox[{"True", ",", "True"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "n", "]"}], 
       "[", 
       RowBox[{"0", ",", "10."}], "]"}], "[", 
      RowBox[{"0.", ",", "60."}], "]"}], "[", 
     RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "params"}], "]"}], "[", 
    "ICS2plus", "]"}], "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SC2pO1`sol", "=", 
   RowBox[{
    RowBox[{"KT`system`solve", "[", 
     RowBox[{"%", ",", 
      RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
    RowBox[{"True", ",", "True"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{"1", 
     RowBox[{"(*", "n", "*)"}], ",", 
     RowBox[{"1.", "*", 
      SuperscriptBox["10", "12"]}]}], 
    RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "n", "]"}], 
       "[", 
       RowBox[{"0", ",", "10."}], "]"}], "[", 
      RowBox[{"0.", ",", "60."}], "]"}], "[", 
     RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "params"}], "]"}], "[", 
    "ICS3", "]"}], "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SC3O1`sol", "=", 
   RowBox[{
    RowBox[{"KT`system`solve", "[", 
     RowBox[{"%", ",", 
      RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
    RowBox[{"True", ",", "True"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{"1", 
     RowBox[{"(*", "n", "*)"}], ",", 
     RowBox[{"1.", "*", 
      SuperscriptBox["10", "8"]}]}], 
    RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "n", "]"}], 
       "[", 
       RowBox[{"0", ",", "10."}], "]"}], "[", 
      RowBox[{"0.", ",", "60."}], "]"}], "[", 
     RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "params"}], "]"}], "[", 
    "ICS4", "]"}], "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SC4O1`sol", "=", 
   RowBox[{
    RowBox[{"KT`system`solve", "[", 
     RowBox[{"%", ",", 
      RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
    RowBox[{"True", ",", "True"}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solution`tw", "[", 
       RowBox[{"Symbol", "@", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"Names", "[", "\"\<SC*`sol\>\"", "]"}]}], "/", "60"}], "//", 
   "Total"}], " "}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"->", " ", "8.112536035"}], 
   "*)"}]}]}], \
"NonEvaluatingCode",ExpressionUUID->"ab79c4b1-2b81-47c8-889d-8f0f8b1434f1"],

Cell[BoxData[{
 RowBox[{"SC1O1`sol", "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<SC1O1.mx.gz\>\"", ",", "#"}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"SC2O1`sol", "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<SC2O1.mx.gz\>\"", ",", "#"}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"SC2pO1`sol", "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<SC2pO1.mx.gz\>\"", ",", "#"}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"SC3O1`sol", "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<SC3O1.mx.gz\>\"", ",", "#"}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"SC4O1`sol", "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<SC4O1.mx.gz\>\"", ",", "#"}], "]"}], 
   "&"}]}]}], "NonEvaluatingCode",
 CellLabel->
  "In[1210]:=",ExpressionUUID->"a0fbc42b-914d-4316-8528-806f2965338f"],

Cell[BoxData[{
 RowBox[{"SC1O1`sol", "=", 
  RowBox[{
  "Import", "[", "\"\<SC1O1.mx.gz\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SC2O1`sol", "=", 
  RowBox[{
  "Import", "[", "\"\<SC2O1.mx.gz\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SC2pO1`sol", "=", 
  RowBox[{
  "Import", "[", "\"\<SC2pO1.mx.gz\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SC3O1`sol", "=", 
  RowBox[{
  "Import", "[", "\"\<SC3O1.mx.gz\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SC4O1`sol", "=", 
   RowBox[{"Import", "[", "\"\<SC4O1.mx.gz\>\"", "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KT`system`solution`tw", "[", 
      RowBox[{"Symbol", "@", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"Names", "[", "\"\<SC*`sol\>\"", "]"}]}], "/", "60"}], "//", 
  "Total", " "}]}], \
"Code",ExpressionUUID->"6ed69c59-e1bb-4146-a6cc-985f216645cb"],

Cell[CellGroupData[{

Cell[TextData[{
 "Scenario 1 - O(N=1), ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalLambda]", "=", 
    SuperscriptBox["10", "6"]}], TraditionalForm]],ExpressionUUID->
  "13160e80-3681-41ed-ad94-f48df12b26d6"],
 ", n=800, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "1"], "=", "10"}], TraditionalForm]],ExpressionUUID->
  "08dcfa9c-a205-4d4d-a524-684996b693c6"]
}], "Subsubsection",ExpressionUUID->"eaafd3f2-d621-4225-990c-83d30daa1ce5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SC1O1`params", "=", 
   RowBox[{"{", 
    RowBox[{"1", 
     RowBox[{"(*", "n", "*)"}], ",", 
     RowBox[{"1.", "*", 
      SuperscriptBox["10", "6"]}]}], 
    RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SC1O1`system", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "801", "]"}], 
       "[", 
       RowBox[{"0", ",", "10."}], "]"}], "[", 
      RowBox[{"0.", ",", "56."}], "]"}], "[", 
     RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "%"}], "]"}], "[", "ICS1", 
    "]"}], "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SC1O1`sol", "=", 
  RowBox[{
   RowBox[{"KT`system`solve", "[", 
    RowBox[{"%", ",", 
     RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
     RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
   RowBox[{"True", ",", "True"}], "]"}]}]}], "NonEvaluatingInput",
 CellLabel->
  "In[879]:=",ExpressionUUID->"655ff5b9-2bcd-43ea-928b-660952e34ff1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SC1O1`solFlow", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"KT`system`solution`xui`t", "[", 
      RowBox[{"SC1O1`sol", ",", "t"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "56", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2.2"}], ",", "4.5"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"GUCD`goetheBlau", ",", "GUCD`emoRot"}], "}"}], ",", 
            SuperscriptBox[
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{"#", "-", " ", "1."}], ")"}], "/", 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"Length", "[", "%", "]"}], " ", "-", " ", "1"}], " ",
                 ")"}]}], " ", ")"}], 
             FractionBox["1", "3"]]}], "]"}]}], "}"}], "&"}], ",", 
       RowBox[{"Length", "@", "%"}]}], "]"}], "]"}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[351]:=",ExpressionUUID->"de9c6355-1d57-427e-806b-1d62b6fd24e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CFunctional", "[", "]"}], "[", 
   RowBox[{"SC1O1`sol", ",", "0"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CFunctional", "[", "]"}], "[", 
   RowBox[{"SC1O1`sol", ",", "56"}], "]"}], "-", "%"}], "\[IndentingNewLine]", 
 RowBox[{"CFunctionalExplicit", "[", 
  RowBox[{"SC1O1`sol", ",", "56"}], "]"}]}], "Input",
 CellLabel->
  "In[351]:=",ExpressionUUID->"99a68cec-efed-4d74-99cc-613b0a6d670f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Analytic", "[", 
    RowBox[{"ICS1", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Simplify", "@", 
    RowBox[{"FunctionExpand", "@", 
     RowBox[{
      RowBox[{"\[CapitalGamma]m", "[", "%", "]"}], "[", 
      RowBox[{"2", ",", "1"}], "]"}]}]}], ",", "37"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Numeric", "[", 
    RowBox[{"ICS1", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NumberForm", "[", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Simplify", "@", 
      RowBox[{"FunctionExpand", "@", 
       RowBox[{
        RowBox[{"\[CapitalGamma]m", "[", "%", "]"}], "[", 
        RowBox[{"2", ",", "1"}], "]"}]}]}], ",", "37"}], "]"}], ",", "37"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]2O\[CapitalDelta]x2C", "[", 
     RowBox[{
      RowBox[{"KT`system`solution`xui`t1", "[", "SC1O1`sol", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "%"}], "-", "1"}], "//", 
  "ScientificForm"}]}], "Input",
 CellLabel->
  "In[206]:=",ExpressionUUID->"4fd357ad-0c1e-4dd6-b686-d32d3ec5bf1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CFunctional", "[", "]"}], "[", 
   RowBox[{"SC1O1`sol", ",", "0"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"CFunctional", "[", "]"}], "[", 
         RowBox[{"SC1O1`sol", ",", "t"}], "]"}], "-", "%"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "56", ",", 
       RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Line", "[", "#", "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
       RowBox[{"%", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}], "\[Transpose]"}], 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
       RowBox[{"Thickness", "[", ".005", "]"}], ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"GUCD`goetheBlau", ",", "GUCD`emoRot"}], "}"}], ",", 
         SuperscriptBox[
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "-", " ", "1."}], ")"}], "/", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"Length", "[", "%", "]"}], " ", "-", " ", "1"}], " ", 
             ")"}]}], " ", ")"}], 
          FractionBox["1", "3"]]}], "]"}]}], "}"}], "&"}], ",", 
    RowBox[{"Length", "@", "%"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], ",", "1"}], "]"}], "]"}], "&"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"%", ",", "%%"}], "}"}]}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{"dat", ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "56"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "1000"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", ".01", "]"}], ",", "Gray"}], "}"}], 
        "}"}]}]}], "]"}], ",", "%"}], "}"}], "]"}]}], "Input",
 CellLabel->"In[211]:=",ExpressionUUID->"5d14d7b0-bcf7-4838-9836-ae7ae4c6e9b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Scenario 2 - O(N=1), ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalLambda]", "=", 
    SuperscriptBox["10", "12"]}], TraditionalForm]],ExpressionUUID->
  "559a142f-5b0b-4152-91f0-201c4a358196"],
 ", n=800, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "1"], "=", "10"}], TraditionalForm]],ExpressionUUID->
  "c101cd23-00aa-4828-9ad5-e2c26c7e2162"]
}], "Subsubsection",ExpressionUUID->"3fa64e5d-b230-43b5-b38e-385b83488eb9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SC2O1`params", "=", 
   RowBox[{"{", 
    RowBox[{"1", 
     RowBox[{"(*", "n", "*)"}], ",", 
     RowBox[{"1.", "*", 
      SuperscriptBox["10", "12"]}]}], 
    RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SC2O1`system", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "801", "]"}], 
       "[", 
       RowBox[{"0", ",", "10."}], "]"}], "[", 
      RowBox[{"0.", ",", "56."}], "]"}], "[", 
     RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "%"}], "]"}], "[", "ICS2", 
    "]"}], "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SC2O1`sol", "=", 
  RowBox[{
   RowBox[{"KT`system`solve", "[", 
    RowBox[{"%", ",", 
     RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
     RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
   RowBox[{"True", ",", "True"}], "]"}]}]}], "NonEvaluatingInput",
 CellLabel->
  "In[882]:=",ExpressionUUID->"3b9a3dd7-eb04-4931-8793-7bcb9d526dac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SC2O1`solFlow", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"KT`system`solution`xui`t", "[", 
      RowBox[{"SC2O1`sol", ",", "t"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "56", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2.2"}], ",", "4.5"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"GUCD`goetheBlau", ",", "GUCD`emoRot"}], "}"}], ",", 
            SuperscriptBox[
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{"#", "-", " ", "1."}], ")"}], "/", 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"Length", "[", "%", "]"}], " ", "-", " ", "1"}], " ",
                 ")"}]}], " ", ")"}], 
             FractionBox["1", "3"]]}], "]"}]}], "}"}], "&"}], ",", 
       RowBox[{"Length", "@", "%"}]}], "]"}], "]"}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[324]:=",ExpressionUUID->"b396d45c-b4ad-44fd-bdfe-d7efea5b910a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CFunctional", "[", "]"}], "[", 
  RowBox[{"SC2O1`sol", ",", "0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CFunctionalTest", "[", 
   RowBox[{"SC2O1`sol", ",", "56"}], "]"}], "-", "%"}]}], "Input",
 CellLabel->
  "In[219]:=",ExpressionUUID->"afffb7e1-5303-4bf2-9000-11324b5c8061"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Analytic", "[", 
    RowBox[{"ICS2", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Simplify", "@", 
    RowBox[{"FunctionExpand", "@", 
     RowBox[{
      RowBox[{"\[CapitalGamma]m", "[", "%", "]"}], "[", 
      RowBox[{"2", ",", "1"}], "]"}]}]}], ",", "37"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Numeric", "[", 
    RowBox[{"ICS2", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NumberForm", "[", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Simplify", "@", 
      RowBox[{"FunctionExpand", "@", 
       RowBox[{
        RowBox[{"\[CapitalGamma]m", "[", "%", "]"}], "[", 
        RowBox[{"2", ",", "1"}], "]"}]}]}], ",", "37"}], "]"}], ",", "37"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]2O\[CapitalDelta]x2C", "[", 
     RowBox[{
      RowBox[{"KT`system`solution`xui`t1", "[", "SC2O1`sol", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "%"}], "-", "1"}], "//", 
  "ScientificForm"}]}], "Input",
 CellLabel->
  "In[221]:=",ExpressionUUID->"d5dddd1f-668d-4d23-9c69-39e5794b9e45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CFunctional", "[", "]"}], "[", 
   RowBox[{"SC2O1`sol", ",", "0"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"CFunctional", "[", "]"}], "[", 
         RowBox[{"SC2O1`sol", ",", "t"}], "]"}], "-", "%"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "56", ",", 
       RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Line", "[", "#", "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
       RowBox[{"%", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}], "\[Transpose]"}], 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
       RowBox[{"Thickness", "[", ".005", "]"}], ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"GUCD`goetheBlau", ",", "GUCD`emoRot"}], "}"}], ",", 
         SuperscriptBox[
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "-", " ", "1."}], ")"}], "/", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"Length", "[", "%", "]"}], " ", "-", " ", "1"}], " ", 
             ")"}]}], " ", ")"}], 
          FractionBox["1", "3"]]}], "]"}]}], "}"}], "&"}], ",", 
    RowBox[{"Length", "@", "%"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], ",", "1"}], "]"}], "]"}], "&"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"%", ",", "%%"}], "}"}]}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{"dat", ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "56"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "10"}], ",", "50"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", ".01", "]"}], ",", "Gray"}], "}"}], 
        "}"}]}]}], "]"}], ",", "%"}], "}"}], "]"}]}], "Input",
 CellLabel->"In[226]:=",ExpressionUUID->"bd3ba84e-4766-42f3-95b0-159d17e4a862"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Scenario 2 - O(N=1), ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalLambda]", "=", 
    SuperscriptBox["10", "12"]}], TraditionalForm]],ExpressionUUID->
  "6f6fbf19-f440-4466-8aa4-2cf8c7b0d5c5"],
 ", n=800, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "1"], "=", "10"}], TraditionalForm]],ExpressionUUID->
  "09edce77-6270-4a97-ad73-d16f4b3c044e"],
 ", positive mass"
}], "Subsubsection",ExpressionUUID->"26c49d50-3e2e-4157-ab7c-f82b17401e50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SC2pO1`params", "=", 
   RowBox[{"{", 
    RowBox[{"1", 
     RowBox[{"(*", "n", "*)"}], ",", 
     RowBox[{"1.", "*", 
      SuperscriptBox["10", "12"]}]}], 
    RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SC2pO1`system", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "801", "]"}], 
       "[", 
       RowBox[{"0", ",", "10."}], "]"}], "[", 
      RowBox[{"0.", ",", "56."}], "]"}], "[", 
     RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "%"}], "]"}], "[", 
    "ICS2plus", "]"}], "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SC2pO1`sol", "=", 
  RowBox[{
   RowBox[{"KT`system`solve", "[", 
    RowBox[{"%", ",", 
     RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
     RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
   RowBox[{"True", ",", "True"}], "]"}]}]}], "NonEvaluatingInput",
 CellLabel->
  "In[885]:=",ExpressionUUID->"91a44a19-ad7d-4132-bdc7-033ee7402858"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SC2pO1`solFlow", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"KT`system`solution`xui`t", "[", 
      RowBox[{"SC2pO1`sol", ",", "t"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "56", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "4.5"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"GUCD`goetheBlau", ",", "GUCD`emoRot"}], "}"}], ",", 
            SuperscriptBox[
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{"#", "-", " ", "1."}], ")"}], "/", 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"Length", "[", "%", "]"}], " ", "-", " ", "1"}], " ",
                 ")"}]}], " ", ")"}], 
             FractionBox["1", "3"]]}], "]"}]}], "}"}], "&"}], ",", 
       RowBox[{"Length", "@", "%"}]}], "]"}], "]"}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[330]:=",ExpressionUUID->"7566c467-9abd-4871-a2e8-f514789f5959"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CFunctional", "[", "]"}], "[", 
  RowBox[{"SC2pO1`sol", ",", "0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CFunctionalTest", "[", 
   RowBox[{"SC2pO1`sol", ",", "56"}], "]"}], "-", "%"}]}], "Input",
 CellLabel->
  "In[234]:=",ExpressionUUID->"b6b91dd9-9dd6-4a49-bd50-c7f629d2f8c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Analytic", "[", 
    RowBox[{"ICS2plus", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Simplify", "@", 
    RowBox[{"FunctionExpand", "@", 
     RowBox[{
      RowBox[{"\[CapitalGamma]m", "[", "%", "]"}], "[", 
      RowBox[{"2", ",", "1"}], "]"}]}]}], ",", "37"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Numeric", "[", 
    RowBox[{"ICS2plus", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NumberForm", "[", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Simplify", "@", 
      RowBox[{"FunctionExpand", "@", 
       RowBox[{
        RowBox[{"\[CapitalGamma]m", "[", "%", "]"}], "[", 
        RowBox[{"2", ",", "1"}], "]"}]}]}], ",", "37"}], "]"}], ",", "37"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]2O\[CapitalDelta]x2C", "[", 
     RowBox[{
      RowBox[{"KT`system`solution`xui`t1", "[", "SC2pO1`sol", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "%"}], "-", "1"}], "//", 
  "ScientificForm"}]}], "Input",
 CellLabel->
  "In[236]:=",ExpressionUUID->"e6d6d0be-5bd8-4329-a565-c93ed9b385fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CFunctional", "[", "]"}], "[", 
   RowBox[{"SC2pO1`sol", ",", "0"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"CFunctional", "[", "]"}], "[", 
         RowBox[{"SC2pO1`sol", ",", "t"}], "]"}], "-", "%"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "56", ",", 
       RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Line", "[", "#", "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
       RowBox[{"%", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}], "\[Transpose]"}], 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
       RowBox[{"Thickness", "[", ".005", "]"}], ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"GUCD`goetheBlau", ",", "GUCD`emoRot"}], "}"}], ",", 
         SuperscriptBox[
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "-", " ", "1."}], ")"}], "/", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"Length", "[", "%", "]"}], " ", "-", " ", "1"}], " ", 
             ")"}]}], " ", ")"}], 
          FractionBox["1", "3"]]}], "]"}]}], "}"}], "&"}], ",", 
    RowBox[{"Length", "@", "%"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], ",", "1"}], "]"}], "]"}], "&"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"%", ",", "%%"}], "}"}]}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{"dat", ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "56"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "10"}], ",", "50"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", ".01", "]"}], ",", "Gray"}], "}"}], 
        "}"}]}]}], "]"}], ",", "%"}], "}"}], "]"}]}], "Input",
 CellLabel->"In[241]:=",ExpressionUUID->"7e90d2d1-45b4-46db-83e7-c8dce6bfbb3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Scenario 3 - O(N=1), ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalLambda]", "=", 
    SuperscriptBox["10", "12"]}], TraditionalForm]],ExpressionUUID->
  "baba2b9a-6388-41a7-bed3-41f56c0ecf84"],
 ", n=800, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "1"], "=", "10"}], TraditionalForm]],ExpressionUUID->
  "5bd41a39-43d8-4c92-92e5-f489a4ddebd4"]
}], "Subsubsection",ExpressionUUID->"18f4e3f6-7ee8-43db-90e7-ff1d545a2799"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SC3O1`params", "=", 
   RowBox[{"{", 
    RowBox[{"1", 
     RowBox[{"(*", "n", "*)"}], ",", 
     RowBox[{"1.", "*", 
      SuperscriptBox["10", "12"]}]}], 
    RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SC3O1`system", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "801", "]"}], 
       "[", 
       RowBox[{"0", ",", "10."}], "]"}], "[", 
      RowBox[{"0.", ",", "56."}], "]"}], "[", 
     RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "%"}], "]"}], "[", "ICS3", 
    "]"}], "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SC3O1`sol", "=", 
  RowBox[{
   RowBox[{"KT`system`solve", "[", 
    RowBox[{"%", ",", 
     RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
     RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
   RowBox[{"True", ",", "True"}], "]"}]}]}], "NonEvaluatingInput",
 CellLabel->
  "In[888]:=",ExpressionUUID->"82ada746-00dd-45bc-88b6-78f06c58fccf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SC3O1`solFlow", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"KT`system`solution`xui`t", "[", 
      RowBox[{"SC3O1`sol", ",", "t"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "56", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2.2"}], ",", "4.5"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"GUCD`goetheBlau", ",", "GUCD`emoRot"}], "}"}], ",", 
            SuperscriptBox[
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{"#", "-", " ", "1."}], ")"}], "/", 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"Length", "[", "%", "]"}], " ", "-", " ", "1"}], " ",
                 ")"}]}], " ", ")"}], 
             FractionBox["1", "3"]]}], "]"}]}], "}"}], "&"}], ",", 
       RowBox[{"Length", "@", "%"}]}], "]"}], "]"}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[332]:=",ExpressionUUID->"b7e553cb-a1cd-4265-9027-d5d6788dd722"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CFunctional", "[", "]"}], "[", 
  RowBox[{"SC3O1`sol", ",", "0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CFunctionalTest", "[", 
   RowBox[{"SC3O1`sol", ",", "56"}], "]"}], "-", "%"}]}], "Input",
 CellLabel->
  "In[249]:=",ExpressionUUID->"5b509048-5040-4147-8d7c-411d79c78ba0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Analytic", "[", 
    RowBox[{"ICS3", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Simplify", "@", 
    RowBox[{"FunctionExpand", "@", 
     RowBox[{
      RowBox[{"\[CapitalGamma]m", "[", "%", "]"}], "[", 
      RowBox[{"2", ",", "1"}], "]"}]}]}], ",", "37"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Numeric", "[", 
    RowBox[{"ICS3", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NumberForm", "[", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Simplify", "@", 
      RowBox[{"FunctionExpand", "@", 
       RowBox[{
        RowBox[{"\[CapitalGamma]m", "[", "%", "]"}], "[", 
        RowBox[{"2", ",", "1"}], "]"}]}]}], ",", "37"}], "]"}], ",", "37"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]2O\[CapitalDelta]x2C", "[", 
     RowBox[{
      RowBox[{"KT`system`solution`xui`t1", "[", "SC3O1`sol", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "%"}], "-", "1"}], "//", 
  "ScientificForm"}]}], "Input",
 CellLabel->
  "In[251]:=",ExpressionUUID->"8b3f5c90-ad4e-4443-bb6c-3116d6547dd2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CFunctional", "[", "]"}], "[", 
   RowBox[{"SC3O1`sol", ",", "0"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"CFunctional", "[", "]"}], "[", 
         RowBox[{"SC3O1`sol", ",", "t"}], "]"}], "-", "%"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "56", ",", 
       RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Line", "[", "#", "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
       RowBox[{"%", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}], "\[Transpose]"}], 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
       RowBox[{"Thickness", "[", ".005", "]"}], ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"GUCD`goetheBlau", ",", "GUCD`emoRot"}], "}"}], ",", 
         SuperscriptBox[
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "-", " ", "1."}], ")"}], "/", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"Length", "[", "%", "]"}], " ", "-", " ", "1"}], " ", 
             ")"}]}], " ", ")"}], 
          FractionBox["1", "3"]]}], "]"}]}], "}"}], "&"}], ",", 
    RowBox[{"Length", "@", "%"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], ",", "1"}], "]"}], "]"}], "&"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"%", ",", "%%"}], "}"}]}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{"dat", ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "56"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "10"}], ",", "500"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", ".01", "]"}], ",", "Gray"}], "}"}], 
        "}"}]}]}], "]"}], ",", "%"}], "}"}], "]"}]}], "Input",
 CellLabel->"In[256]:=",ExpressionUUID->"fa4dc6c8-3d11-4439-8f44-345578949eb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Scenario 4 - O(N=1), ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalLambda]", "=", 
    SuperscriptBox["10", "8"]}], TraditionalForm]],ExpressionUUID->
  "b9c88322-2ebb-4ab5-81d9-d6e282929b64"],
 ", n=800, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "1"], "=", "10"}], TraditionalForm]],ExpressionUUID->
  "a143c377-f759-4814-a33f-f7eeaff4929c"]
}], "Subsubsection",ExpressionUUID->"5f36bfb1-c40c-4727-b50d-270c862dcfec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SC4O1`params", "=", 
   RowBox[{"{", 
    RowBox[{"1", 
     RowBox[{"(*", "n", "*)"}], ",", 
     RowBox[{"1.", "*", 
      SuperscriptBox["10", "8"]}]}], 
    RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SC4O1`system", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "801", "]"}], 
       "[", 
       RowBox[{"0", ",", "10."}], "]"}], "[", 
      RowBox[{"0.", ",", "56."}], "]"}], "[", 
     RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "%"}], "]"}], "[", "ICS4", 
    "]"}], "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SC4O1`sol", "=", 
  RowBox[{
   RowBox[{"KT`system`solve", "[", 
    RowBox[{"%", ",", 
     RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
     RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
   RowBox[{"True", ",", "True"}], "]"}]}]}], "NonEvaluatingInput",
 CellLabel->
  "In[891]:=",ExpressionUUID->"af7e58fd-3cb1-4036-986c-cf3508c72e1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SC4O1`solFlow", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"KT`system`solution`xui`t", "[", 
      RowBox[{"SC4O1`sol", ",", "t"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "56", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2.2"}], ",", "4.5"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"GUCD`goetheBlau", ",", "GUCD`emoRot"}], "}"}], ",", 
            SuperscriptBox[
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{"#", "-", " ", "1."}], ")"}], "/", 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"Length", "[", "%", "]"}], " ", "-", " ", "1"}], " ",
                 ")"}]}], " ", ")"}], 
             FractionBox["1", "3"]]}], "]"}]}], "}"}], "&"}], ",", 
       RowBox[{"Length", "@", "%"}]}], "]"}], "]"}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[334]:=",ExpressionUUID->"4b7b8bef-7411-4d6d-a876-d0e95658e906"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CFunctional", "[", "]"}], "[", 
  RowBox[{"SC4O1`sol", ",", "0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CFunctionalTest", "[", 
   RowBox[{"SC4O1`sol", ",", "56"}], "]"}], "-", "%"}]}], "Input",
 CellLabel->
  "In[264]:=",ExpressionUUID->"6cefa74e-6484-42d2-bc7d-11e05f7a94c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Analytic", "[", 
    RowBox[{"ICS4", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Simplify", "@", 
    RowBox[{"FunctionExpand", "@", 
     RowBox[{
      RowBox[{"\[CapitalGamma]m", "[", "%", "]"}], "[", 
      RowBox[{"2", ",", "1"}], "]"}]}]}], ",", "37"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2Numeric", "[", 
    RowBox[{"ICS4", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NumberForm", "[", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Simplify", "@", 
      RowBox[{"FunctionExpand", "@", 
       RowBox[{
        RowBox[{"\[CapitalGamma]m", "[", "%", "]"}], "[", 
        RowBox[{"2", ",", "1"}], "]"}]}]}], ",", "37"}], "]"}], ",", "37"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]2O\[CapitalDelta]x2C", "[", 
     RowBox[{
      RowBox[{"KT`system`solution`xui`t1", "[", "SC4O1`sol", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "%"}], "-", "1"}], "//", 
  "ScientificForm"}]}], "Input",
 CellLabel->
  "In[266]:=",ExpressionUUID->"7c2bdc42-5b77-4a7c-b90e-6078ce5b6d4f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CFunctional", "[", "]"}], "[", 
   RowBox[{"SC4O1`sol", ",", "0"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"CFunctional", "[", "]"}], "[", 
         RowBox[{"SC4O1`sol", ",", "t"}], "]"}], "-", "%"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "56", ",", 
       RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Line", "[", "#", "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
       RowBox[{"%", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}], "\[Transpose]"}], 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CapForm", "[", "\"\<Round\>\"", "]"}], ",", 
       RowBox[{"Thickness", "[", ".005", "]"}], ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"GUCD`goetheBlau", ",", "GUCD`emoRot"}], "}"}], ",", 
         SuperscriptBox[
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"#", "-", " ", "1."}], ")"}], "/", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"Length", "[", "%", "]"}], " ", "-", " ", "1"}], " ", 
             ")"}]}], " ", ")"}], 
          FractionBox["1", "3"]]}], "]"}]}], "}"}], "&"}], ",", 
    RowBox[{"Length", "@", "%"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], ",", "1"}], "]"}], "]"}], "&"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"%", ",", "%%"}], "}"}]}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{"dat", ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "56"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "3000"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", ".01", "]"}], ",", "Gray"}], "}"}], 
        "}"}]}]}], "]"}], ",", "%"}], "}"}], "]"}]}], "Input",
 CellLabel->
  "In[271]:=",ExpressionUUID->"0ad59ac0-7157-4908-bd77-0951794489fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dat", "//", "Interpolation"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"%", "[", "x", "]"}], ",", "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "1", ",", "50"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellLabel->"In[277]:=",ExpressionUUID->"2f128e16-c330-46fe-b18a-1e874094971f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["O(N) Tests", \
"Subsection",ExpressionUUID->"b70300d9-d0b5-45d8-88ed-f86e558dc11e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", 
       RowBox[{"(*", "n", "*)"}], ",", 
       RowBox[{"1.", "*", 
        SuperscriptBox["10", "6"]}]}], 
      RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "10"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"systems", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "101", 
           "]"}], "[", 
          RowBox[{"0", ",", "10."}], "]"}], "[", 
         RowBox[{"0.", ",", "56."}], "]"}], "[", 
        RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "p"}], "]"}], "[", 
       "ICS1", "]"}], "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "params"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solve", "[", 
       RowBox[{"s", ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
      RowBox[{"True", ",", "True", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "56", ",", 
         RowBox[{"1", "/", "4"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "systems"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[416]:=",ExpressionUUID->"8fe047ce-40fd-4b3a-a9e5-322d495e407a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dats", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"CFunctional", "[", "]"}], "[", 
           RowBox[{"s", ",", "t"}], "]"}], "-", 
          RowBox[{
           RowBox[{"CFunctional", "[", "]"}], "[", 
           RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "56", ",", 
         RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "sols"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"dats", ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<N=\>\"", ",", "n"}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", "10"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Left", ",", "Top"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<t\>\"", ",", "\"\<C-fkt\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Scenario 1\>\""}]}], "]"}]}], "Input",
 CellLabel->
  "In[419]:=",ExpressionUUID->"6114c1f7-cb33-4dfc-8ad6-73d112b612d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", 
       RowBox[{"(*", "n", "*)"}], ",", 
       RowBox[{"1.", "*", 
        SuperscriptBox["10", "12"]}]}], 
      RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "10"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"systems", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "101", 
           "]"}], "[", 
          RowBox[{"0", ",", "10."}], "]"}], "[", 
         RowBox[{"0.", ",", "56."}], "]"}], "[", 
        RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "p"}], "]"}], "[", 
       "ICS2", "]"}], "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "params"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solve", "[", 
       RowBox[{"s", ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
      RowBox[{"True", ",", "True", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "56", ",", 
         RowBox[{"1", "/", "4"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "systems"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[410]:=",ExpressionUUID->"d3435df4-0b50-4309-ae6c-9081b584eba1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dats", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"CFunctional", "[", "]"}], "[", 
           RowBox[{"s", ",", "t"}], "]"}], "-", 
          RowBox[{
           RowBox[{"CFunctional", "[", "]"}], "[", 
           RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "56", ",", 
         RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "sols"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"dats", ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<N=\>\"", ",", "n"}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", "10"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Left", ",", "Top"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<t\>\"", ",", "\"\<C-fkt\>\""}], "}"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Scenario 2 (\!\(\*SubscriptBox[\(N\), \(crit\)]\)=8)\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Sort"}], "//", 
         "First"}], ")"}], "<", "0"}], ")"}], "&"}], "/@", "dats"}], "//", 
   RowBox[{
    RowBox[{"FirstPosition", "[", 
     RowBox[{"#", ",", "True"}], "]"}], "&"}]}], "//", "First"}]}], "Input",
 CellLabel->
  "In[413]:=",ExpressionUUID->"3c473aa6-981e-434a-a05b-409828f91b9f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", 
       RowBox[{"(*", "n", "*)"}], ",", 
       RowBox[{"1.", "*", 
        SuperscriptBox["10", "12"]}]}], 
      RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "10"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"systems", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "101", 
           "]"}], "[", 
          RowBox[{"0", ",", "10."}], "]"}], "[", 
         RowBox[{"0.", ",", "56."}], "]"}], "[", 
        RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "p"}], "]"}], "[", 
       "ICS2plus", "]"}], "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "params"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solve", "[", 
       RowBox[{"s", ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
      RowBox[{"True", ",", "True", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "56", ",", 
         RowBox[{"1", "/", "4"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "systems"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[398]:=",ExpressionUUID->"2b0e411d-33b6-48f8-8071-cfc69f1e0d9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dats", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"CFunctional", "[", "]"}], "[", 
           RowBox[{"s", ",", "t"}], "]"}], "-", 
          RowBox[{
           RowBox[{"CFunctional", "[", "]"}], "[", 
           RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "56", ",", 
         RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "sols"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"dats", ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<N=\>\"", ",", "n"}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", "10"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Left", ",", "Top"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<t\>\"", ",", "\"\<C-fkt\>\""}], "}"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Scenario 2 plus (\!\(\*SubscriptBox[\(N\), \(crit\)]\)=7)\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Sort"}], "//", 
         "First"}], ")"}], "<", "0"}], ")"}], "&"}], "/@", "dats"}], "//", 
   RowBox[{
    RowBox[{"FirstPosition", "[", 
     RowBox[{"#", ",", "True"}], "]"}], "&"}]}], "//", "First"}]}], "Input",
 CellLabel->
  "In[407]:=",ExpressionUUID->"120a1bc5-4c84-4bc8-9cbf-26816ad1eedd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", 
       RowBox[{"(*", "n", "*)"}], ",", 
       RowBox[{"1.", "*", 
        SuperscriptBox["10", "12"]}]}], 
      RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "10"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"systems", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "101", 
           "]"}], "[", 
          RowBox[{"0", ",", "10."}], "]"}], "[", 
         RowBox[{"0.", ",", "56."}], "]"}], "[", 
        RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "p"}], "]"}], "[", 
       "ICS3", "]"}], "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "params"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solve", "[", 
       RowBox[{"s", ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
      RowBox[{"True", ",", "True", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "56", ",", 
         RowBox[{"1", "/", "4"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "systems"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[445]:=",ExpressionUUID->"823406c0-416f-485a-b3d5-a38be5ba8696"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dats", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"CFunctional", "[", "]"}], "[", 
           RowBox[{"s", ",", "t"}], "]"}], "-", 
          RowBox[{
           RowBox[{"CFunctional", "[", "]"}], "[", 
           RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "56", ",", 
         RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "sols"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"dats", ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<N=\>\"", ",", "n"}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", "10"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Left", ",", "Top"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<t\>\"", ",", "\"\<C-fkt\>\""}], "}"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Scenario 3 (\!\(\*SubscriptBox[\(N\), \(crit\)]\)=7)\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Sort"}], "//", 
         "First"}], ")"}], "<", "0"}], ")"}], "&"}], "/@", "dats"}], "//", 
   RowBox[{
    RowBox[{"FirstPosition", "[", 
     RowBox[{"#", ",", "True"}], "]"}], "&"}]}], "//", "First"}]}], "Input",
 CellLabel->
  "In[448]:=",ExpressionUUID->"a8e5c07f-2c9b-44ab-af94-a6a49d036143"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", 
       RowBox[{"(*", "n", "*)"}], ",", 
       RowBox[{"1.", "*", 
        SuperscriptBox["10", "12"]}]}], 
      RowBox[{"(*", "\[CapitalLambda]", "*)"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "10"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"systems", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KT`system`generate", "[", "KT`O2", "]"}], "[", "101", 
           "]"}], "[", 
          RowBox[{"0", ",", "10."}], "]"}], "[", 
         RowBox[{"0.", ",", "56."}], "]"}], "[", 
        RowBox[{"ON0d`PDE", ",", "ON0d`PDE`BC", ",", "p"}], "]"}], "[", 
       "ICS4", "]"}], "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "params"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KT`system`solve", "[", 
       RowBox[{"s", ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}], "[", 
      RowBox[{"True", ",", "True", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "56", ",", 
         RowBox[{"1", "/", "4"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "systems"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[427]:=",ExpressionUUID->"c25a9e3b-f93c-42ef-928d-544ee0e9d736"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dats", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"CFunctional", "[", "]"}], "[", 
           RowBox[{"s", ",", "t"}], "]"}], "-", 
          RowBox[{
           RowBox[{"CFunctional", "[", "]"}], "[", 
           RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "56", ",", 
         RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "sols"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"dats", ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<N=\>\"", ",", "n"}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", "10"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Left", ",", "Top"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<t\>\"", ",", "\"\<C-fkt\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Scenario 4\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Sort"}], "//", 
         "First"}], ")"}], "<", "0"}], ")"}], "&"}], "/@", "dats"}], "//", 
   RowBox[{
    RowBox[{"FirstPosition", "[", 
     RowBox[{"#", ",", "True"}], "]"}], "&"}]}], "//", "First"}]}], "Input",
 CellLabel->"In[433]:=",ExpressionUUID->"240d2917-2eec-4a17-a8ed-0bfac595e20e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
NotebookEventActions:>{"WindowClose" :> If[NB`DeleteGeneratedCellsQ === True, 
    FrontEndExecute[{
      FrontEndToken["DeleteGeneratedCells"]}]]},
WindowSize->{1428., 740.25},
WindowMargins->{{-1535.25, Automatic}, {Automatic, 196.5}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.1999999999999, 841.98}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
TaggingRules->{"SlideshowSettings" -> {"Toolbar" -> True}},
TrackCellChangeTimes->False,
Magnification:>1.25 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    CellGroupData[{
      Cell["Style Environment Names", "Section"], 
      Cell[
       StyleData[All, "WorkingDark"], CellInsertionPointCell -> 
       FEPrivate`FrontEndResource["FEExpressions", "CellInsertionMenu"], 
       MenuSortingValue -> 1101], 
      Cell[
       StyleData[All, "Printout"], PageWidth :> PaperWidth, 
       CellHorizontalScrolling -> True, 
       CellLabelMargins -> {{2, Inherited}, {Inherited, Inherited}}, 
       ShowAutoStyles -> False, ShowAutoSpellCheck -> False, ShowSyntaxStyles -> 
       False, AutoStyleOptions -> {"HighlightMisspelledWords" -> False}, 
       ScriptMinSize -> 5, MenuSortingValue -> 1500, 
       PrivateFontOptions -> {"FontType" -> "Outline"}, Magnification -> 
       0.5]}, Open]], 
   Cell[
    CellGroupData[{
      Cell[
      "Notebook Style", "Section", 
       CellChangeTimes -> {3.8070389616379795`*^9}], 
      Cell[
       CellGroupData[{
         Cell[
          StyleData["Notebook"]], 
         Cell[
          StyleData[
          "Notebook", "WorkingDark", StyleDefinitions -> 
           StyleData["Notebook"]], 
          AutoStyleOptions -> {
           "CommentStyle" -> {
             FontColor -> RGBColor[0.596078, 0.462745, 0.666667], 
              ShowAutoStyles -> False, ShowSyntaxStyles -> False, 
              AutoNumberFormatting -> False}, 
            "FunctionLocalVariableStyle" -> {
             FontColor -> RGBColor[0.8, 0.470588, 0.196078]}, 
            "GraphicsCompatibilityProblemStyle" -> {
             FontColor -> RGBColor[1, 0, 0]}, 
            "LocalScopeConflictStyle" -> {FontColor -> RGBColor[1, 0, 0]}, 
            "LocalVariableStyle" -> {
             FontColor -> RGBColor[0.733333, 0.709804, 0.160784]}, 
            "MissingArgumentStyle" -> {FontColor -> RGBColor[1, 0, 0]}, 
            "MisspelledWordStyle" -> {FontColor -> RGBColor[1, 0, 0]}, 
            "NoKernelPresentStyle" -> {FontColor -> RGBColor[1, 0, 0]}, 
            "PatternVariableStyle" -> {
             FontColor -> RGBColor[0.8, 0.470588, 0.196078], FontSlant -> 
              "Italic"}, 
            "StringStyle" -> {
             FontColor -> RGBColor[0.415686, 0.529412, 0.34902], 
              ShowAutoStyles -> False, ShowSyntaxStyles -> False, 
              AutoNumberFormatting -> False}, 
            "UndefinedSymbolStyle" -> {
             FontColor -> RGBColor[0.407843, 0.592157, 0.733333]}, 
            "UnknownOptionStyle" -> {FontColor -> RGBColor[1, 0, 0]}, 
            "UnwantedAssignmentStyle" -> {FontColor -> RGBColor[1, 0, 0]}}, 
          CodeAssistOptions -> {
           "AutoConvertEnable" -> False, 
            "HeadHighlightStyle" -> {
             Background -> RGBColor[0.276471, 0.380392, 0.25098], FontColor -> 
              RGBColor[0.662745, 0.717647, 0.776471], FontWeight -> Bold}, 
            "MatchHighlightStyle" -> {
             Background -> RGBColor[0.276471, 0.380392, 0.25098], FontColor -> 
              RGBColor[0.662745, 0.717647, 0.776471], FontWeight -> Bold}}, 
          TranslationOptions -> {"Language" -> None}, FontColor -> 
          RGBColor[0.662745, 0.717647, 0.776471], Background -> 
          RGBColor[0.168627, 0.168627, 0.168627]], 
         Cell[
          StyleData[
          "Hyperlink", "WorkingDark", StyleDefinitions -> StyleData["Link"]], 
          CellChangeTimes -> {{3.808730972161214*^9, 3.808730982545971*^9}}, 
          LineColor -> RGBColor[0.596078, 0.462745, 0.666667], FrontFaceColor -> 
          RGBColor[0.596078, 0.462745, 0.666667], BackFaceColor -> 
          RGBColor[0.596078, 0.462745, 0.666667], GraphicsColor -> 
          RGBColor[0.596078, 0.462745, 0.666667], FontColor -> 
          RGBColor[0.596078, 0.462745, 0.666667]], 
         Cell[
          StyleData[
          "HyperlinkActive", "WorkingDark", StyleDefinitions -> 
           StyleData["HyperlinkActive"]], 
          CellChangeTimes -> {{3.808730972165733*^9, 3.808730982545971*^9}}, 
          FontColor -> RGBColor[0.8, 0.470588, 0.196078]]}, Open]], 
      Cell[
       CellGroupData[{
         Cell[
          StyleData["CellExpression"]], 
         Cell[
          StyleData[
          "CellExpression", "WorkingDark", StyleDefinitions -> 
           StyleData["CellExpression"]], CellFrame -> 0.5, CellFrameColor -> 
          RGBColor[0.331373, 0.358824, 0.388235], FontColor -> 
          RGBColor[0.662745, 0.717647, 0.776471], Background -> 
          RGBColor[0.168627, 0.168627, 0.168627]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell[
          StyleData["NotebookHeader"], CellFrame -> {{0, 0}, {0.5, 0.5}}, 
          CellMargins -> {{5, 0}, {5, 5}}, 
          CellGroupingRules -> {"SectionGrouping", 40}, 
          CellFrameMargins -> {{0, 10}, {5, 5}}, CellFrameColor -> 
          GrayLevel[0], TextAlignment -> Right, FontFamily -> 
          "Source Sans Pro", FontSize -> 16, FontWeight -> "Normal", 
          FontSlant -> "Plain", FontColor -> GrayLevel[0.5], Background -> 
          GrayLevel[0.85]], 
         Cell[
          StyleData[
          "NotebookHeader", "WorkingDark", StyleDefinitions -> 
           StyleData["NotebookHeader"]], FontColor -> 
          RGBColor[0.662745, 0.717647, 0.776471], Background -> 
          RGBColor[
           0.25176470588235295`, 0.25176470588235295`, 
            0.25176470588235295`]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["InitializationSecion and -Cell", "Subsection"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["InitializationSection"], 
             CellFrame -> {{3, 0}, {0, 0}}, 
             CellMargins -> {{27, Inherited}, {10, 15}}, 
             CellGroupingRules -> {"SectionGrouping", 30}, 
             LineSpacing -> {1, 4}, FontFamily -> "Source Sans Pro", FontSize -> 
             24, FontColor -> 
             RGBColor[
              0.7612268253604944, 0.29576562142366675`, 0.08555733577477684]], 
            Cell[
             StyleData[
             "InitializationSection", "WorkingDark", StyleDefinitions -> 
              StyleData["InitializationSection"]], CellFrameColor -> 
             RGBColor[
              0.33137254901960783`, 0.3588235294117647, 0.38823529411764707`],
              FontColor -> 
             RGBColor[
              0.3843137254901961, 0.592156862745098, 0.3333333333333333]]}, 
           Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["InitializationCell"], Background -> GrayLevel[0.92]], 
            Cell[
             StyleData["InitializationCell", "WorkingDark"], Background -> 
             RGBColor[0.251765, 0.251765, 0.251765]]}, Closed]]}, Open]], 
      Cell[
       CellGroupData[{
         Cell["Author, Affiliation and Abstract", "Subsection"], 
         Cell[
          StyleData["Author"], CellMargins -> {{80, 100}, {2, 6}}], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Affiliation"], CellMargins -> {{80, 100}, {8, 2}}], 
            Cell[
             StyleData[
             "Affiliation", "WorkingDark", StyleDefinitions -> 
              StyleData["Affiliation"]], FontColor -> 
             RGBColor[0.596078, 0.462745, 0.666667]]}, Closed]], 
         Cell[
          StyleData["Abstract"], CellMargins -> {{80, 100}, {6, 6}}, FontSize -> 
          15, FontSlant -> "Plain"]}, Closed]]}, Open]], 
   Cell[
    CellGroupData[{
      Cell["Styles for Title and Section Cells", "Section"], 
      Cell[
       CellGroupData[{
         Cell[
          StyleData["Title"], CellFrame -> {{0, 0}, {4, 4}}, CellFrameColor -> 
          GrayLevel[0]], 
         Cell[
          StyleData[
          "Title", "WorkingDark", StyleDefinitions -> StyleData["Title"]], 
          CellFrameColor -> RGBColor[0.331373, 0.358824, 0.388235], FontColor -> 
          RGBColor[0.384314, 0.592157, 0.333333]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell[
          StyleData["Chapter"], CellFrame -> {{0, 0}, {3, 3}}, 
          CellGroupingRules -> {"SectionGrouping", 20}, TextAlignment -> Left,
           TextJustification -> 1, LineSpacing -> {1, 3}, 
          CounterAssignments -> {{"DisplayFormulaNumbered", 0}}, FontColor -> 
          RGBColor[
           0.7612268253604944, 0.29576562142366675`, 0.08555733577477684]], 
         Cell[
          StyleData[
          "Chapter", "WorkingDark", StyleDefinitions -> StyleData["Chapter"]],
           CellFrameColor -> RGBColor[0.331373, 0.358824, 0.388235], 
          FontColor -> RGBColor[0.384314, 0.592157, 0.333333]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell[
          StyleData["Section"], CellFrame -> {{0, 0}, {0.5, 0.5}}, 
          CellGroupingRules -> {"SectionGrouping", 30}, CellFrameColor -> 
          GrayLevel[0.5]], 
         Cell[
          StyleData[
          "Section", "WorkingDark", StyleDefinitions -> StyleData["Section"]],
           CellFrameColor -> 
          RGBColor[
           0.33137254901960783`, 0.3588235294117647, 0.38823529411764707`], 
          FontColor -> RGBColor[0.384314, 0.592157, 0.333333]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell[
          StyleData["Subsection"], CellFrame -> {{3, 0}, {0, 0.5}}, 
          CellFrameColor -> GrayLevel[0.5]], 
         Cell[
          StyleData[
          "Subsection", "WorkingDark", StyleDefinitions -> 
           StyleData["Subsection"]], CellFrameColor -> 
          RGBColor[0.331373, 0.358824, 0.388235], FontColor -> 
          RGBColor[0.384314, 0.592157, 0.333333]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell[
          StyleData["Subsubsection"], CellFrame -> {{3, 0}, {0, 0}}, 
          CellFrameColor -> GrayLevel[0.5]], 
         Cell[
          StyleData[
          "Subsubsection", "WorkingDark", StyleDefinitions -> 
           StyleData["Subsubsection"]], CellFrameColor -> 
          RGBColor[0.331373, 0.358824, 0.388235], FontColor -> 
          RGBColor[0.384314, 0.592157, 0.333333]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell[
         "NonEvaluating ", "Subsection", 
          CellChangeTimes -> {{3.8070354431248274`*^9, 
           3.8070354578354144`*^9}}], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData[
             "NonEvaluatingChapter", StyleDefinitions -> 
              StyleData["Chapter"]], CellFrame -> {{0, 0}, {3, 3}}, 
             PrivateCellOptions -> {
              "CellGroupBaseStyle" -> {Evaluatable -> False}}, 
             CellGroupingRules -> {"SectionGrouping", 20}, TextAlignment -> 
             Left, TextJustification -> 1, LineSpacing -> {1, 3}, 
             MenuSortingValue -> 10000, FontSlant -> "Italic", FontColor -> 
             GrayLevel[0.5]], 
            Cell[
             StyleData[
             "NonEvaluatingChapter", "WorkingDark", StyleDefinitions -> 
              StyleData["NonEvaluatingChapter"]], CellFrameColor -> 
             RGBColor[0.331373, 0.358824, 0.388235], FontColor -> 
             RGBColor[0.331373, 0.358824, 0.388235]]}, Open]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData[
             "NonEvaluatingSection", StyleDefinitions -> 
              StyleData["Section"]], 
             PrivateCellOptions -> {
              "CellGroupBaseStyle" -> {Evaluatable -> False}}, 
             MenuSortingValue -> 10000, FontSlant -> "Italic", FontColor -> 
             GrayLevel[0.5]], 
            Cell[
             StyleData[
             "NonEvaluatingSection", "WorkingDark", StyleDefinitions -> 
              StyleData["NonEvaluatingSection"]], CellFrameColor -> 
             RGBColor[0.331373, 0.358824, 0.388235], FontColor -> 
             RGBColor[0.331373, 0.358824, 0.388235]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData[
             "NonEvaluatingSubsection", StyleDefinitions -> 
              StyleData["Subsection"]], 
             PrivateCellOptions -> {
              "CellGroupBaseStyle" -> {Evaluatable -> False}}, 
             MenuSortingValue -> 10000, FontSlant -> "Italic", FontColor -> 
             GrayLevel[0.5]], 
            Cell[
             StyleData[
             "NonEvaluatingSubsection", "WorkingDark", StyleDefinitions -> 
              StyleData["NonEvaluatingSubsection"]], CellFrameColor -> 
             RGBColor[0.331373, 0.358824, 0.388235], FontColor -> 
             RGBColor[0.331373, 0.358824, 0.388235]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData[
             "NonEvaluatingSubsubsection", StyleDefinitions -> 
              StyleData["Subsubsection"]], 
             PrivateCellOptions -> {
              "CellGroupBaseStyle" -> {Evaluatable -> False}}, 
             AllowGroupClose -> Automatic, MenuSortingValue -> 10000, 
             FontSlant -> "Italic", FontColor -> GrayLevel[0.5]], 
            Cell[
             StyleData[
             "NonEvaluatingSubsubsection", "WorkingDark", StyleDefinitions -> 
              StyleData["NonEvaluatingSubsubsection"]], CellFrameColor -> 
             RGBColor[0.331373, 0.358824, 0.388235], FontColor -> 
             RGBColor[0.331373, 0.358824, 0.388235]]}, Closed]]}, Closed]]}, 
     Open]], 
   Cell[
    CellGroupData[{
      Cell["Styles for Input and Output Cells", "Section"], 
      Cell[
       StyleData["Input"], LinebreakAdjustments -> {0.85, 2, 1, 0, 0}], 
      Cell[
       StyleData[
       "NonEvaluatingInput", StyleDefinitions -> StyleData["Input"]], 
       Evaluatable -> False, 
       AutoStyleOptions -> {
        "CommentStyle" -> {
          FontColor -> GrayLevel[0.5], ShowAutoStyles -> False, 
           ShowSyntaxStyles -> False, AutoNumberFormatting -> False}, 
         "EmphasizedSyntaxErrorStyle" -> {FontColor -> GrayLevel[0.5]}, 
         "FunctionLocalVariableStyle" -> {FontColor -> GrayLevel[0.5]}, 
         "LocalScopeConflictStyle" -> {FontColor -> GrayLevel[0.5]}, 
         "LocalVariableStyle" -> {FontColor -> GrayLevel[0.5]}, 
         "PatternVariableStyle" -> {
          FontColor -> GrayLevel[0.5], FontSlant -> Italic}, 
         "StringStyle" -> {FontColor -> GrayLevel[0.5]}, 
         "SymbolShadowingStyle" -> {FontColor -> GrayLevel[0.5]}, 
         "UndefinedSymbolStyle" -> {FontColor -> GrayLevel[0.5]}}, 
       MenuSortingValue -> 1500, FontColor -> GrayLevel[0.5]], 
      Cell[
       CellGroupData[{
         Cell[
          StyleData["Code"], CellFrame -> {{0.5, 0}, {0, 0}}, 
          CellMargins -> {{66, 10}, {5, 5}}, InitializationCell -> False, 
          CellFrameMargins -> {{8, 0}, {5, 5}}], 
         Cell[
          StyleData[
          "Code", "WorkingDark", StyleDefinitions -> StyleData["Code"]], 
          CellFrameColor -> RGBColor[0.331373, 0.358824, 0.388235]]}, Open]], 
      Cell[
       StyleData["NonEvaluatingCode", StyleDefinitions -> StyleData["Code"]], 
       Evaluatable -> False, InitializationCell -> False, CellFrameColor -> 
       GrayLevel[0.5], 
       AutoStyleOptions -> {
        "CommentStyle" -> {
          FontColor -> GrayLevel[0.5], ShowAutoStyles -> False, 
           ShowSyntaxStyles -> False, AutoNumberFormatting -> False}, 
         "EmphasizedSyntaxErrorStyle" -> {FontColor -> GrayLevel[0.5]}, 
         "FunctionLocalVariableStyle" -> {FontColor -> GrayLevel[0.5]}, 
         "LocalScopeConflictStyle" -> {FontColor -> GrayLevel[0.5]}, 
         "LocalVariableStyle" -> {FontColor -> GrayLevel[0.5]}, 
         "PatternVariableStyle" -> {
          FontColor -> GrayLevel[0.5], FontSlant -> Italic}, 
         "StringStyle" -> {FontColor -> GrayLevel[0.5]}, 
         "SymbolShadowingStyle" -> {FontColor -> GrayLevel[0.5]}, 
         "UndefinedSymbolStyle" -> {FontColor -> GrayLevel[0.5]}}, 
       LanguageCategory -> "Formula", MenuSortingValue -> 1450, FontColor -> 
       GrayLevel[0.5]], 
      Cell[
       CellGroupData[{
         Cell[
         "Iconized object ", "Subsection", 
          CellChangeTimes -> {{3.8070354431248274`*^9, 
           3.8070354578354144`*^9}, {3.811809860450386*^9, 
           3.8118098640067024`*^9}}], 
         Cell[
          StyleData[
          "IconizedFrame", "WorkingDark", StyleDefinitions -> 
           StyleData["IconizedFrame"]], 
          TemplateBoxOptions -> {
           DisplayFunction -> (
             FrameBox[#, BaselinePosition -> Baseline, 
              FrameMargins -> {{0, 0}, {2, 1}}, FrameStyle -> 
              RGBColor[0.5, 0.5, 0.5], Background -> 
              RGBColor[0.35, 0.35, 0.35], RoundingRadius -> 4, 
              DefaultBaseStyle -> {
               "DialogStyle", FontFamily -> "Roboto", FontSize -> 11}]& ), 
            Tooltip -> None}], 
         Cell[
          StyleData[
          "IconizedItem", "WorkingDark", StyleDefinitions -> 
           StyleData["IconizedItem"]], FontColor -> 
          RGBColor[0.662745, 0.717647, 0.776471], 
          TagBoxOptions -> {Selectable -> True}], 
         Cell[
          StyleData[
          "IconizedLabel", "WorkingDark", StyleDefinitions -> 
           StyleData["IconizedLabel"]], FontColor -> 
          RGBColor[0.596078, 0.462745, 0.666667]], 
         Cell[
          StyleData[
          "IconizedCustomName", "WorkingDark", StyleDefinitions -> 
           StyleData["IconizedCustomName"]], FontColor -> 
          RGBColor[0.662745, 0.717647, 0.776471]], 
         Cell[
          StyleData[
          "IconizedDefaultName", "WorkingDark", StyleDefinitions -> 
           StyleData["IconizedDefaultName"]], 
          TemplateBoxOptions -> {DisplayFunction -> (DynamicBox[
              FEPrivate`Switch[#, "ListIcon", 
               FEPrivate`FrontEndResource["FEBitmaps", "IconizeListIcon"], 
               "AssociationIcon", 
               FEPrivate`FrontEndResource[
               "FEBitmaps", "IconizeAssociationIcon"], "StringIcon", 
               FEPrivate`FrontEndResource["FEBitmaps", "IconizeStringIcon"], 
               "SequenceIcon", 
               FEPrivate`FrontEndResource["FEBitmaps", "IconizeSequenceIcon"], 
               Blank[], #], 
              BaseStyle -> {
               FontColor -> RGBColor[0.662745, 0.717647, 0.776471], FontSize -> 
                12, PrivateFontOptions -> {
                 "OperatorSubstitution" -> False}}]& )}]}, Open]]}, Open]], 
   Cell[
    CellGroupData[{
      Cell[
      "Styles for Formulas", "Section", 
       CellChangeTimes -> {3.8070355288234005`*^9}], 
      Cell[
       CellGroupData[{
         Cell[
          StyleData["DisplayFormula"], CellFrame -> {{0.5, 3}, {3, 0.5}}, 
          CellMargins -> {{66, 31}, {Inherited, Inherited}}], 
         Cell[
          StyleData[
          "DisplayFormula", "WorkingDark", StyleDefinitions -> 
           StyleData["DisplayFormula"]], 
          CellMargins -> {{66, 68}, {Inherited, Inherited}}, CellFrameColor -> 
          RGBColor[0.331373, 0.358824, 0.388235], 
          AutoStyleOptions -> {
           "StringStyle" -> {
             FontColor -> 
              RGBColor[
               0.6627450980392157, 0.7176470588235294, 0.7764705882352941], 
              ShowAutoStyles -> False, ShowSyntaxStyles -> False, 
              AutoNumberFormatting -> False}}, FontColor -> 
          RGBColor[
           0.6627450980392157, 0.7176470588235294, 0.7764705882352941], 
          Background -> 
          RGBColor[
           0.16862745098039217`, 0.16862745098039217`, 
            0.16862745098039217`]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell[
          StyleData[
          "DisplayFormulaPrinted", StyleDefinitions -> 
           StyleData["DisplayFormula"]], 
          CellFrame -> {{0.5, 1.5}, {1.5, 0.5}}, CellDingbat -> 
          Cell["\[RightGuillemet] ", FontSize -> Inherited + 3]], 
         Cell[
          StyleData[
          "DisplayFormulaPrinted", "WorkingDark", StyleDefinitions -> 
           StyleData["DisplayFormula"]], 
          CellMargins -> {{66, 65}, {Inherited, Inherited}}, CellFrameColor -> 
          RGBColor[0.331373, 0.358824, 0.388235], 
          AutoStyleOptions -> {
           "StringStyle" -> {
             FontColor -> 
              RGBColor[
               0.6627450980392157, 0.7176470588235294, 0.7764705882352941], 
              ShowAutoStyles -> False, ShowSyntaxStyles -> False, 
              AutoNumberFormatting -> False}}, FontColor -> 
          RGBColor[
           0.6627450980392157, 0.7176470588235294, 0.7764705882352941], 
          Background -> 
          RGBColor[
           0.16862745098039217`, 0.16862745098039217`, 
            0.16862745098039217`]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell[
          StyleData["DisplayFormulaNumbered"], 
          CellFrame -> {{0.5, 3}, {3, 0.5}}, CellFrameLabels -> {{None, 
             Cell[
              TextData[{"(", 
                CounterBox["Chapter"], ".", 
                CounterBox["DisplayFormulaNumbered"], ")"}], 
              "DisplayFormulaEquationNumber"]}, {None, None}}], 
         Cell[
          StyleData[
          "DisplayFormulaNumbered", "WorkingDark", StyleDefinitions -> 
           StyleData["DisplayFormulaNumbered"]], 
          CellMargins -> {{66, 40}, {Inherited, Inherited}}, CellFrameColor -> 
          RGBColor[
           0.6627450980392157, 0.7176470588235294, 0.7764705882352941], 
          AutoStyleOptions -> {
           "StringStyle" -> {
             FontColor -> RGBColor[0.415686, 0.529412, 0.34902], 
              ShowAutoStyles -> False, ShowSyntaxStyles -> False, 
              AutoNumberFormatting -> False}}, FontColor -> 
          RGBColor[
           0.6627450980392157, 0.7176470588235294, 0.7764705882352941], 
          Background -> 
          RGBColor[
           0.16862745098039217`, 0.16862745098039217`, 
            0.16862745098039217`]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell[
          StyleData[
          "DisplayFormulaNumberedPrinted", StyleDefinitions -> 
           StyleData["DisplayFormulaNumbered"]], 
          CellFrame -> {{0.5, 1.5}, {1.5, 0.5}}, CellDingbat -> 
          Cell["\[RightGuillemet] ", FontSize -> Inherited + 3]], 
         Cell[
          StyleData[
          "DisplayFormulaNumberedPrinted", "WorkingDark", StyleDefinitions -> 
           StyleData["DisplayFormulaNumbered"]], 
          CellMargins -> {{66, 40}, {Inherited, Inherited}}, CellFrameColor -> 
          RGBColor[0.331373, 0.358824, 0.388235], 
          AutoStyleOptions -> {
           "StringStyle" -> {
             FontColor -> 
              RGBColor[
               0.6627450980392157, 0.7176470588235294, 0.7764705882352941], 
              ShowAutoStyles -> False, ShowSyntaxStyles -> False, 
              AutoNumberFormatting -> False}}, FontColor -> 
          RGBColor[
           0.6627450980392157, 0.7176470588235294, 0.7764705882352941], 
          Background -> 
          RGBColor[
           0.16862745098039217`, 0.16862745098039217`, 
            0.16862745098039217`]]}, Closed]]}, Closed]], 
   Cell[
    CellGroupData[{
      Cell["Styles for Printed Runningheads and Footers", "Section"], 
      Cell[
       StyleData["PageNumber"], MenuSortingValue -> None, FontFamily -> 
       "Arial", FontSize -> 6, FontSlant -> Plain], 
      Cell[
       StyleData["FooterText"], MenuSortingValue -> None, FontFamily -> 
       "Arial", FontSize -> 4, FontSlant -> Plain]}, Closed]]}, Visible -> 
  False, FrontEndVersion -> 
  "13.0 for Microsoft Windows (64-bit) (February 4, 2022)", StyleDefinitions -> 
  "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"3c8d05cb-731a-4e53-b422-3ede977e06dd"
]

